<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="financial-asset-relationship-db " />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="financial-asset-relationship-db - Custom CSS theme for html-documentation with lots of customization parameters." />
<meta property="og:url" content="https://github.com/DashFin-FarDb/financial-asset-relationship-db" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="Doxygen Awesome" />
<meta name="twitter:description" content="Custom CSS theme for doxygen html-documentation with lots of customization parameters." />
<!-- END twitter metadata -->
<title>financial-asset-relationship-db: DashFin/financial-asset-relationship-db Wiki</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/DashFin-FarDb/financial-asset-relationship-db" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">financial-asset-relationship-db
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;"
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__2app_2doc__state_2github__reposRepoArchDocGenContext_2DashFin-FarDb_2financial-asset-relatiof46780ddfd5c5d6ee7eee5fc2f835f8d.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">DashFin/financial-asset-relationship-db Wiki</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md688"></a></p>
<p>Version: 2</p>
<h1><a class="anchor" id="autotoc_md689"></a>
Overview</h1>
<h2><a class="anchor" id="autotoc_md690"></a>
Home</h2>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md691"></a>
Home</h1>
<p>The Financial Asset Relationship Database is a system designed for the 3D visualization of interconnected financial assets. It supports a wide range of major asset classes, including Equities, Bonds, Commodities, Currencies, and Regulatory Events. The core purpose is to provide a comprehensive, interactive tool for cross-asset analysis, automatic relationship discovery, and modeling the impact of corporate and regulatory events on the financial network. Sources: [README.md:3-4]()</p>
<p>The project offers two distinct user interface and backend combinations: an original implementation using a Gradio UI with direct Python logic, and a newer, decoupled architecture featuring a Next.js frontend communicating with a FastAPI backend via a REST API. Both implementations leverage the same core logic for graph analysis and visualization generation. Sources: [README.md:10-12, 30-32](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-23]()</p>
<h2><a class="anchor" id="autotoc_md692"></a>
System Architecture</h2>
<p>The system is structured into four primary layers: User Interface, API, Core Business Logic, and Data. This layered design allows for flexibility, such as supporting multiple frontend applications (Gradio and Next.js) that consume the core logic in different ways. Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-63]()</p>
<p>The diagram below illustrates the high-level system architecture, showing the two parallel paths from the user interface to the core logic.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User Interface Layer</div>
<div class="line">        A1[Gradio UI on Port 7860]</div>
<div class="line">        A2[Next.js UI on Port 3000]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API Layer</div>
<div class="line">        B1[Direct Python Calls]</div>
<div class="line">        B2[FastAPI Backend on Port 8000]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core Business Logic Layer</div>
<div class="line">        C[AssetRelationshipGraph &lt;br&gt; src/logic/asset_graph.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Data Layer</div>
<div class="line">        D1[Financial Models &lt;br&gt; src/models/financial_models.py]</div>
<div class="line">        D2[Data Sources &lt;br&gt; yfinance, sample_data.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A1 --&gt; B1</div>
<div class="line">    A2 --&gt; B2</div>
<div class="line"> </div>
<div class="line">    B1 --&gt; C</div>
<div class="line">    B2 --&gt; C</div>
<div class="line"> </div>
<div class="line">    C --&gt; D1</div>
<div class="line">    C --&gt; D2</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-63](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:175-185]()</p>
<h3><a class="anchor" id="autotoc_md693"></a>
Key Components</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Component   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source File(s)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Gradio UI</b>   </td><td class="markdownTableBodyNone">The original interactive web interface for demos and direct interaction with Python logic.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Next.js Frontend</b>   </td><td class="markdownTableBodyNone">A modern, responsive web application built with React and TypeScript.   </td><td class="markdownTableBodyNone"><code>frontend/</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>FastAPI Backend</b>   </td><td class="markdownTableBodyNone">A REST API server that exposes the core logic to the Next.js frontend.   </td><td class="markdownTableBodyNone"><code><a class="el" href="api_2main_8py.html">api/main.py</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b><code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code></b>   </td><td class="markdownTableBodyNone">The core engine responsible for graph algorithms, relationship discovery, and metric calculations.   </td><td class="markdownTableBodyNone"><code><a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Financial Models</b>   </td><td class="markdownTableBodyNone">Dataclasses defining the structure for all asset types (e.g., <code>Equity</code>, <code>Bond</code>).   </td><td class="markdownTableBodyNone"><code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Data Sources</b>   </td><td class="markdownTableBodyNone">Modules for fetching data, either from static samples or real-time sources like Yahoo Finance.   </td><td class="markdownTableBodyNone"><code>src/data/</code>   </td></tr>
</table>
<p>Sources: [README.md:100-112](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:70-90](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:40-52]()</p>
<h2><a class="anchor" id="autotoc_md694"></a>
Features</h2>
<p>The platform provides a rich set of features for financial analysis and visualization.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Feature   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>3D Network Visualization</b>   </td><td class="markdownTableBodyNone">An interactive 3D graph of asset relationships, rendered using Plotly.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Cross-Asset Analysis</b>   </td><td class="markdownTableBodyNone">Automatically discovers and models relationships between different asset classes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Regulatory Integration</b>   </td><td class="markdownTableBodyNone">Models the impact of corporate events and SEC filings on the asset network.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Real-time Metrics</b>   </td><td class="markdownTableBodyNone">Provides network statistics like density, degree, and relationship strength analysis.   </td></tr>
</table>
<p>Sources: [README.md:71-75]()</p>
<h3><a class="anchor" id="autotoc_md695"></a>
Supported Asset Classes</h3>
<p>The database is designed to handle a variety of financial instruments.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Asset Class   </th><th class="markdownTableHeadNone">Key Attributes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Equities</b>   </td><td class="markdownTableBodyNone">P/E ratios, dividend yields, EPS    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Fixed Income (Bonds)</b>   </td><td class="markdownTableBodyNone">Yield, duration, credit ratings    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Commodities</b>   </td><td class="markdownTableBodyNone">Futures and spot prices, contract specifications    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Currencies</b>   </td><td class="markdownTableBodyNone">FX pairs, exchange rates, monetary policy links    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Regulatory Events</b>   </td><td class="markdownTableBodyNone">Earnings, SEC filings, M&amp;A activities   </td></tr>
</table>
<p>Sources: [README.md:78-84]()</p>
<h3><a class="anchor" id="autotoc_md696"></a>
Relationship Types</h3>
<p>The system can identify and model several types of relationships between assets.</p>
<ul>
<li><b>Sector Affinity</b>: Assets in the same industry sector.</li>
<li><b>Corporate Links</b>: Bonds issued by a stock company.</li>
<li><b>Commodity Exposure</b>: Equity companies exposed to commodity prices.</li>
<li><b>Currency Risk</b>: FX exposure for non-USD assets.</li>
<li><b>Income Comparison</b>: Comparing stock dividends vs. bond yields.</li>
<li><b>Event Impact</b>: A regulatory event affecting multiple assets.</li>
</ul>
<p>Sources: [README.md:87-94]()</p>
<h2><a class="anchor" id="autotoc_md697"></a>
Data Model and Flow</h2>
<p>The core data model revolves around Assets, their Relationships, and the influence of Regulatory Events. Relationship strength is normalized on a 0.0 to 1.0 scale, while regulatory impact is scored from -1 (negative) to +1 (positive). Sources: [README.md:118-120]()</p>
<p>The following diagram shows the basic entity relationships.</p>
<div class="fragment"><div class="line">erDiagram</div>
<div class="line">    ASSET {</div>
<div class="line">        string id</div>
<div class="line">        string symbol</div>
<div class="line">        string name</div>
<div class="line">        AssetClass asset_class</div>
<div class="line">        string sector</div>
<div class="line">        float price</div>
<div class="line">    }</div>
<div class="line">    RELATIONSHIP {</div>
<div class="line">        string source_id</div>
<div class="line">        string target_id</div>
<div class="line">        string type</div>
<div class="line">        float strength</div>
<div class="line">    }</div>
<div class="line">    REGULATORY_EVENT {</div>
<div class="line">        string id</div>
<div class="line">        string name</div>
<div class="line">        date event_date</div>
<div class="line">        float impact_score</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET ||--o{ RELATIONSHIP : &quot;has&quot;</div>
<div class="line">    REGULATORY_EVENT ||--|{ ASSET : &quot;impacts&quot;</div>
</div><!-- fragment --><p>Sources: [README.md:114-120](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:32-35]()</p>
<h3><a class="anchor" id="autotoc_md698"></a>
Data Flow for Relationship Discovery</h3>
<p>The process of building the asset graph follows a clear data flow from ingestion to visualization.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Data Ingestion &lt;br&gt; yfinance / sample_data.py] --&gt; B(Asset Object Creation &lt;br&gt; Equity, Bond, etc.)</div>
<div class="line">    B --&gt; C{AssetRelationshipGraph}</div>
<div class="line">    C --&gt; D(Relationship Building &lt;br&gt; _find_relationships)</div>
<div class="line">    D --&gt; E(Graph Construction &lt;br&gt; Nodes and Edges)</div>
<div class="line">    E --&gt; F(3D Position Calculation &lt;br&gt; Deterministic seed=42)</div>
<div class="line">    F --&gt; G{Output Generation}</div>
<div class="line">    G --&gt; H[JSON for API]</div>
<div class="line">    G --&gt; I[Plotly Figure for Gradio]</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:183-207](), [README.md:133-134]()</p>
<h2><a class="anchor" id="autotoc_md699"></a>
Technology Stack</h2>
<p>The project utilizes a modern Python and JavaScript/TypeScript stack. The choice of libraries is governed by a set of rules to ensure consistency. Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:5-24]()</p>
<h3><a class="anchor" id="autotoc_md700"></a>
Backend &amp; Core Logic</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Technology   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Python 3.8+</b>   </td><td class="markdownTableBodyNone">Foundational programming language.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>FastAPI</b>   </td><td class="markdownTableBodyNone">High-performance REST API framework.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Gradio</b>   </td><td class="markdownTableBodyNone">UI framework for the original interactive demo.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Pandas</b>   </td><td class="markdownTableBodyNone">Data manipulation and analysis.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>NumPy</b>   </td><td class="markdownTableBodyNone">Numerical operations and array computations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Plotly</b>   </td><td class="markdownTableBodyNone">Generation of all interactive charts and 3D graphs.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>yfinance</b>   </td><td class="markdownTableBodyNone">Fetching real-time and historical financial market data.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>dataclasses &amp; enum</b>   </td><td class="markdownTableBodyNone">Defining structured data models and enumerations.   </td></tr>
</table>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:7-24](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:168-180]()</p>
<h3><a class="anchor" id="autotoc_md701"></a>
Frontend</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Technology   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Next.js 14</b>   </td><td class="markdownTableBodyNone">React framework for the modern UI.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>React 18</b>   </td><td class="markdownTableBodyNone">UI component library.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>TypeScript</b>   </td><td class="markdownTableBodyNone">Type safety for JavaScript.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Tailwind CSS</b>   </td><td class="markdownTableBodyNone">Utility-first CSS framework for styling.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Plotly.js</b>   </td><td class="markdownTableBodyNone">Rendering 3D visualizations in the browser.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Axios</b>   </td><td class="markdownTableBodyNone">HTTP client for communicating with the FastAPI backend.   </td></tr>
</table>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:154-165](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:55-56]()</p>
<h2><a class="anchor" id="autotoc_md702"></a>
Development and Testing</h2>
<p>The project is equipped with a comprehensive development and testing workflow, enforced by pre-commit hooks and a CI/CD pipeline. Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:65-81](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:43-57]()</p>
<h3><a class="anchor" id="autotoc_md703"></a>
Development Workflow</h3>
<p>A standardized workflow is used for all contributions.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A(Create Branch &lt;br&gt; e.g., feature/your-feature) --&gt; B(Make Changes &lt;br&gt; Code, Tests, Docs)</div>
<div class="line">    B --&gt; C(Run Local Checks &lt;br&gt; make check)</div>
<div class="line">    C --&gt; D(Commit Changes &lt;br&gt; Descriptive Messages)</div>
<div class="line">    D --&gt; E(Push and Create PR)</div>
<div class="line">    E --&gt; F{PR Review}</div>
<div class="line">    F --&gt; G(Merge to main)</div>
<div class="line">    G --&gt; H(Delete Branch)</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:51-100]()</p>
<h3><a class="anchor" id="autotoc_md704"></a>
Development Commands</h3>
<p>A <code>Makefile</code> provides shortcuts for common development tasks.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make install-dev</code>   </td><td class="markdownTableBodyNone">Install all production and development dependencies.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make pre-commit</code>   </td><td class="markdownTableBodyNone">Install pre-commit hooks for automated quality checks.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make format</code>   </td><td class="markdownTableBodyNone">Format code with <code>black</code> and <code>isort</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make lint</code>   </td><td class="markdownTableBodyNone">Run linters (<code>flake8</code>, <code>pylint</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make type-check</code>   </td><td class="markdownTableBodyNone">Run the <code>mypy</code> type checker.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make test</code>   </td><td class="markdownTableBodyNone">Run the <code>pytest</code> test suite with coverage.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make check</code>   </td><td class="markdownTableBodyNone">Run all checks (format, lint, type-check, test) at once.   </td></tr>
</table>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:60-76](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:41-44, 72-81]()</p>
<h3><a class="anchor" id="autotoc_md705"></a>
Testing</h3>
<p>The project maintains a high standard of testing for both backend and frontend code.</p>
<ul>
<li><b>Backend (Python)</b>: <code>pytest</code> is used for unit and integration testing. Tests are located in the <code>tests/</code> directory and are structured into <code>unit/</code> and <code>integration/</code> subdirectories.</li>
<li><b>Frontend (TypeScript)</b>: <code>Jest</code> and <code>React Testing Library</code> are used for component and utility testing. Tests are located in the <code>frontend/__tests__/</code> directory.</li>
</ul>
<p>Sources: [README.md:140-151](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:124-161](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:27-38]()</p>
<h2><a class="anchor" id="autotoc_md706"></a>
Conclusion</h2>
<p>The Financial Asset Relationship Database is a well-architected system that provides powerful visualization and analysis capabilities for financial data. Its modular design supports multiple frontends and a clear separation of concerns between the UI, API, and core logic. The project is further strengthened by a robust development and testing process, ensuring code quality and maintainability. Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:21-41, 235-240]()</p>
<h3><a class="anchor" id="autotoc_md707"></a>
Quick Start Guide</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/run-dev.sh">run-dev.sh</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/run-dev.bat">run-dev.bat</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/docker-compose.yml">docker-compose.yml</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/QUICK_START.md">QUICK_START.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/DOCKER.md">DOCKER.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md708"></a>
Quick Start Guide</h1>
<p>This guide provides instructions to quickly set up and run the Financial Asset Relationship Database application. It covers three primary methods: the modern Next.js/FastAPI stack (recommended), the original Gradio interface, and a containerized Docker deployment. Each method is designed to get a developer running in under 5 minutes.</p>
<p>The project offers a comprehensive 3D visualization system for interconnected financial assets, including equities, bonds, commodities, and currencies. For more detailed deployment information, refer to the Vercel deployment guide or the system architecture overview.</p>
<p>Sources: [README.md:3-4](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:3-4]()</p>
<h2><a class="anchor" id="autotoc_md709"></a>
Prerequisites</h2>
<p>Before you begin, ensure you have the following software installed on your system.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Software   </th><th class="markdownTableHeadLeft">Minimum Version    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Python   </td><td class="markdownTableBodyLeft">3.10+    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Node.js   </td><td class="markdownTableBodyLeft">18+   </td></tr>
</table>
<p>Sources: [README.md:7-9](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:5-7]()</p>
<h2><a class="anchor" id="autotoc_md710"></a>
Option 1: Next.js Frontend + FastAPI Backend (Recommended)</h2>
<p>This is the modern approach, providing a rich web interface powered by a REST API. You can use automated scripts for a one-command setup or follow the manual steps for more control.</p>
<p>Sources: [README.md:28-30]()</p>
<h3><a class="anchor" id="autotoc_md711"></a>
Automated Setup (Scripts)</h3>
<p>The repository includes convenience scripts to start both the backend and frontend servers simultaneously.</p>
<p>This diagram illustrates the process initiated by the <code>run-dev</code> scripts.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start Script] --&gt; B{Check OS};</div>
<div class="line">    B --&gt;|Linux/macOS| C[run-dev.sh];</div>
<div class="line">    B --&gt;|Windows| D[run-dev.bat];</div>
<div class="line">    C --&gt; E[Start FastAPI Backend on Port 8000];</div>
<div class="line">    D --&gt; E;</div>
<div class="line">    E --&gt; F[Start Next.js Frontend on Port 3000];</div>
<div class="line">    F --&gt; G[Application Ready];</div>
</div><!-- fragment --><p>Sources: [run-dev.sh](), [run-dev.bat]()</p>
<p>To run the automated setup:</p>
<p><b>Linux/macOS</b></p>
<div class="fragment"><div class="line">./run-dev.sh</div>
</div><!-- fragment --><p><b>Windows</b></p>
<div class="fragment"><div class="line">run-dev.bat</div>
</div><!-- fragment --><p>These scripts will perform the necessary setup, including installing dependencies and launching the servers.</p>
<p>Sources: [README.md:33-39](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:9-19]()</p>
<h3><a class="anchor" id="autotoc_md712"></a>
Manual Setup</h3>
<p>If you prefer to run the services separately, follow these steps.</p>
<h4><a class="anchor" id="autotoc_md713"></a>
1. Start the FastAPI Backend</h4>
<div class="fragment"><div class="line"># Activate virtual environment (e.g., source .venv/bin/activate)</div>
<div class="line">pip install -r requirements.txt</div>
<div class="line">python -m uvicorn api.main:app --reload --port 8000</div>
</div><!-- fragment --><p>Sources: [README.md:44-46](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:25-33]()</p>
<h4><a class="anchor" id="autotoc_md714"></a>
2. Start the Next.js Frontend</h4>
<p>Open a new terminal for this step.</p>
<div class="fragment"><div class="line">cd frontend</div>
<div class="line">npm install</div>
<div class="line">npm run dev</div>
</div><!-- fragment --><p>Sources: [README.md:49-51](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:36-44]()</p>
<h3><a class="anchor" id="autotoc_md715"></a>
Accessing the Application</h3>
<p>Once running, the different parts of the application are accessible at the following URLs.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Service   </th><th class="markdownTableHeadLeft">URL    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Next.js Frontend   </td><td class="markdownTableBodyLeft"><code><a href="http://localhost:3000">http://localhost:3000</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">FastAPI Backend   </td><td class="markdownTableBodyLeft"><code><a href="http://localhost:8000">http://localhost:8000</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">API Documentation (Swagger)   </td><td class="markdownTableBodyLeft"><code><a href="http://localhost:8000/docs">http://localhost:8000/docs</a></code>   </td></tr>
</table>
<p>Sources: [README.md:54-56](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:20-22]()</p>
<h2><a class="anchor" id="autotoc_md716"></a>
Option 2: Gradio UI (Original)</h2>
<p>This method runs the original Python-based Gradio interface.</p>
<ol type="1">
<li><p class="startli"><b>Clone the repository and set up a Python virtual environment.</b></p>
<p class="startli"><code>bash git clone &lt;repository-url&gt; cd financial-asset-relationship-db python -m venv .venv </code></p>
<p class="startli">Sources: [README.md:12-15]()</p>
</li>
<li><b>Activate the environment.</b><ul>
<li>macOS/Linux: <code>source .venv/bin/activate</code></li>
<li>Windows: <code>.venv\Scripts\activate.bat</code> Sources: [README.md:18-26]()</li>
</ul>
</li>
<li><p class="startli"><b>Install dependencies.</b></p>
<p class="startli"><code>bash pip install -r requirements.txt </code></p>
<p class="startli">Sources: [README.md:29-31]()</p>
</li>
<li><b>Run the application.</b> <code>bash python <a class="el" href="app_8py.html">app.py</a> </code> The application will be available at <code><a href="http://localhost:7860">http://localhost:7860</a></code>. Sources: [README.md:34-36]()</li>
</ol>
<h2><a class="anchor" id="autotoc_md717"></a>
Option 3: Docker Installation</h2>
<p>For a containerized setup that encapsulates all dependencies, use Docker.</p>
<h3><a class="anchor" id="autotoc_md718"></a>
Docker Compose (Recommended)</h3>
<p>The <code>docker-compose.yml</code> file defines the application service.</p>
<p>This diagram shows the services defined in the Docker Compose configuration.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Docker Environment</div>
<div class="line">        A(app_service)</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A --&gt;|Exposes Port 7860| B(Host Machine);</div>
<div class="line">    B --&gt; C(User);</div>
<div class="line"> </div>
<div class="line">    style A fill:#f9f,stroke:#333,stroke-width:2px</div>
</div><!-- fragment --><p>Sources: [docker-compose.yml]()</p>
<p>To build and run the application using Docker Compose:</p>
<div class="fragment"><div class="line">docker-compose up --build</div>
</div><!-- fragment --><p>This command builds the image for the <code>app</code> service and starts the container, making the Gradio UI available on <code><a href="http://localhost:7860">http://localhost:7860</a></code>.</p>
<p>The <code>docker-compose.yml</code> defines a single service named <code>app</code>.</p>
<div class="fragment"><div class="line"># docker-compose.yml</div>
<div class="line">services:</div>
<div class="line">  app:</div>
<div class="line">    build: .</div>
<div class="line">    ports:</div>
<div class="line">      - &quot;7860:7860&quot;</div>
<div class="line">    volumes:</div>
<div class="line">      - ./src:/app/src</div>
</div><!-- fragment --><p>Sources: [README.md:61-63](), [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:5-9](), [docker-compose.yml:2-8]()</p>
<h3><a class="anchor" id="autotoc_md719"></a>
Direct Docker Commands</h3>
<p>Alternatively, you can build and run the Docker image directly without Docker Compose.</p>
<ol type="1">
<li><b>Build the image:</b> <code>bash docker build -t financial-asset-db . </code></li>
<li><b>Run the container:</b> <code>bash docker run -p 7860:7860 financial-asset-db </code> Sources: [README.md:66-69](), [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:12-15]()</li>
</ol>
<h2><a class="anchor" id="autotoc_md720"></a>
Summary</h2>
<p>This guide has outlined three distinct methods for running the application. For modern web development, the <b>Next.js + FastAPI</b> stack is recommended and can be started with a single script. The <b>Gradio UI</b> offers a simpler, Python-only alternative. Finally, <b>Docker</b> provides a consistent, isolated environment ideal for both development and deployment.</p>
<p>Sources: [README.md](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md721"></a>
Project Goals and Vision</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md722"></a>
Project Goals and Vision</h1>
<p>The Financial Asset Relationship Database project is envisioned as a comprehensive system for visualizing and analyzing the intricate relationships between financial assets. Its core purpose is to provide an interactive 3D network graph that models the connections across major asset classes, including equities, bonds, commodities, currencies, and regulatory events. This allows for cross-asset analysis and understanding the impact of corporate and regulatory activities on the financial ecosystem.</p>
<p>The project's vision extends to being a modern, scalable, and extensible platform. It supports dual user interfacesâ€”a classic Gradio UI for rapid prototyping and a modern Next.js frontend with a FastAPI backend for a production-grade user experience. The architecture is designed to be modular, separating data models, business logic, and presentation layers to facilitate future enhancements and maintainability.</p>
<p>Sources: [README.md:3-4](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-19](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:3-6]()</p>
<h2><a class="anchor" id="autotoc_md723"></a>
Core Mission: Visualizing Financial Networks</h2>
<p>The primary goal is to transform complex, abstract financial data into an intuitive, interactive 3D visualization. This helps users discover and analyze relationships that are not immediately obvious from tabular data.</p>
<h3><a class="anchor" id="autotoc_md724"></a>
Key Features</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Feature   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>3D Network Visualization</b>   </td><td class="markdownTableBodyLeft">An interactive 3D graph of asset relationships, rendered using Plotly.   </td><td class="markdownTableBodyLeft">[README.md:52](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:43]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Cross-Asset Analysis</b>   </td><td class="markdownTableBodyLeft">Automatically discovers and models relationships between different asset classes.   </td><td class="markdownTableBodyLeft">[README.md:53]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Regulatory Integration</b>   </td><td class="markdownTableBodyLeft">Models the impact of corporate events and SEC filings on the asset network.   </td><td class="markdownTableBodyLeft">[README.md:54]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Real-time Metrics</b>   </td><td class="markdownTableBodyLeft">Provides a dashboard with network statistics and relationship strength analysis.   </td><td class="markdownTableBodyLeft">[README.md:55](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:44]()   </td></tr>
</table>
<p>Sources: [README.md:51-55](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:42-45]()</p>
<h3><a class="anchor" id="autotoc_md725"></a>
Data Model Vision</h3>
<p>The project's data model is centered around three core entities: Assets, Relationships, and Regulatory Events. The vision is to create a rich, interconnected graph where these entities influence each other.</p>
<p>The diagram below illustrates the conceptual data model.</p>
<div class="fragment"><div class="line">erDiagram</div>
<div class="line">    ASSET {</div>
<div class="line">        string id PK</div>
<div class="line">        string symbol</div>
<div class="line">        string name</div>
<div class="line">        AssetClass asset_class</div>
<div class="line">        string sector</div>
<div class="line">        float price</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    RELATIONSHIP {</div>
<div class="line">        string source_id FK</div>
<div class="line">        string target_id FK</div>
<div class="line">        string type</div>
<div class="line">        float strength</div>
<div class="line">        bool is_bidirectional</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    REGULATORY_EVENT {</div>
<div class="line">        string id PK</div>
<div class="line">        string name</div>
<div class="line">        RegulatoryActivity activity_type</div>
<div class="line">        date event_date</div>
<div class="line">        float impact_score</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET ||--o{ RELATIONSHIP : &quot;has&quot;</div>
<div class="line">    REGULATORY_EVENT ||--|{ ASSET : &quot;impacts&quot;</div>
</div><!-- fragment --><p><em>Sources: [README.md:73-80](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a> (inferred from project structure)]()</em></p>
<h2><a class="anchor" id="autotoc_md726"></a>
Supported Asset Ecosystem</h2>
<p>The project aims to cover all major financial asset classes to provide a holistic view of the market.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Asset Class   </th><th class="markdownTableHeadLeft">Key Attributes   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Equities</b>   </td><td class="markdownTableBodyLeft">P/E Ratios, Dividend Yields, EPS, Sector   </td><td class="markdownTableBodyLeft">[README.md:58]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Fixed Income (Bonds)</b>   </td><td class="markdownTableBodyLeft">Yield, Duration, Credit Ratings   </td><td class="markdownTableBodyLeft">[README.md:59]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Commodities</b>   </td><td class="markdownTableBodyLeft">Futures and Spot Prices, Contract Specifications   </td><td class="markdownTableBodyLeft">[README.md:60]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Currencies</b>   </td><td class="markdownTableBodyLeft">FX Pairs, Exchange Rates, Monetary Policy Links   </td><td class="markdownTableBodyLeft">[README.md:61]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Regulatory Events</b>   </td><td class="markdownTableBodyLeft">Earnings, SEC Filings, M&amp;A Activities, Impact Score   </td><td class="markdownTableBodyLeft">[README.md:62]()   </td></tr>
</table>
<p><em>Sources: [README.md:57-62](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:16]()</em></p>
<h3><a class="anchor" id="autotoc_md727"></a>
Relationship Discovery</h3>
<p>A core goal is the automatic discovery of relationships between assets. This logic is encapsulated in the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> and is designed to be extensible.</p>
<p>The following diagram shows the process of building relationships.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start: Ingest Assets] --&gt; B{Iterate All Asset Pairs};</div>
<div class="line">    B --&gt; C{Find Relationship Type};</div>
<div class="line">    C --&gt; D{Is Relationship Found?};</div>
<div class="line">    D -- Yes --&gt; E[Create Relationship Edge];</div>
<div class="line">    E --&gt; F[Calculate Strength (0.0-1.0)];</div>
<div class="line">    F --&gt; G[Add to Graph];</div>
<div class="line">    G --&gt; B;</div>
<div class="line">    D -- No --&gt; B;</div>
<div class="line">    B -- Done --&gt; H[Graph Complete];</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:104-122](), [README.md:95]()</em></p>
<p>The system identifies several types of relationships:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Relationship Type   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Sector Affinity</b>   </td><td class="markdownTableBodyLeft">Assets belonging to the same industry sector.   </td><td class="markdownTableBodyLeft">[README.md:65]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Corporate Links</b>   </td><td class="markdownTableBodyLeft">Bonds issued by a publicly traded company (equity).   </td><td class="markdownTableBodyLeft">[README.md:66]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Commodity Exposure</b>   </td><td class="markdownTableBodyLeft">Equity companies whose business is tied to commodity prices.   </td><td class="markdownTableBodyLeft">[README.md:67]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Currency Risk</b>   </td><td class="markdownTableBodyLeft">FX exposure for assets not denominated in USD.   </td><td class="markdownTableBodyLeft">[README.md:68]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Income Comparison</b>   </td><td class="markdownTableBodyLeft">Comparing stock dividends against bond yields.   </td><td class="markdownTableBodyLeft">[README.md:69]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Event Impact</b>   </td><td class="markdownTableBodyLeft">A single regulatory event affecting multiple assets.   </td><td class="markdownTableBodyLeft">[README.md:70]()   </td></tr>
</table>
<p><em>Sources: [README.md:64-70]()</em></p>
<h2><a class="anchor" id="autotoc_md728"></a>
Technical Vision and Architecture</h2>
<p>The project's technical vision emphasizes modernity, scalability, and developer experience. This is achieved through a dual-frontend architecture and a clear separation of concerns.</p>
<p>This diagram shows the high-level system architecture.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User_Interfaces</div>
<div class="line">        UI_Next[Next.js UI on Port 3000]</div>
<div class="line">        UI_Gradio[Gradio UI on Port 7860]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API_Layer</div>
<div class="line">        API[FastAPI Backend on Port 8000]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core_Logic</div>
<div class="line">        GraphEngine[AssetRelationshipGraph]</div>
<div class="line">        Viz[Visualization Logic]</div>
<div class="line">        DataModels[Financial Data Models]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Data_Sources</div>
<div class="line">        RealData[Real-time Data Fetcher]</div>
<div class="line">        SampleData[Static Sample Data]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    UI_Next -- REST API --&gt; API;</div>
<div class="line">    API -- Function Calls --&gt; GraphEngine;</div>
<div class="line">    UI_Gradio -- Direct Function Calls --&gt; GraphEngine;</div>
<div class="line">    GraphEngine --&gt; Viz;</div>
<div class="line">    GraphEngine --&gt; DataModels;</div>
<div class="line">    GraphEngine --&gt; RealData;</div>
<div class="line">    GraphEngine --&gt; SampleData;</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-82](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:64-90]()</em></p>
<h3><a class="anchor" id="autotoc_md729"></a>
API-First Approach</h3>
<p>The introduction of a FastAPI backend signifies a move towards an API-first design. This decouples the frontend from the backend logic, allowing for more flexible and scalable development.</p>
<p>The sequence diagram below shows a typical data flow for the Next.js frontend.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User Browser&quot;</div>
<div class="line">    participant NextApp as &quot;Next.js Frontend&quot;</div>
<div class="line">    participant FastAPI as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant GraphEngine as &quot;Core Graph Logic&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;NextApp: Load page</div>
<div class="line">    NextApp-&gt;&gt;FastAPI: GET /api/visualization</div>
<div class="line">    FastAPI-&gt;&gt;GraphEngine: get_3d_visualization_data()</div>
<div class="line">    GraphEngine--&gt;&gt;FastAPI: Return {nodes, edges}</div>
<div class="line">    FastAPI--&gt;&gt;NextApp: JSON Response</div>
<div class="line">    NextApp--&gt;&gt;User: Render 3D Graph with Plotly</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:85-102](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:20-33]()</em></p>
<h2><a class="anchor" id="autotoc_md730"></a>
Development Philosophy and Quality</h2>
<p>The project vision includes a strong emphasis on high-quality code, robust testing, and a streamlined development workflow. This is supported by a suite of modern development tools and clear contribution guidelines.</p>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:10-14]()</em></p>
<h3><a class="anchor" id="autotoc_md731"></a>
Development Tooling</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Tool   </th><th class="markdownTableHeadLeft">Purpose   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>pytest</code>   </td><td class="markdownTableBodyLeft">Backend testing framework.   </td><td class="markdownTableBodyLeft">[README.md:102](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:129]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>Jest</code>   </td><td class="markdownTableBodyLeft">Frontend testing framework.   </td><td class="markdownTableBodyLeft">[<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:30]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>black</code>, <code>isort</code>   </td><td class="markdownTableBodyLeft">Automatic code formatting for Python.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:103](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:150]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>flake8</code>, <code>pylint</code>   </td><td class="markdownTableBodyLeft">Python linting to enforce code style.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:106](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:149]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>mypy</code>   </td><td class="markdownTableBodyLeft">Static type checking for Python.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:109](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:151]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>pre-commit</code>   </td><td class="markdownTableBodyLeft">Runs automated quality checks before each commit.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:44-47](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:183-191]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GitHub Actions</code>   </td><td class="markdownTableBodyLeft">Continuous Integration (CI) to run checks automatically.   </td><td class="markdownTableBodyLeft">[<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:158-166]()   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [README.md]()</em></p>
<h3><a class="anchor" id="autotoc_md732"></a>
Guiding Principles</h3>
<ul>
<li><b>Modularity</b>: Code is organized into small, focused files with a clear separation of concerns (<code>src/models</code>, <code>src/logic</code>, etc.).</li>
<li><b>Readability</b>: Emphasis on clean, well-commented code with meaningful names.</li>
<li><b>Testing</b>: A high standard for test coverage is expected, with a goal of over 80%. New features and bug fixes must include tests.</li>
<li><b>Consistency</b>: Adherence to defined coding styles (PEP 8, Black) and project conventions.</li>
<li><b>Documentation</b>: Public functions and classes require docstrings, and key architectural decisions are documented in Markdown files.</li>
</ul>
<p><em>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:43-53](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:80-127](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:20-40]()</em></p>
<h2><a class="anchor" id="autotoc_md733"></a>
Future Vision and Extensibility</h2>
<p>The project is designed to be a foundation for more advanced financial analysis tools. The architectural choices and documented improvement areas point to a clear vision for future growth.</p>
<h3><a class="anchor" id="autotoc_md734"></a>
Potential Future Features</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Feature Area   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Data Persistence</b>   </td><td class="markdownTableBodyLeft">Storing asset and relationship data in a database like SQLite or PostgreSQL.   </td><td class="markdownTableBodyLeft">[<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:200-207]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Real-time Updates</b>   </td><td class="markdownTableBodyLeft">Using WebSockets to stream live data and automatically refresh visualizations.   </td><td class="markdownTableBodyLeft">[<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:268-273]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Advanced Analytics</b>   </td><td class="markdownTableBodyLeft">Integrating machine learning for relationship prediction, anomaly detection, and trend analysis.   </td><td class="markdownTableBodyLeft">[<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:262-266]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Service-Oriented Architecture</b>   </td><td class="markdownTableBodyLeft">Abstracting logic into a service layer with repositories for better testability and maintenance.   </td><td class="markdownTableBodyLeft">[<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:194-216]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Enhanced Monitoring</b>   </td><td class="markdownTableBodyLeft">Adding health check endpoints, Prometheus metrics, and structured logging for observability.   </td><td class="markdownTableBodyLeft">[<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:237-259]()   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:181-188]()</em></p>
<h2><a class="anchor" id="autotoc_md735"></a>
Conclusion</h2>
<p>The project's goal is to be more than just a visualization tool; it aims to be an extensible, high-quality, and modern platform for financial data analysis. The vision combines a powerful analytical engine with a user-friendly interface, supported by a robust and scalable technical architecture. By prioritizing clean code, comprehensive testing, and clear documentation, the project is well-positioned for future growth and community contribution.</p>
<p><em>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:275-281](), [README.md:3-4]()</em></p>
<h2><a class="anchor" id="autotoc_md736"></a>
System Architecture</h2>
<h3><a class="anchor" id="autotoc_md737"></a>
Architecture Overview</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/docker-compose.yml">docker-compose.yml</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md738"></a>
Architecture Overview</h1>
<p>This document provides a comprehensive overview of the system architecture for the Financial Asset Relationship Database. The project is designed to visualize the complex interconnections between financial assets across various classes, including equities, bonds, commodities, and currencies. The architecture supports two distinct user interfacesâ€”a modern Next.js web application and an original Gradio-based demoâ€”both powered by a robust Python backend.</p>
<p>The system is structured into four primary layers: a User Interface Layer, an API Layer, a Core Business Logic Layer, and a Data Layer. This separation of concerns allows for modularity and scalability, enabling different frontend experiences to consume the same underlying relationship discovery engine. For more information on deployment and integration, see DEPLOYMENT.md and INTEGRATION_SUMMARY.md.</p>
<p>Sources: [README.md:3-4](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:3-33](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:15-17]()</p>
<h2><a class="anchor" id="autotoc_md739"></a>
System Architecture</h2>
<p>The system is composed of four distinct layers, facilitating a clean separation of concerns between data, logic, and presentation.</p>
<p>This diagram illustrates the high-level system architecture, showing the two UI options and their connection to the backend logic.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User_Interface_Layer</div>
<div class="line">        Gradio_UI[&quot;Gradio UI (Port 7860)&quot;]</div>
<div class="line">        NextJS_UI[&quot;Next.js UI (Port 3000)&quot;]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API_Layer</div>
<div class="line">        FastAPI[&quot;FastAPI Backend (Port 8000)&quot;]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core_Business_Logic_Layer</div>
<div class="line">        AssetGraph[&quot;AssetRelationshipGraph (src/logic/asset_graph.py)&quot;]</div>
<div class="line">        Visualizations[&quot;Visualization Layer (src/visualizations/)&quot;]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Data_Layer</div>
<div class="line">        Models[&quot;Financial Models (src/models/financial_models.py)&quot;]</div>
<div class="line">        DataSources[&quot;Data Sources (src/data/)&quot;]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    NextJS_UI -- &quot;HTTP REST API&quot; --&gt; FastAPI</div>
<div class="line">    Gradio_UI -- &quot;Direct Function Calls&quot; --&gt; AssetGraph</div>
<div class="line">    FastAPI -- &quot;Function Calls&quot; --&gt; AssetGraph</div>
<div class="line">    AssetGraph --&gt; Visualizations</div>
<div class="line">    AssetGraph --&gt; Models</div>
<div class="line">    AssetGraph --&gt; DataSources</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:5-48](), [README.md:104-118]()</p>
<h3><a class="anchor" id="autotoc_md740"></a>
Key Components</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Component   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a></code>   </td><td class="markdownTableBodyNone">The main application entry point for the Gradio web interface and its event handlers.   </td><td class="markdownTableBodyNone"><code>README.md:105</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="api_2main_8py.html">api/main.py</a></code>   </td><td class="markdownTableBodyNone">The FastAPI backend that serves the REST API for the Next.js frontend.   </td><td class="markdownTableBodyNone"><code><a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:20-29</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a></code>   </td><td class="markdownTableBodyNone">Contains the core graph algorithms and the relationship discovery engine.   </td><td class="markdownTableBodyNone"><code>README.md:106</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code>   </td><td class="markdownTableBodyNone">Defines the domain model dataclasses (e.g., <code>Asset</code>, <code>Equity</code>) and enums.   </td><td class="markdownTableBodyNone"><code>README.md:107</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code><a class="el" href="sample__data_8py.html">src/data/sample_data.py</a></code>   </td><td class="markdownTableBodyNone">Responsible for creating the sample dataset used in the application.   </td><td class="markdownTableBodyNone"><code>README.md:108</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>src/visualizations/</code>   </td><td class="markdownTableBodyNone">Contains modules for generating Plotly-based charts and 3D graphs.   </td><td class="markdownTableBodyNone"><code>README.md:109</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>src/reports/</code>   </td><td class="markdownTableBodyNone">Includes logic for generating schema and business rules documentation.   </td><td class="markdownTableBodyNone"><code>README.md:110</code>   </td></tr>
</table>
<p>Sources: [README.md:104-118](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:197-203]()</p>
<h2><a class="anchor" id="autotoc_md741"></a>
Component Interaction Flow</h2>
<p>The system supports two primary interaction flows depending on the user interface being used.</p>
<h3><a class="anchor" id="autotoc_md742"></a>
Next.js Frontend Flow</h3>
<p>The Next.js frontend communicates with the backend via a REST API, providing a decoupled and modern web experience.</p>
<p>The following sequence diagram shows a typical user interaction to view the 3D graph from the Next.js UI.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User&quot;</div>
<div class="line">    participant NextJS as &quot;Next.js UI (Port 3000)&quot;</div>
<div class="line">    participant FastAPI as &quot;FastAPI Backend (Port 8000)&quot;</div>
<div class="line">    participant CoreLogic as &quot;Core Logic (AssetRelationshipGraph)&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;NextJS: Clicks &quot;View 3D Graph&quot;</div>
<div class="line">    NextJS-&gt;&gt;FastAPI: GET /api/visualization</div>
<div class="line">    activate FastAPI</div>
<div class="line">    FastAPI-&gt;&gt;CoreLogic: get_3d_visualization_data()</div>
<div class="line">    activate CoreLogic</div>
<div class="line">    CoreLogic--&gt;&gt;FastAPI: {nodes: [...], edges: [...]}</div>
<div class="line">    deactivate CoreLogic</div>
<div class="line">    FastAPI--&gt;&gt;NextJS: 200 OK (JSON Response)</div>
<div class="line">    deactivate FastAPI</div>
<div class="line">    NextJS-&gt;&gt;User: Renders 3D Visualization</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:52-71]()</p>
<h3><a class="anchor" id="autotoc_md743"></a>
Gradio UI Flow</h3>
<p>The Gradio UI, being a Python-native framework, interacts directly with the core logic functions without an intermediate API layer.</p>
<p>This sequence diagram illustrates how the Gradio UI refreshes the visualization through direct function calls.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User&quot;</div>
<div class="line">    participant Gradio as &quot;Gradio UI (Port 7860)&quot;</div>
<div class="line">    participant CoreLogic as &quot;Core Logic (AssetRelationshipGraph)&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;Gradio: Clicks &quot;Refresh Visualization&quot;</div>
<div class="line">    Gradio-&gt;&gt;CoreLogic: refresh_visualization_outputs()&lt;br/&gt;(Direct function call)</div>
<div class="line">    activate CoreLogic</div>
<div class="line">    CoreLogic--&gt;&gt;Gradio: Plotly Figure Object</div>
<div class="line">    deactivate CoreLogic</div>
<div class="line">    Gradio-&gt;&gt;User: Updates Visualization in UI</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:73-89]()</p>
<h2><a class="anchor" id="autotoc_md744"></a>
Technology Stack</h2>
<p>The project utilizes a combination of Python for the backend and core logic, and a choice between Python (Gradio) or a TypeScript/React (Next.js) stack for the frontend.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:5-20](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:92-120]()</p>
<h3><a class="anchor" id="autotoc_md745"></a>
Backend &amp; Core Logic</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Technology   </th><th class="markdownTableHeadNone">Role    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Python 3.8+</b>   </td><td class="markdownTableBodyNone">Foundational programming language for all backend and logic.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>FastAPI</b>   </td><td class="markdownTableBodyNone">High-performance REST API framework for the Next.js frontend.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Uvicorn</b>   </td><td class="markdownTableBodyNone">ASGI server to run the FastAPI application.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Pydantic</b>   </td><td class="markdownTableBodyNone">Data validation and settings management.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>NumPy</b>   </td><td class="markdownTableBodyNone">High-performance numerical operations and graph algorithms.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Pandas</b>   </td><td class="markdownTableBodyNone">Data manipulation and analysis.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>yfinance</b>   </td><td class="markdownTableBodyNone">Fetching real-time and historical financial market data.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>dataclasses &amp; enum</b>   </td><td class="markdownTableBodyNone">Defining structured data models and enumerations.   </td></tr>
</table>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:7-20](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:109-120]()</p>
<h3><a class="anchor" id="autotoc_md746"></a>
Frontend</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Technology   </th><th class="markdownTableHeadNone">Role    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Next.js 14</b>   </td><td class="markdownTableBodyNone">React framework for the modern web UI.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>React 18</b>   </td><td class="markdownTableBodyNone">UI component library.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>TypeScript</b>   </td><td class="markdownTableBodyNone">Type safety for the frontend codebase.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Gradio</b>   </td><td class="markdownTableBodyNone">Framework for the original Python-based interactive UI.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Plotly / Plotly.js</b>   </td><td class="markdownTableBodyNone">Exclusive library for all interactive charts and 3D visualizations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Axios</b>   </td><td class="markdownTableBodyNone">HTTP client for the Next.js frontend to communicate with the API.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Tailwind CSS</b>   </td><td class="markdownTableBodyNone">Styling for the Next.js frontend.   </td></tr>
</table>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:94-107](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:8](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:13]()</p>
<h2><a class="anchor" id="autotoc_md747"></a>
Data Layer</h2>
<p>The data layer is responsible for defining the structure of financial assets and sourcing the data.</p>
<h3><a class="anchor" id="autotoc_md748"></a>
Data Models</h3>
<p>The core data models are defined using Python's <code>dataclasses</code> for clarity and type safety. The base <code>Asset</code> class is inherited by more specific asset types.</p>
<p>This class diagram shows the inheritance structure of the financial asset models.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">        +asset_class: AssetClass</div>
<div class="line">        +price: float</div>
<div class="line">        +currency: str</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +sector: str</div>
<div class="line">        +pe_ratio: float</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +yield: float</div>
<div class="line">        +duration: float</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        +contract_size: float</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        +country: str</div>
<div class="line">    }</div>
<div class="line">    class RegulatoryEvent {</div>
<div class="line">        +activity: RegulatoryActivity</div>
<div class="line">        +impact_score: float</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:19-22](), [README.md:93-97]()</p>
<h3><a class="anchor" id="autotoc_md749"></a>
Data Sources</h3>
<p>Data is ingested from two primary sources:</p>
<ol type="1">
<li><b>Static Sample Data</b>: A predefined set of assets located in <code><a class="el" href="sample__data_8py.html">src/data/sample_data.py</a></code> for demonstration and testing.</li>
<li><b>Yahoo Finance</b>: Real-time and historical market data is fetched using the <code>yfinance</code> library, as defined in <code><a class="el" href="real__data__fetcher_8py.html">src/data/real_data_fetcher.py</a></code>.</li>
</ol>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:42-46](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:14]()</p>
<h2><a class="anchor" id="autotoc_md750"></a>
Deployment Architecture</h2>
<p>The application is designed for both local development and cloud deployment on Vercel.</p>
<h3><a class="anchor" id="autotoc_md751"></a>
Local Development &amp; Docker</h3>
<p>For local development, developers can run the FastAPI backend and Next.js frontend as separate processes. Alternatively, Docker provides a containerized environment. The <code>docker-compose.yml</code> file defines the service for running the application.</p>
<div class="fragment"><div class="line"># docker-compose.yml</div>
<div class="line">services:</div>
<div class="line">  app:</div>
<div class="line">    build: .</div>
<div class="line">    ports:</div>
<div class="line">      - &quot;7860:7860&quot;</div>
<div class="line">    volumes:</div>
<div class="line">      - .:/app</div>
<div class="line">    environment:</div>
<div class="line">      - GRADIO_SERVER_NAME=0.0.0.0</div>
</div><!-- fragment --><p>This configuration builds a Docker image from the local Dockerfile and maps port 7860 for the Gradio application.</p>
<p>Sources: [README.md:65-76](), [docker-compose.yml:1-9]()</p>
<h3><a class="anchor" id="autotoc_md752"></a>
Vercel Deployment</h3>
<p>The Next.js application is optimized for deployment on Vercel. The frontend is served from Vercel's Edge Network, while the Python backend (FastAPI) is deployed as a Vercel Serverless Function. This provides auto-scaling capabilities and a seamless deployment experience integrated with Git.</p>
<p>This diagram shows the Vercel deployment model.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    User[&quot;Internet Users&quot;] --&gt;|HTTPS| Vercel</div>
<div class="line">    subgraph Vercel Platform</div>
<div class="line">        NextJS[&quot;Next.js Frontend (Edge Network)&quot;]</div>
<div class="line">        FastAPI[&quot;Python Backend (Serverless Function)&quot;]</div>
<div class="line">        NextJS -- &quot;Internal Network&quot; --&gt; FastAPI</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:158-176]()</p>
<h2><a class="anchor" id="autotoc_md753"></a>
Conclusion</h2>
<p>The architecture of the Financial Asset Relationship Database is designed to be modular, scalable, and flexible. By separating the core relationship engine from the presentation layer, the system can support multiple user experiences (Gradio and Next.js) and is well-suited for future expansion. The use of a decoupled API layer for the Next.js application follows modern web development best practices, while the direct-call mechanism for the Gradio app provides a simpler, Python-native alternative. The clear project structure and defined technology stack create a solid foundation for collaborative development and future feature enhancements.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:410-413](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md754"></a>
Backend Architecture</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/models/financial_models.py">src/models/financial_models.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/app.py">app.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/data/real_data_fetcher.py">src/data/real_data_fetcher.py</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md755"></a>
Backend Architecture</h1>
<p>The backend architecture of the Financial Asset Relationship Database is designed to support two distinct user interfaces: a modern Next.js web application and the original Gradio-based interactive demo. This is achieved through a dual-pathway system where a FastAPI server provides a RESTful API for the Next.js frontend, while the Gradio app interacts directly with the core business logic.</p>
<p>At the heart of the system is the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>, a Python class that encapsulates all logic for managing financial assets, discovering their relationships, calculating network metrics, and preparing data for 3D visualization. The data layer is defined by a set of <code>dataclasses</code> representing various financial instruments and is populated using either sample data or real-time information fetched via the <code>yfinance</code> library.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [README.md:80-88](), [<a class="el" href="api_2main_8py.html">api/main.py</a>](), [<a class="el" href="app_8py.html">app.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md756"></a>
System Components</h2>
<p>The backend is composed of three primary layers: the API Layer, the Core Business Logic Layer, and the Data Layer. This modular design allows different frontends to consume the same underlying functionality.</p>
<p>This diagram illustrates the high-level system architecture, showing the two frontend applications and how they interface with the backend components.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User_Interface_Layer</div>
<div class="line">        A[Next.js UI on Port 3000]</div>
<div class="line">        B[Gradio UI on Port 7860]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API_Layer</div>
<div class="line">        C[FastAPI Backend on Port 8000]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core_Business_Logic</div>
<div class="line">        D[AssetRelationshipGraph]</div>
<div class="line">        E[Visualization Logic]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Data_Layer</div>
<div class="line">        F[Financial Models]</div>
<div class="line">        G[Data Fetchers]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A -- &quot;HTTP REST API&quot; --&gt; C</div>
<div class="line">    C -- &quot;Function Calls&quot; --&gt; D</div>
<div class="line">    B -- &quot;Direct Function Calls&quot; --&gt; D</div>
<div class="line">    D -- &quot;Uses&quot; --&gt; F</div>
<div class="line">    D -- &quot;Uses&quot; --&gt; G</div>
<div class="line">    D -- &quot;Uses&quot; --&gt; E</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [README.md:19-33]()</p>
<h2><a class="anchor" id="autotoc_md757"></a>
API Layer (FastAPI)</h2>
<p>The FastAPI application, defined in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>, serves as the primary interface for the Next.js frontend. It exposes a set of RESTful endpoints to query the financial asset graph. A singleton pattern is used to initialize and reuse a single <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> instance, which is populated with real data on the first request.</p>
<p>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:34-48](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md758"></a>
Key Endpoints</h3>
<p>The API provides endpoints for retrieving assets, relationships, metrics, and visualization data.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Method   </th><th class="markdownTableHeadLeft">Endpoint   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Core Logic Called    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/health</code>   </td><td class="markdownTableBodyLeft">Health check for the service.   </td><td class="markdownTableBodyLeft">N/A    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets</code>   </td><td class="markdownTableBodyLeft">Retrieves a list of all assets, with optional filtering by class and sector.   </td><td class="markdownTableBodyLeft"><code>graph.assets</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets/{asset_id}</code>   </td><td class="markdownTableBodyLeft">Fetches detailed information for a single asset.   </td><td class="markdownTableBodyLeft"><code>graph.get_asset_by_id()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/relationships</code>   </td><td class="markdownTableBodyLeft">Returns all relationships in the graph.   </td><td class="markdownTableBodyLeft"><code>graph.relationships</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/metrics</code>   </td><td class="markdownTableBodyLeft">Calculates and returns key network metrics.   </td><td class="markdownTableBodyLeft"><code>graph.calculate_metrics()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/visualization</code>   </td><td class="markdownTableBodyLeft">Generates node and edge data for 3D visualization.   </td><td class="markdownTableBodyLeft"><code>graph.get_3d_visualization_data()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/asset-classes</code>   </td><td class="markdownTableBodyLeft">Lists all available asset classes.   </td><td class="markdownTableBodyLeft"><code>graph.get_all_asset_classes()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/sectors</code>   </td><td class="markdownTableBodyLeft">Lists all unique sectors present in the data.   </td><td class="markdownTableBodyLeft"><code>graph.get_all_sectors()</code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:51-168]()</p>
<h3><a class="anchor" id="autotoc_md759"></a>
Request Flow (Next.js)</h3>
<p>This sequence diagram shows a typical request from the Next.js frontend to the FastAPI backend to retrieve visualization data.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User (Browser)&quot;</div>
<div class="line">    participant NextApp as &quot;Next.js Frontend&quot;</div>
<div class="line">    participant FastAPI as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Graph as &quot;AssetRelationshipGraph&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;NextApp: Load 3D Visualization Page</div>
<div class="line">    NextApp-&gt;&gt;FastAPI: GET /api/visualization</div>
<div class="line">    activate FastAPI</div>
<div class="line">    Note over FastAPI: get_graph() singleton is called</div>
<div class="line">    FastAPI-&gt;&gt;Graph: get_3d_visualization_data()</div>
<div class="line">    activate Graph</div>
<div class="line">    Graph--&gt;&gt;FastAPI: {nodes: [...], edges: [...]}</div>
<div class="line">    deactivate Graph</div>
<div class="line">    FastAPI--&gt;&gt;NextApp: 200 OK with JSON data</div>
<div class="line">    deactivate FastAPI</div>
<div class="line">    NextApp-&gt;&gt;User: Render Plotly.js graph</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:133-140](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md760"></a>
Core Business Logic Layer</h2>
<p>The core logic is centralized in the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class. This class is responsible for the in-memory representation and manipulation of the financial asset network.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md761"></a>
<code>AssetRelationshipGraph</code> Class</h3>
<p>This class manages the lifecycle of assets and their relationships.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class AssetRelationshipGraph {</div>
<div class="line">        +List~Asset~ assets</div>
<div class="line">        +List~Relationship~ relationships</div>
<div class="line">        +add_asset(asset: Asset)</div>
<div class="line">        +add_relationship(source_id, target_id, type, strength)</div>
<div class="line">        +build_relationships()</div>
<div class="line">        +calculate_metrics() : dict</div>
<div class="line">        +get_3d_visualization_data() : dict</div>
<div class="line">        +get_asset_by_id(asset_id) : Asset</div>
<div class="line">        -_find_relationships(asset1, asset2)</div>
<div class="line">    }</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>:21-255]()</p>
<h3><a class="anchor" id="autotoc_md762"></a>
Relationship Discovery</h3>
<p>The <code>build_relationships()</code> method orchestrates the discovery of connections between assets. It iterates through all unique pairs of assets and calls <code>_find_relationships()</code> to identify potential links based on predefined rules.</p>
<p>This flowchart shows the logic for building relationships.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start build_relationships] --&gt; B{Iterate through all unique pairs of assets (asset1, asset2)}</div>
<div class="line">    B --&gt; C[Call _find_relationships(asset1, asset2)]</div>
<div class="line">    C --&gt; D{Relationship found?}</div>
<div class="line">    D -- Yes --&gt; E[Create Relationship object]</div>
<div class="line">    E --&gt; F[Add to graph.relationships]</div>
<div class="line">    F --&gt; B</div>
<div class="line">    D -- No --&gt; B</div>
<div class="line">    B -- Loop finished --&gt; G[End]</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>:100-120]()</p>
<p>The <code>_find_relationships</code> method contains the specific business rules, such as identifying assets in the same sector or linking a corporate bond to its parent equity.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>:122-171]()</p>
<h2><a class="anchor" id="autotoc_md763"></a>
Data Layer</h2>
<p>The data layer consists of data models that define the structure of financial assets and the logic for fetching data from external or internal sources.</p>
<h3><a class="anchor" id="autotoc_md764"></a>
Data Models</h3>
<p>The project uses Python's <code>dataclasses</code> to create strongly-typed and structured data models for all financial assets. A base <code>Asset</code> class defines common attributes, and specific classes like <code>Equity</code>, <code>Bond</code>, and <code>Commodity</code> inherit from it.</p>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<p>This diagram shows the inheritance hierarchy of the financial asset models.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        &lt;&lt;dataclass&gt;&gt;</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">        +asset_class: AssetClass</div>
<div class="line">        +price: float</div>
<div class="line">        +currency: str</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        &lt;&lt;dataclass&gt;&gt;</div>
<div class="line">        +sector: str</div>
<div class="line">        +market_cap: float</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        &lt;&lt;dataclass&gt;&gt;</div>
<div class="line">        +issuer: str</div>
<div class="line">        +credit_rating: str</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        &lt;&lt;dataclass&gt;&gt;</div>
<div class="line">        +unit: str</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        &lt;&lt;dataclass&gt;&gt;</div>
<div class="line">        +country: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:25-108]()</p>
<h3><a class="anchor" id="autotoc_md765"></a>
Data Fetching</h3>
<p>Data is primarily sourced from <code>yfinance</code> for real-time and historical market data, as specified in the project's rules. The function <code>populate_graph_with_real_data</code> in <code><a class="el" href="real__data__fetcher_8py.html">src/data/real_data_fetcher.py</a></code> is responsible for fetching data for a predefined list of tickers and populating the graph.</p>
<p>Sources: [<a class="el" href="real__data__fetcher_8py.html">src/data/real_data_fetcher.py</a>:15-115](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md766"></a>
Gradio Integration</h2>
<p>The original <code><a class="el" href="app_8py.html">app.py</a></code> provides a Gradio-based user interface. Unlike the Next.js application, it does not use the FastAPI layer. Instead, its event handlers make direct synchronous calls to the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> instance and associated visualization functions.</p>
<p>This architecture demonstrates a simpler, direct-coupling approach suitable for rapid prototyping and interactive demos.</p>
<p>This diagram shows the direct interaction between the Gradio UI and the core logic.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    GradioUI[Gradio UI Components] -- &quot;User Interaction&quot; --&gt; EventHandler[Gradio Event Handler in app.py]</div>
<div class="line">    EventHandler -- &quot;Direct Function Call&quot; --&gt; CoreLogic[AssetRelationshipGraph]</div>
<div class="line">    CoreLogic -- &quot;Returns Data/Figure&quot; --&gt; EventHandler</div>
<div class="line">    EventHandler -- &quot;Updates UI&quot; --&gt; GradioUI</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="app_8py.html">app.py</a>:117-158]()</p>
<h2><a class="anchor" id="autotoc_md767"></a>
Summary</h2>
<p>The backend architecture is flexible, supporting both a modern, decoupled frontend via a FastAPI REST API and a legacy, tightly-coupled Gradio UI through direct function calls. The system is centered around the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class, which serves as the single source of truth for business logic, ensuring consistency across both interfaces. The use of <code>dataclasses</code> for modeling and a dedicated data-fetching layer creates a clear separation of concerns, making the system modular and extensible.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [README.md](), [<a class="el" href="api_2main_8py.html">api/main.py</a>](), [<a class="el" href="app_8py.html">app.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md768"></a>
Frontend Architecture</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/page.tsx">frontend/app/page.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/lib/api.ts">frontend/app/lib/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/next.config.js">frontend/next.config.js</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/package.json">frontend/package.json</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md769"></a>
Frontend Architecture</h1>
<p>The frontend for the Financial Asset Relationship Database is a modern web application built with Next.js and React. Its primary purpose is to provide an interactive user interface for visualizing and exploring complex financial asset relationships. The application fetches data from a separate FastAPI backend and presents it through three main features: an interactive 3D network graph, a dashboard of key metrics, and a filterable table of assets.</p>
<p>The architecture emphasizes a clear separation of concerns, with dedicated components for each feature, a centralized API client for backend communication, and type safety enforced by TypeScript. This design makes the application responsive, scalable, and maintainable. For more information on the overall system, see the "" "System Architecture".</p>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md770"></a>
Technology Stack</h2>
<p>The frontend leverages a modern technology stack centered around the React ecosystem. The core technologies and their roles are detailed below.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Technology   </th><th class="markdownTableHeadLeft">Version   </th><th class="markdownTableHeadLeft">Role    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Next.js</b>   </td><td class="markdownTableBodyLeft"><code>14.2.35</code>   </td><td class="markdownTableBodyLeft">The React framework for server-side rendering, routing, and building the application.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>React</b>   </td><td class="markdownTableBodyLeft"><code>^18.2.0</code>   </td><td class="markdownTableBodyLeft">The UI library for building components.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>TypeScript</b>   </td><td class="markdownTableBodyLeft"><code>^5.3.0</code>   </td><td class="markdownTableBodyLeft">Provides static typing for the entire codebase, ensuring type safety.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Tailwind CSS</b>   </td><td class="markdownTableBodyLeft"><code>^3.3.0</code>   </td><td class="markdownTableBodyLeft">A utility-first CSS framework for styling the application.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Plotly.js</b>   </td><td class="markdownTableBodyLeft"><code>^2.27.0</code>   </td><td class="markdownTableBodyLeft">The core library for creating the interactive 3D network visualization.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>react-plotly.js</b>   </td><td class="markdownTableBodyLeft"><code>^2.6.0</code>   </td><td class="markdownTableBodyLeft">A React wrapper for Plotly.js, integrating it into the component model.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Recharts</b>   </td><td class="markdownTableBodyLeft"><code>^2.10.0</code>   </td><td class="markdownTableBodyLeft">A composable charting library used for the metrics dashboard.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Axios</b>   </td><td class="markdownTableBodyLeft"><code>^1.13.2</code>   </td><td class="markdownTableBodyLeft">A promise-based HTTP client for communicating with the backend REST API.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Jest</b>   </td><td class="markdownTableBodyLeft"><code>^29.7.0</code>   </td><td class="markdownTableBodyLeft">The testing framework used for unit and component tests.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>React Testing Library</b>   </td><td class="markdownTableBodyLeft"><code>^14.1.2</code>   </td><td class="markdownTableBodyLeft">Provides utilities for testing React components in a user-centric way.   </td></tr>
</table>
<p>Sources: [frontend/package.json](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md771"></a>
Project Structure</h2>
<p>The frontend project is organized into a standard Next.js App Router structure. This layout separates concerns, making the codebase easy to navigate and maintain.</p>
<div class="fragment"><div class="line">frontend/</div>
<div class="line">â”œâ”€â”€ app/</div>
<div class="line">â”‚   â”œâ”€â”€ components/      # React components</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ AssetList.tsx</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ MetricsDashboard.tsx</div>
<div class="line">â”‚   â”‚   â””â”€â”€ NetworkVisualization.tsx</div>
<div class="line">â”‚   â”œâ”€â”€ lib/            # Utility libraries</div>
<div class="line">â”‚   â”‚   â”œâ”€â”€ api.ts      # API client</div>
<div class="line">â”‚   â”‚   â””â”€â”€ index.ts    # Barrel exports</div>
<div class="line">â”‚   â”œâ”€â”€ types/          # TypeScript type definitions</div>
<div class="line">â”‚   â”‚   â””â”€â”€ api.ts</div>
<div class="line">â”‚   â”œâ”€â”€ globals.css     # Global styles</div>
<div class="line">â”‚   â”œâ”€â”€ layout.tsx      # Root layout</div>
<div class="line">â”‚   â””â”€â”€ page.tsx        # Main page</div>
<div class="line">â”œâ”€â”€ public/             # Static assets</div>
<div class="line">â”œâ”€â”€ next.config.js      # Next.js configuration</div>
<div class="line">â”œâ”€â”€ package.json        # Dependencies and scripts</div>
<div class="line">â”œâ”€â”€ tsconfig.json       # TypeScript configuration</div>
<div class="line">â””â”€â”€ tailwind.config.js  # Tailwind CSS configuration</div>
</div><!-- fragment --><p><em>Source: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</em></p>
<ul>
<li><b><code>app/</code></b>: The core of the application, following the Next.js App Router convention.<ul>
<li><b><code>components/</code></b>: Contains reusable React components that form the building blocks of the UI.</li>
<li><b><code>lib/</code></b>: Houses utility functions, with <code>api.ts</code> being the most critical for backend communication.</li>
<li><b><code>types/</code></b>: Defines TypeScript interfaces for data structures, particularly for API responses.</li>
<li><b><code>page.tsx</code></b>: The main entry point and page component, which orchestrates the layout and data fetching for the different tabs.</li>
</ul>
</li>
<li><b><code>public/</code></b>: Stores static assets like images and fonts.</li>
<li><b><code>next.config.js</code></b>: Configuration file for the Next.js framework.</li>
<li><b><code>package.json</code></b>: Defines project metadata, dependencies, and scripts.</li>
</ul>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md772"></a>
Core Components</h2>
<p>The UI is built from a set of modular React components, each responsible for a specific feature. The main page (<code>page.tsx</code>) uses a tabbed interface to switch between these components.</p>
<ul>
<li><b><code>NetworkVisualization.tsx</code></b>: Renders the interactive 3D network graph using <code>react-plotly.js</code>. It takes node and edge data as props and configures the 3D scene, camera, and layout.</li>
<li><b><code>MetricsDashboard.tsx</code></b>: Displays key network statistics and analytics, such as total assets, relationships, and network density. It uses <code>Recharts</code> to render charts like the asset class distribution.</li>
<li><b><code>AssetList.tsx</code></b>: Presents a filterable and searchable table of all financial assets. It allows users to filter assets by class and sector.</li>
</ul>
<p>These components are managed by the main <code>HomePage</code> component in <code>app/page.tsx</code>, which handles data fetching and passes the required data down as props.</p>
<p>Sources: [frontend/app/page.tsx](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md773"></a>
Data Flow and API Communication</h2>
<p>The frontend is decoupled from the backend and communicates exclusively through a REST API. All API logic is encapsulated within the API client module.</p>
<h3><a class="anchor" id="autotoc_md774"></a>
API Client (<code>lib/api.ts</code>)</h3>
<p>This module uses <code>axios</code> to create a pre-configured client for making HTTP requests to the backend. The base URL is determined by the <code>NEXT_PUBLIC_API_URL</code> environment variable.</p>
<p>The following diagram illustrates the data fetching sequence when the application loads.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User</div>
<div class="line">    participant Page as &quot;HomePage (page.tsx)&quot;</div>
<div class="line">    participant APIClient as &quot;API Client (api.ts)&quot;</div>
<div class="line">    participant Backend as &quot;FastAPI Backend&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;Page: Loads application</div>
<div class="line">    activate Page</div>
<div class="line">    Page-&gt;&gt;APIClient: Calls getVisualizationData(), getMetrics(), getAssets()</div>
<div class="line">    activate APIClient</div>
<div class="line">    Note over Page,Backend: Parallel data fetching on mount</div>
<div class="line"> </div>
<div class="line">    APIClient-&gt;&gt;Backend: GET /api/visualization</div>
<div class="line">    APIClient-&gt;&gt;Backend: GET /api/metrics</div>
<div class="line">    APIClient-&gt;&gt;Backend: GET /api/assets</div>
<div class="line"> </div>
<div class="line">    Backend--&gt;&gt;APIClient: { nodes: [...], edges: [...] }</div>
<div class="line">    Backend--&gt;&gt;APIClient: { total_assets: ..., ... }</div>
<div class="line">    Backend--&gt;&gt;APIClient: [ { id: ..., symbol: ... }, ... ]</div>
<div class="line"> </div>
<div class="line">    deactivate Backend</div>
<div class="line">    APIClient--&gt;&gt;Page: Returns fetched data</div>
<div class="line">    deactivate APIClient</div>
<div class="line"> </div>
<div class="line">    Page-&gt;&gt;Page: Sets data in state (e.g., setVizData)</div>
<div class="line">    Page--&gt;&gt;User: Renders UI with data</div>
<div class="line">    deactivate Page</div>
</div><!-- fragment --><p>This diagram shows the initial parallel data fetching when the main page component mounts. <em>Sources: [frontend/app/page.tsx](), [frontend/app/lib/api.ts](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</em></p>
<h3><a class="anchor" id="autotoc_md775"></a>
Key API Functions</h3>
<p>The <code>api.ts</code> module exposes several functions to interact with the backend endpoints.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function Name   </th><th class="markdownTableHeadLeft">HTTP Method   </th><th class="markdownTableHeadLeft">Endpoint   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>healthCheck</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/health</code>   </td><td class="markdownTableBodyLeft">Checks the health of the backend API.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getAssets</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets</code>   </td><td class="markdownTableBodyLeft">Fetches a list of all assets, with optional filtering by class or sector.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getAssetDetail</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets/{id}</code>   </td><td class="markdownTableBodyLeft">Retrieves details for a single asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getAllRelationships</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/relationships</code>   </td><td class="markdownTableBodyLeft">Fetches all relationships in the graph.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getMetrics</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/metrics</code>   </td><td class="markdownTableBodyLeft">Retrieves network-wide metrics.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getVisualizationData</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/visualization</code>   </td><td class="markdownTableBodyLeft">Fetches the node and edge data required for the 3D graph.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getAssetClasses</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/asset-classes</code>   </td><td class="markdownTableBodyLeft">Gets a list of all available asset classes.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getSectors</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/sectors</code>   </td><td class="markdownTableBodyLeft">Gets a list of all available industry sectors.   </td></tr>
</table>
<p>Sources: [frontend/app/lib/api.ts](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md776"></a>
State Management</h2>
<p>State management within the frontend is handled primarily by React hooks (<code>useState</code>, <code>useEffect</code>) inside the <code>HomePage</code> component (<code>app/page.tsx</code>). There is no external state management library like Redux or Zustand.</p>
<p>The main page component manages several state variables:</p>
<ul>
<li>Data for each component (<code>vizData</code>, <code>metrics</code>, <code>assets</code>).</li>
<li>Loading status (<code>loading</code>).</li>
<li>Error status (<code>error</code>).</li>
<li>The currently active tab.</li>
</ul>
<p>The following flowchart illustrates the state transitions during the initial data load.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Component Mount] --&gt; B{Set loading = true};</div>
<div class="line">    B --&gt; C[Fetch Data from API];</div>
<div class="line">    C --&gt; D{API Call Successful?};</div>
<div class="line">    D -- Yes --&gt; E[Set data in state];</div>
<div class="line">    E --&gt; F[Set loading = false];</div>
<div class="line">    D -- No --&gt; G[Set error message];</div>
<div class="line">    G --&gt; F;</div>
</div><!-- fragment --><p>This diagram shows the simple loading, success, and error state flow managed within the main page component. <em>Source: [frontend/app/page.tsx]()</em></p>
<h2><a class="anchor" id="autotoc_md777"></a>
Configuration and Scripts</h2>
<p>Project configuration and build scripts are managed through standard Next.js and Node.js files.</p>
<h3><a class="anchor" id="autotoc_md778"></a>
Environment Variables</h3>
<p>The frontend requires a single environment variable to be set in a <code>.env.local</code> file to connect to the backend API.</p>
<ul>
<li><code>NEXT_PUBLIC_API_URL</code>: The base URL for the FastAPI backend (e.g., <code><a href="http://localhost:8000">http://localhost:8000</a></code>).</li>
</ul>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md779"></a>
<code>package.json</code> Scripts</h3>
<p>The <code>package.json</code> file defines scripts for development, building, and testing.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Script   </th><th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>dev</code>   </td><td class="markdownTableBodyLeft"><code>next dev</code>   </td><td class="markdownTableBodyLeft">Starts the Next.js development server.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>build</code>   </td><td class="markdownTableBodyLeft"><code>next build</code>   </td><td class="markdownTableBodyLeft">Creates a production-optimized build of the application.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>start</code>   </td><td class="markdownTableBodyLeft"><code>next start</code>   </td><td class="markdownTableBodyLeft">Starts the production server after a build.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>lint</code>   </td><td class="markdownTableBodyLeft"><code>next lint</code>   </td><td class="markdownTableBodyLeft">Runs ESLint to find and fix problems in the code.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>test</code>   </td><td class="markdownTableBodyLeft"><code>jest --silent</code>   </td><td class="markdownTableBodyLeft">Runs the Jest test suite in silent mode.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>test:coverage</code>   </td><td class="markdownTableBodyLeft"><code>jest --coverage --silent</code>   </td><td class="markdownTableBodyLeft">Runs tests and generates a code coverage report.   </td></tr>
</table>
<p>Source: [frontend/package.json:5-12]()</p>
<h2><a class="anchor" id="autotoc_md780"></a>
Testing</h2>
<p>The project is configured for testing using Jest and React Testing Library. The <code>package.json</code> includes scripts to run tests, generate coverage reports, and run in watch mode. The testing setup is configured in <code>jest.config.js</code> and <code>jest.setup.js</code> (not included in context, but implied by <code>package.json</code> and <code><a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a></code>). Tests cover components, API utilities, and user interactions.</p>
<p>Sources: [frontend/package.json](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>](), [README.md]()</p>
<h3><a class="anchor" id="autotoc_md781"></a>
Financial Data Models</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/models/financial_models.py">src/models/financial_models.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md782"></a>
Financial Data Models</h1>
<p>The financial data models are the structural foundation of the Financial Asset Relationship Database. They define the core entities, their attributes, and their relationships, ensuring data integrity, type safety, and a clear, extensible domain model. These models are implemented as Python <code>dataclasses</code>, providing a structured and maintainable way to represent complex financial instruments and events.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<p>The models are located in the <code>src/models/</code> directory and are a key component of the Data Layer, feeding into the Core Business Logic Layer where relationships are processed and visualizations are generated.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md783"></a>
Core Concepts</h2>
<h3><a class="anchor" id="autotoc_md784"></a>
Dataclasses and Enums</h3>
<p>The project exclusively uses Python's built-in <code>dataclasses</code> and <code>enum</code> modules for data modeling. This approach ensures type safety, clarity, and maintainability without introducing heavy external dependencies for data definition.</p>
<ul>
<li><b><code>dataclasses</code></b>: Used to define all structured data objects like <code>Asset</code>, <code>Equity</code>, and <code>Bond</code>.</li>
<li><b><code>enum</code></b>: Used for fixed sets of choices, such as <code>AssetClass</code> and <code>RegulatoryActivity</code>.</li>
</ul>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md785"></a>
Inheritance Model</h3>
<p>The system employs a clear inheritance hierarchy, with a base <code>Asset</code> class defining common properties. Specific asset types like <code>Equity</code>, <code>Bond</code>, <code>Commodity</code>, and <code>Currency</code> inherit from this base class and add their own unique attributes. This promotes code reuse and a consistent structure across all asset types.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<p>This diagram illustrates the inheritance structure of the financial asset models.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +AssetClass asset_class</div>
<div class="line">        +str currency</div>
<div class="line">        +float price</div>
<div class="line">        +str sector</div>
<div class="line">        +dict additional_fields</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +float pe_ratio</div>
<div class="line">        +float dividend_yield</div>
<div class="line">        +float eps</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +float yield_to_maturity</div>
<div class="line">        +float duration</div>
<div class="line">        +str credit_rating</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        +str contract_size</div>
<div class="line">        +str unit_of_measure</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        +str country</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md786"></a>
Data Model Schema</h2>
<h3><a class="anchor" id="autotoc_md787"></a>
Enumerations</h3>
<p>Enumerations are used to standardize categorical data within the models.</p>
<h4><a class="anchor" id="autotoc_md788"></a>
AssetClass</h4>
<p>Defines the supported types of financial assets.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Member   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>EQUITY</code>   </td><td class="markdownTableBodyNone">Represents stocks.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BOND</code>   </td><td class="markdownTableBodyNone">Represents fixed income.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>COMMODITY</code>   </td><td class="markdownTableBodyNone">Represents commodities.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURRENCY</code>   </td><td class="markdownTableBodyNone">Represents foreign exchange.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>DERIVATIVE</code>   </td><td class="markdownTableBodyNone">Represents derivatives.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h4><a class="anchor" id="autotoc_md789"></a>
RegulatoryActivity</h4>
<p>Defines the types of regulatory or corporate events.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Member   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>EARNINGS</code>   </td><td class="markdownTableBodyNone">Corporate earnings announcement.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SEC_FILING</code>   </td><td class="markdownTableBodyNone">Filing with the Securities and Exchange Commission.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>MERGER_ACQUISITION</code>   </td><td class="markdownTableBodyNone">Merger or acquisition activity.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h3><a class="anchor" id="autotoc_md790"></a>
Core Data Models</h3>
<h4><a class="anchor" id="autotoc_md791"></a>
Asset (Base Class)</h4>
<p>The <code>Asset</code> class is the abstract base for all financial instruments in the system.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Unique identifier for the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>symbol</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Ticker symbol or unique code.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>name</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Full name of the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_class</code>   </td><td class="markdownTableBodyNone"><code>AssetClass</code>   </td><td class="markdownTableBodyNone">The type of the asset (e.g., EQUITY, BOND).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>currency</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The currency of the asset's price (ISO 4217 code).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>price</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The current market price.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sector</code>   </td><td class="markdownTableBodyNone"><code>str</code> (Optional)   </td><td class="markdownTableBodyNone">Industry sector the asset belongs to.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>additional_fields</code>   </td><td class="markdownTableBodyNone"><code>dict</code> (Optional)   </td><td class="markdownTableBodyNone">A dictionary for any extra, non-standard data.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h4><a class="anchor" id="autotoc_md792"></a>
Equity</h4>
<p>Inherits from <code>Asset</code> and adds fields specific to stocks.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pe_ratio</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">Price-to-Earnings ratio.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>dividend_yield</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">Annual dividend per share as a percentage of the share's price.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>eps</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">Earnings Per Share.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h4><a class="anchor" id="autotoc_md793"></a>
Bond</h4>
<p>Inherits from <code>Asset</code> and adds fields specific to fixed-income securities.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>yield_to_maturity</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The total return anticipated on a bond if held until it matures.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>duration</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A measure of the bond's price sensitivity to interest rate changes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>credit_rating</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A rating of the bond issuer's creditworthiness.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h4><a class="anchor" id="autotoc_md794"></a>
Commodity</h4>
<p>Inherits from <code>Asset</code> and adds fields for commodities.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>contract_size</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The amount of the commodity in one contract.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>unit_of_measure</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The unit for the contract size (e.g., barrels, bushels).   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h4><a class="anchor" id="autotoc_md795"></a>
Currency</h4>
<p>Inherits from <code>Asset</code> and adds fields for currencies.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>country</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The primary country associated with the currency.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h4><a class="anchor" id="autotoc_md796"></a>
RegulatoryEvent</h4>
<p>Represents a corporate or regulatory event that can impact assets.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Unique identifier for the event.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_type</code>   </td><td class="markdownTableBodyNone"><code>RegulatoryActivity</code>   </td><td class="markdownTableBodyNone">The type of event (e.g., EARNINGS).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>date</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The date of the event (ISO 8601 format).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>description</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A description of the event.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>impact_score</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A score from -1.0 to 1.0 indicating the event's impact.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>related_assets</code>   </td><td class="markdownTableBodyNone"><code>list[str]</code>   </td><td class="markdownTableBodyNone">A list of asset IDs affected by this event.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h4><a class="anchor" id="autotoc_md797"></a>
AssetRelationship</h4>
<p>Defines a connection between two assets.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>source</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The ID of the source asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>target</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The ID of the target asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>type</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The nature of the relationship (e.g., <code>same_sector</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>strength</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The strength of the relationship, normalized from 0.0 to 1.0.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>is_bidirectional</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone">Whether the relationship is symmetric.   </td></tr>
</table>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md798"></a>
Entity Relationship Diagram</h3>
<p>This diagram shows the relationships between the main data entities. An <code>AssetRelationship</code> connects two <code>Asset</code> entities, and a <code>RegulatoryEvent</code> can be linked to multiple <code>Asset</code> entities.</p>
<div class="fragment"><div class="line">erDiagram</div>
<div class="line">    ASSET {</div>
<div class="line">        string id PK</div>
<div class="line">        string symbol</div>
<div class="line">        string name</div>
<div class="line">        AssetClass asset_class</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET_RELATIONSHIP {</div>
<div class="line">        string source_id FK</div>
<div class="line">        string target_id FK</div>
<div class="line">        string type</div>
<div class="line">        float strength</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    REGULATORY_EVENT {</div>
<div class="line">        string id PK</div>
<div class="line">        RegulatoryActivity event_type</div>
<div class="line">        string date</div>
<div class="line">        float impact_score</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET ||--o{ ASSET_RELATIONSHIP : &quot;has source&quot;</div>
<div class="line">    ASSET ||--o{ ASSET_RELATIONSHIP : &quot;has target&quot;</div>
<div class="line">    ASSET }o--o{ REGULATORY_EVENT : &quot;is affected by&quot;</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [README.md]()</p>
<h2><a class="anchor" id="autotoc_md799"></a>
Data Validation</h2>
<p>Data integrity is enforced through validation logic within the <code>__post_init__</code> method of the dataclasses. This ensures that all created objects adhere to predefined business rules.</p>
<p>Key validation rules include:</p>
<ul>
<li>Asset <code>price</code> must be non-negative.</li>
<li><code>currency</code> codes must be 3-letter ISO format strings.</li>
<li><code>RegulatoryEvent</code> <code>impact_score</code> must be within the range of -1.0 to 1.0.</li>
<li><code>RegulatoryEvent</code> <code>date</code> must be in ISO 8601 format.</li>
</ul>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md800"></a>
Conclusion</h2>
<p>The financial data models provide a robust and well-structured schema for the application's core data. By leveraging Python's native <code>dataclasses</code> and a clear inheritance structure, the models are both easy to understand and simple to extend. The built-in validation ensures a high level of data quality, which is critical for the accuracy of the relationship analysis and visualizations that form the core of the project.</p>
<h2><a class="anchor" id="autotoc_md801"></a>
Core Features</h2>
<h3><a class="anchor" id="autotoc_md802"></a>
Feature: 3D Network Visualization</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/visualizations/graph_visuals.py">src/visualizations/graph_visuals.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/visualizations/graph_2d_visuals.py">src/visualizations/graph_2d_visuals.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/components/NetworkVisualization.tsx">frontend/app/components/NetworkVisualization.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/components/NetworkVisualization.test.tsx">frontend/**tests**/components/NetworkVisualization.test.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/test-utils.test.ts">frontend/**tests**/test-utils.test.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md803"></a>
Feature: 3D Network Visualization</h1>
<p>The 3D Network Visualization is the core feature of the Financial Asset Relationship Database, providing an interactive 3D graph to explore the interconnectedness of financial assets. It supports various asset classes, including Equities, Bonds, Commodities, and Currencies, and models the relationships between them. This visualization is available through both the original Gradio UI and the newer Next.js web application.</p>
<p>The system is designed to automatically discover relationships and display them in a deterministic 3D layout, ensuring a consistent and analyzable view of the asset network. The visualization is powered by Plotly on both the Python backend and the React frontend.</p>
<p>Sources: [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md804"></a>
Architecture and Data Flow</h2>
<p>The 3D visualization feature spans the full stack, from the backend data logic to the frontend rendering component. The modern implementation uses a Next.js frontend communicating with a FastAPI backend via a REST API.</p>
<p>The diagram below illustrates the data flow for the Next.js application to render the 3D graph.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User Browser&quot;</div>
<div class="line">    participant NextJS as &quot;Next.js Frontend (Port 3000)&quot;</div>
<div class="line">    participant FastAPI as &quot;FastAPI Backend (Port 8000)&quot;</div>
<div class="line">    participant CoreLogic as &quot;Python Core Logic&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;NextJS: Loads main page</div>
<div class="line">    NextJS-&gt;&gt;FastAPI: GET /api/visualization</div>
<div class="line">    Note right of NextJS: API call made from NetworkVisualization.tsx</div>
<div class="line">    FastAPI-&gt;&gt;CoreLogic: get_3d_visualization_data()</div>
<div class="line">    Note right of FastAPI: Calls method on AssetRelationshipGraph instance</div>
<div class="line">    CoreLogic--&gt;&gt;FastAPI: Returns {nodes: [...], edges: [...]}</div>
<div class="line">    Note right of CoreLogic: Data includes 3D positions and colors</div>
<div class="line">    FastAPI--&gt;&gt;NextJS: JSON Response with visualization data</div>
<div class="line">    NextJS--&gt;&gt;User: Renders interactive 3D graph using Plotly.js</div>
</div><!-- fragment --><p>This sequence shows the clear separation of concerns: the frontend handles rendering, the backend provides a dedicated API endpoint, and the core logic is responsible for generating the visualization data structure.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [frontend/app/components/NetworkVisualization.tsx](), [<a class="el" href="api_2main_8py.html">api/main.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md805"></a>
Backend Implementation</h2>
<p>The backend is responsible for creating the data structure that the frontend uses to render the graph. This logic is encapsulated within the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class and exposed via a FastAPI endpoint.</p>
<h3><a class="anchor" id="autotoc_md806"></a>
Data Generation</h3>
<p>The core method for generating visualization data is <code>AssetRelationshipGraph.get_3d_visualization_data()</code>. This method is called by the API endpoint and returns a dictionary containing nodes and edges.</p>
<p>A key feature of the backend is the use of a fixed random seed (<code>seed=42</code>) to ensure that the 3D layout of the assets is deterministic and consistent across page loads and application restarts. This is crucial for comparative analysis.</p>
<p>The overall process is as follows:</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[API Request: GET /api/visualization] --&gt; B{Call get_3d_visualization_data};</div>
<div class="line">    B --&gt; C[Get Assets and Relationships];</div>
<div class="line">    C --&gt; D[Calculate 3D Positions (seed=42)];</div>
<div class="line">    D --&gt; E[Assign Colors by Asset Class];</div>
<div class="line">    E --&gt; F[Assign Node Sizes];</div>
<div class="line">    F --&gt; G[Format Node and Edge Data];</div>
<div class="line">    G --&gt; H[Return JSON: {nodes, edges}];</div>
</div><!-- fragment --><p>Sources: [README.md](), [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [<a class="el" href="graph__visuals_8py.html">src/visualizations/graph_visuals.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md807"></a>
API Endpoint: <code>/api/visualization</code></h3>
<p>The FastAPI backend exposes a dedicated endpoint to serve the 3D graph data.</p>
<ul>
<li><b>Endpoint</b>: <code>GET /api/visualization</code></li>
<li><b>File</b>: <code><a class="el" href="api_2main_8py.html">api/main.py</a></code></li>
<li><b>Description</b>: Retrieves the complete data structure required to render the 3D network graph. It calls the core logic and returns the data in a JSON format.</li>
</ul>
<p>The response from this endpoint contains two main keys: <code>nodes</code> and <code>edges</code>.</p>
<h4><a class="anchor" id="autotoc_md808"></a>
Response Data Structure</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Key   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>nodes</code>   </td><td class="markdownTableBodyNone"><code>Array&lt;Node&gt;</code>   </td><td class="markdownTableBodyNone">An array of objects, where each object represents an asset in the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>edges</code>   </td><td class="markdownTableBodyNone"><code>Array&lt;Edge&gt;</code>   </td><td class="markdownTableBodyNone">An array of objects, where each object represents a relationship between two assets.   </td></tr>
</table>
<p><b>Node Object Structure</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Unique identifier for the asset (e.g., "ASSET_1").    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>name</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Full name of the asset (e.g., "Apple Inc.").    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>symbol</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Ticker symbol or short identifier (e.g., "AAPL").    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_class</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">The class of the asset (e.g., "EQUITY").    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>x</code>, <code>y</code>, <code>z</code>   </td><td class="markdownTableBodyNone"><code>number</code>   </td><td class="markdownTableBodyNone">The 3D coordinates for the node's position in the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>color</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">Hex color code for the node, determined by its asset class.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>size</code>   </td><td class="markdownTableBodyNone"><code>number</code>   </td><td class="markdownTableBodyNone">The size of the node in the visualization.   </td></tr>
</table>
<p><b>Edge Object Structure</b> </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>source</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">The <code>id</code> of the source asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>target</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">The <code>id</code> of the target asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>relationship_type</code>   </td><td class="markdownTableBodyNone"><code>string</code>   </td><td class="markdownTableBodyNone">The type of relationship (e.g., "SAME_SECTOR").    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>strength</code>   </td><td class="markdownTableBodyNone"><code>number</code>   </td><td class="markdownTableBodyNone">The strength of the relationship, typically a value between 0 and 1.   </td></tr>
</table>
<p>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>](), [frontend/**tests**/test-utils.test.ts](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md809"></a>
Frontend Implementation</h2>
<p>The frontend uses a React component, <code>NetworkVisualization.tsx</code>, to render the 3D graph. This component fetches data from the <code>/api/visualization</code> endpoint and uses <code>react-plotly.js</code> to create the interactive visualization.</p>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md810"></a>
Component: <code>NetworkVisualization.tsx</code></h3>
<p>This component is responsible for:</p>
<ol type="1">
<li>Receiving the <code>nodes</code> and <code>edges</code> data as props.</li>
<li>Processing this data into a format compatible with Plotly.</li>
<li>Configuring the layout and appearance of the 3D graph.</li>
<li>Handling loading and empty states.</li>
</ol>
<p>The component's logic involves mapping the <code>nodes</code> array to Plotly's <code>scatter3d</code> trace for the assets and mapping the <code>edges</code> array to another <code>scatter3d</code> trace for the relationship lines.</p>
<p>The component's rendering logic is validated by unit tests that check for correct processing of node/edge data and proper Plotly configuration.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph NetworkVisualization.tsx</div>
<div class="line">        A[Props: {data: {nodes, edges}}] --&gt; B{Process Data};</div>
<div class="line">        B --&gt; C[Create Node Trace (scatter3d)];</div>
<div class="line">        B --&gt; D[Create Edge Trace (scatter3d)];</div>
<div class="line">        C --&gt; E[Plotly Chart];</div>
<div class="line">        D --&gt; E[Plotly Chart];</div>
<div class="line">        E --&gt; F[Render Interactive 3D Graph];</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [frontend/app/components/NetworkVisualization.tsx](), [frontend/**tests**/components/NetworkVisualization.test.tsx]()</p>
<h3><a class="anchor" id="autotoc_md811"></a>
Visualization Libraries</h3>
<p>The frontend relies on two key libraries for rendering:</p>
<ul>
<li><b><code>plotly.js</code></b>: The core JavaScript charting library that provides the 3D graphing capabilities.</li>
<li><b><code>react-plotly.js</code></b>: A React wrapper for <code>plotly.js</code> that simplifies its integration into React components.</li>
</ul>
<p>These dependencies are declared in <code>frontend/package.json</code>.</p>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>](), [frontend/**tests**/config/package-validation.test.ts]()</p>
<h2><a class="anchor" id="autotoc_md812"></a>
Conclusion</h2>
<p>The 3D Network Visualization feature is a well-architected, full-stack implementation that serves as the centerpiece of the application. It effectively separates backend data processing from frontend rendering, using a clean REST API for communication. The use of Plotly on both ends ensures powerful visualization capabilities, while the deterministic layout on the backend provides analytical consistency. The entire feature is designed to be interactive, informative, and extensible for future analytical needs.</p>
<p>Sources: [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md813"></a>
Feature: Asset Relationship Engine</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md814"></a>
Feature: Asset Relationship Engine</h1>
<p>The Asset Relationship Engine is the core business logic component of the Financial Asset Relationship Database. Its primary purpose is to automatically discover, quantify, and represent the complex relationships between various financial assets. The engine is encapsulated within the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class, which serves as the central brain for processing financial data models and generating outputs for visualization and analysis.</p>
<p>This engine powers both the original Gradio user interface and the modern Next.js frontend (via a FastAPI backend). It ingests asset data, builds a network graph of their interconnections, calculates key performance metrics, and prepares data structures for 3D visualization. The entire system is designed to be deterministic, ensuring consistent graph layouts and analysis results.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [README.md:60-61](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:28-36]()</p>
<h2><a class="anchor" id="autotoc_md815"></a>
Core Architecture</h2>
<p>The Asset Relationship Engine sits at the heart of the application, acting as a bridge between the data layer and the presentation (UI) layers. It consumes financial data models and is, in turn, called by the API/UI layers to provide processed graph data and analytics.</p>
<p>The diagram below illustrates the engine's central position within the system architecture.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Data_Layer</div>
<div class="line">        A[Financial Models &lt;br&gt; src/models/financial_models.py]</div>
<div class="line">        B[Data Sources &lt;br&gt; src/data/]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core_Business_Logic</div>
<div class="line">        C[AssetRelationshipGraph &lt;br&gt; &lt;b&gt;(The Engine)&lt;/b&gt; &lt;br&gt; src/logic/asset_graph.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API_Layer</div>
<div class="line">        D[FastAPI Backend &lt;br&gt; api/main.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph UI_Layer</div>
<div class="line">        E[Next.js UI]</div>
<div class="line">        F[Gradio UI &lt;br&gt; app.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A --&gt; C</div>
<div class="line">    B --&gt; C</div>
<div class="line">    C --&gt; D</div>
<div class="line">    C --&gt; F</div>
<div class="line">    D --&gt; E</div>
</div><!-- fragment --><p><em>This diagram shows the data flow from data sources and models into the Asset Relationship Engine, which then serves both the FastAPI backend and the Gradio UI.</em></p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:5-75](), [README.md:58-65]()</p>
<h2><a class="anchor" id="autotoc_md816"></a>
Data Models</h2>
<p>The engine operates on a set of well-defined data structures defined in <code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code>. The fundamental building block is the <code>Asset</code> dataclass, which is inherited by specific asset types.</p>
<p>Sources: [README.md:60](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:15-17]()</p>
<h3><a class="anchor" id="autotoc_md817"></a>
Asset Class Hierarchy</h3>
<p>The engine processes different classes of assets, each with its own specific attributes. The main supported classes are <code>Equity</code>, <code>Bond</code>, <code>Commodity</code>, and <code>Currency</code>.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">        +asset_class: AssetClass</div>
<div class="line">        +price: float</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +sector: str</div>
<div class="line">        +pe_ratio: float</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +issuer: str</div>
<div class="line">        +yield: float</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        +unit: str</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        +country: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p><em>This diagram shows the inheritance structure of the financial data models.</em></p>
<p>Sources: [README.md:40-45](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:15-17](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:183]()</p>
<h2><a class="anchor" id="autotoc_md818"></a>
Relationship Discovery</h2>
<p>The core function of the engine is to automatically discover relationships between assets. This is handled by the <code>build_relationships()</code> method, which iterates through all unique pairs of assets and calls <code>_find_relationships()</code> to identify specific connections.</p>
<p>Sources: [README.md:82-83](), [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md819"></a>
Discovery Process</h3>
<p>The following flowchart outlines the logic for building the relationship graph.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    start[Start build_relationships()] --&gt; A{Iterate all asset pairs (asset1, asset2)}</div>
<div class="line">    A --&gt; B[Call _find_relationships(asset1, asset2)]</div>
<div class="line">    B --&gt; C{Check for relationship types}</div>
<div class="line">    C -- Same Sector --&gt; D[Create &#39;same_sector&#39; relationship]</div>
<div class="line">    C -- Corporate Bond --&gt; E[Create &#39;corporate_bond_to_equity&#39; relationship]</div>
<div class="line">    C -- Other types... --&gt; F[...]</div>
<div class="line">    D --&gt; G[Add relationship to graph]</div>
<div class="line">    E --&gt; G</div>
<div class="line">    F --&gt; G</div>
<div class="line">    G --&gt; A</div>
<div class="line">    A -- Loop finished --&gt; stop[End]</div>
</div><!-- fragment --><p><em>This flowchart shows the process of iterating through assets to find and add relationships to the graph.</em></p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [README.md:82-83]()</p>
<h3><a class="anchor" id="autotoc_md820"></a>
Relationship Types</h3>
<p>The engine can identify several types of relationships, each with a predefined strength score.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Relationship Type   </th><th class="markdownTableHeadNone">Condition   </th><th class="markdownTableHeadNone">Default Strength   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>same_sector</code>   </td><td class="markdownTableBodyNone">Two equities are in the same industry sector.   </td><td class="markdownTableBodyNone">0.7   </td><td class="markdownTableBodyNone"><code>README.md:48</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>corporate_bond_to_equity</code>   </td><td class="markdownTableBodyNone">A bond is issued by the same company as an equity.   </td><td class="markdownTableBodyNone">0.9   </td><td class="markdownTableBodyNone"><code>README.md:49</code>, <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:31</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>commodity_exposure</code>   </td><td class="markdownTableBodyNone">An equity company is exposed to commodity prices.   </td><td class="markdownTableBodyNone">Varies   </td><td class="markdownTableBodyNone"><code>README.md:50</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>currency_risk</code>   </td><td class="markdownTableBodyNone">An asset has exposure to foreign exchange risk.   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone"><code>README.md:51</code>, <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:30</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>income_comparison</code>   </td><td class="markdownTableBodyNone">Comparing an equity's dividend yield to a bond's yield.   </td><td class="markdownTableBodyNone">Varies   </td><td class="markdownTableBodyNone"><code>README.md:52</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_impact</code>   </td><td class="markdownTableBodyNone">A regulatory event affects multiple assets.   </td><td class="markdownTableBodyNone">Varies   </td><td class="markdownTableBodyNone"><code>README.md:53</code>   </td></tr>
</table>
<p>Sources: [README.md:47-54](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:28-32]()</p>
<h2><a class="anchor" id="autotoc_md821"></a>
Analytics and Metrics</h2>
<p>The engine provides analytical capabilities through the <code>calculate_metrics()</code> method. This function computes various network statistics that offer insights into the structure and density of the asset relationship graph.</p>
<h3><a class="anchor" id="autotoc_md822"></a>
Calculated Metrics</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Metric   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>total_assets</code>   </td><td class="markdownTableBodyNone">The total number of assets (nodes) in the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>total_relationships</code>   </td><td class="markdownTableBodyNone">The total number of connections (edges) in the graph.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>network_density</code>   </td><td class="markdownTableBodyNone">A measure of how interconnected the assets are, on a scale from 0 to 1.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>avg_degree</code>   </td><td class="markdownTableBodyNone">The average number of relationships per asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>max_degree</code>   </td><td class="markdownTableBodyNone">The highest number of relationships held by a single asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_classes</code>   </td><td class="markdownTableBodyNone">A dictionary counting the number of assets in each class (e.g., Equity, Bond).   </td></tr>
</table>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>:48](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:22]()</p>
<h2><a class="anchor" id="autotoc_md823"></a>
Visualization Data Generation</h2>
<p>A key feature of the engine is its ability to generate data formatted for 3D visualization with Plotly. The <code>get_3d_visualization_data()</code> method produces a dictionary containing lists of nodes and edges with positional and styling information.</p>
<ul>
<li><b>Deterministic Layout</b>: The 3D positions of the assets are calculated using a fixed random seed (<code>seed=42</code>) to ensure the visualization is consistent and reproducible across sessions.</li>
<li><b>Node Sizing and Coloring</b>: Nodes are colored based on their <code>AssetClass</code> and sized based on their importance or connectivity within the graph.</li>
<li><b>Edge Styling</b>: Edges can be styled based on relationship <code>strength</code>.</li>
</ul>
<p>Sources: [README.md:70, 81](), [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md824"></a>
API Exposure</h2>
<p>The engine's functionalities are exposed to the Next.js frontend via a REST API built with FastAPI. The API endpoints in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code> instantiate and interact with the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> to serve data to the client.</p>
<h3><a class="anchor" id="autotoc_md825"></a>
API Interaction Flow</h3>
<p>This sequence diagram shows how a frontend request for visualization data is processed.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;Next.js UI&quot;</div>
<div class="line">    participant API as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Engine as &quot;AssetRelationshipGraph&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;API: GET /api/visualization</div>
<div class="line">    activate API</div>
<div class="line">    API-&gt;&gt;Engine: get_graph() (singleton)</div>
<div class="line">    activate Engine</div>
<div class="line">    Engine--&gt;&gt;API: Graph instance</div>
<div class="line">    deactivate Engine</div>
<div class="line">    API-&gt;&gt;Engine: get_3d_visualization_data()</div>
<div class="line">    activate Engine</div>
<div class="line">    Engine--&gt;&gt;API: {nodes: [...], edges: [...]}</div>
<div class="line">    deactivate Engine</div>
<div class="line">    API--&gt;&gt;User: JSON Response</div>
<div class="line">    deactivate API</div>
</div><!-- fragment --><p><em>This diagram shows the sequence of calls from the UI to the API and finally to the Asset Relationship Engine to fetch visualization data.</em></p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:80-97](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:15-23]()</p>
<h3><a class="anchor" id="autotoc_md826"></a>
Key API Endpoints</h3>
<p>The following endpoints directly leverage the Asset Relationship Engine:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Endpoint   </th><th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>/api/assets</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Lists all assets from the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>/api/relationships</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Returns all discovered relationships.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>/api/metrics</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Calculates and returns network metrics.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>/api/visualization</code>   </td><td class="markdownTableBodyNone">GET   </td><td class="markdownTableBodyNone">Generates and returns data for the 3D graph.   </td></tr>
</table>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:15-23](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:43-51]()</p>
<h2><a class="anchor" id="autotoc_md827"></a>
Summary</h2>
<p>The Asset Relationship Engine is the foundational component that enables the project's core value proposition. By encapsulating the logic for asset modeling, relationship discovery, analytics, and visualization data preparation, it provides a powerful and reusable service for multiple frontends. Its deterministic nature and clear separation from the UI and data layers make it a robust and central piece of the system architecture.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:20-27](), [README.md:58-61]()</p>
<h3><a class="anchor" id="autotoc_md828"></a>
Feature: Supported Asset Classes</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/models/financial_models.py">src/models/financial_models.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/data/sample_data.py">src/data/sample_data.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CHANGELOG.md">CHANGELOG.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md829"></a>
Feature: Supported Asset Classes</h1>
<p>The Financial Asset Relationship Database is designed to model and visualize connections between a variety of financial instruments. The system supports five primary asset classes: Equities, Bonds, Commodities, Currencies, and Regulatory Events. This structured approach allows for cross-asset analysis and automatic discovery of relationships.</p>
<p>The core of this feature is a well-defined data model using Python's <code>dataclasses</code> and <code>enum</code> modules. A base <code>Asset</code> class provides common attributes, and specific subclasses extend it with fields relevant to each asset type. This object-oriented hierarchy is fundamental to the system's architecture, enabling consistent handling and analysis across different financial instruments.</p>
<p><em>Sources: [README.md:31-37](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:14-16](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:83-89]()</em></p>
<h2><a class="anchor" id="autotoc_md830"></a>
Core Data Model</h2>
<p>The foundation of the asset representation is built upon a base <code>Asset</code> dataclass and an <code>AssetClass</code> enumeration to categorize each instrument.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</em></p>
<h3><a class="anchor" id="autotoc_md831"></a>
AssetClass Enum</h3>
<p>The <code>AssetClass</code> enum provides a controlled vocabulary for classifying assets. This ensures type safety and consistency throughout the application, from data creation to visualization.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:11-19](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:34-35]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Member   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>EQUITY</code>   </td><td class="markdownTableBodyNone">Represents stocks or shares in a company.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>BOND</code>   </td><td class="markdownTableBodyNone">Represents fixed-income instruments.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>COMMODITY</code>   </td><td class="markdownTableBodyNone">Represents raw materials or primary agricultural products.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURRENCY</code>   </td><td class="markdownTableBodyNone">Represents foreign exchange pairs.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>REGULATORY_EVENT</code>   </td><td class="markdownTableBodyNone">Represents corporate or regulatory events affecting assets.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md832"></a>
Asset Class Hierarchy</h3>
<p>All specific asset models inherit from a common <code>Asset</code> base class. This design ensures that all assets share a fundamental set of properties, while allowing for specialized attributes in subclasses. The diagram below illustrates this inheritance structure.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:22-101](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:83-89]()</em></p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        &lt;&lt;Abstract&gt;&gt;</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +AssetClass asset_class</div>
<div class="line">        +str sector</div>
<div class="line">        +str currency</div>
<div class="line">        +float price</div>
<div class="line">        +float market_cap</div>
<div class="line">        +dict additional_fields</div>
<div class="line">        +__post_init__()</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Equity {</div>
<div class="line">        +float pe_ratio</div>
<div class="line">        +float dividend_yield</div>
<div class="line">        +float eps</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Bond {</div>
<div class="line">        +float yield_</div>
<div class="line">        +float duration</div>
<div class="line">        +str credit_rating</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Commodity {</div>
<div class="line">        +str futures_contract_specs</div>
<div class="line">        +float spot_price</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Currency {</div>
<div class="line">        +str country</div>
<div class="line">        +float interest_rate</div>
<div class="line">        +str central_bank</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class RegulatoryEvent {</div>
<div class="line">        +RegulatoryActivity activity_type</div>
<div class="line">        +date event_date</div>
<div class="line">        +float impact_score</div>
<div class="line">        +str description</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
<div class="line">    Asset &lt;|-- RegulatoryEvent</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md833"></a>
Base Asset Model</h3>
<p>The <code>Asset</code> dataclass defines the common attributes shared by all financial instruments in the system. It includes validation in its <code>__post_init__</code> method to ensure data integrity, such as checking for non-negative prices.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:22-47](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:21-23]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Constraints    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A unique identifier for the asset.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>symbol</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The ticker symbol or other short identifier.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>name</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The full name of the asset.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_class</code>   </td><td class="markdownTableBodyNone"><code>AssetClass</code>   </td><td class="markdownTableBodyNone">The type of the asset, from the <code>AssetClass</code> enum.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sector</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The industry sector the asset belongs to.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>currency</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The currency of the asset's price (3-letter ISO code).   </td><td class="markdownTableBodyNone">Must be 3 uppercase letters.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>price</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The current market price of the asset.   </td><td class="markdownTableBodyNone">Must be non-negative.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>market_cap</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The total market capitalization.   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>additional_fields</code>   </td><td class="markdownTableBodyNone"><code>dict</code>   </td><td class="markdownTableBodyNone">A dictionary for any extra, non-standard data.   </td><td class="markdownTableBodyNone"></td></tr>
</table>
<h2><a class="anchor" id="autotoc_md834"></a>
Detailed Asset Classes</h2>
<p>The system supports five specialized asset classes, each inheriting from the base <code>Asset</code> model and adding its own unique attributes. These were introduced in version 1.0.0 of the project.</p>
<p><em>Sources: [<a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a>:52-56](), [README.md:32-37]()</em></p>
<h3><a class="anchor" id="autotoc_md835"></a>
Equities</h3>
<p>Represents ownership stakes in a public company. The <code>Equity</code> class adds standard financial metrics used for stock valuation.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:50-57]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pe_ratio</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">Price-to-Earnings ratio.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>dividend_yield</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The ratio of the annual dividend to the share price.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>eps</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">Earnings Per Share.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md836"></a>
Fixed Income (Bonds)</h3>
<p>Represents debt instruments. The <code>Bond</code> class includes attributes related to yield and credit risk.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:60-67]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>yield_</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The yield to maturity of the bond.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>duration</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A measure of the bond's interest rate sensitivity.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>credit_rating</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The credit rating from an agency (e.g., AAA, BB+).   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md837"></a>
Commodities</h3>
<p>Represents physical goods or raw materials. The <code>Commodity</code> class includes details about futures contracts and spot pricing.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:70-75]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>futures_contract_specs</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Specifications for the futures contract.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>spot_price</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The current market price for immediate delivery.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md838"></a>
Currencies</h3>
<p>Represents foreign exchange instruments. The <code>Currency</code> class adds macroeconomic indicators relevant to a currency's value.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:78-84]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>country</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The primary country associated with the currency.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>interest_rate</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The central bank's benchmark interest rate.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>central_bank</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The name of the central bank issuing the currency.   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md839"></a>
Regulatory Events</h3>
<p>Represents significant events that can impact other assets. The <code>RegulatoryEvent</code> model includes an impact score and a type classification.</p>
<p><em>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>:87-101]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attribute   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Constraints    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>activity_type</code>   </td><td class="markdownTableBodyNone"><code>RegulatoryActivity</code>   </td><td class="markdownTableBodyNone">The type of event (e.g., Earnings, M&amp;A).   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_date</code>   </td><td class="markdownTableBodyNone"><code>date</code>   </td><td class="markdownTableBodyNone">The date the event occurred.   </td><td class="markdownTableBodyNone">Must be a valid ISO 8601 date.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>impact_score</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A score from -1.0 (negative) to 1.0 (positive).   </td><td class="markdownTableBodyNone">Must be within [-1.0, 1.0].    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>description</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A brief description of the event.   </td><td class="markdownTableBodyNone"></td></tr>
</table>
<h2><a class="anchor" id="autotoc_md840"></a>
Extensibility</h2>
<p>The system is designed to be extensible, allowing for the addition of new asset types. To add a new asset class, a developer can create a new dataclass that inherits from the base <code>Asset</code> class. This pattern is encouraged for future expansion.</p>
<p>The example below, taken from the project's documentation, shows how a <code>Derivative</code> asset could be added.</p>
<p><em>Sources: [README.md:73-84]()</em></p>
<div class="fragment"><div class="line"><span class="keyword">from</span> src.models.financial_models <span class="keyword">import</span> Asset, AssetClass</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Extend Asset for new types</span></div>
<div class="line"><span class="preprocessor">@dataclass</span></div>
<div class="line"><span class="keyword">class </span>Derivative(Asset):</div>
<div class="line">    underlying_asset: str</div>
<div class="line">    expiration_date: str</div>
<div class="line">    strike_price: Optional[float] = <span class="keywordtype">None</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md841"></a>
Conclusion</h2>
<p>The project's support for diverse asset classes is built on a robust and extensible object-oriented data model. By using a common base class and specialized subclasses, the system can consistently manage, analyze, and visualize a wide range of financial instruments and the complex relationships between them. This structured approach is central to the application's ability to provide meaningful cross-asset insights.</p>
<h3><a class="anchor" id="autotoc_md842"></a>
Feature: Metrics and Analytics</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/visualizations/metric_visuals.py">src/visualizations/metric_visuals.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/components/MetricsDashboard.tsx">frontend/app/components/MetricsDashboard.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md843"></a>
Feature: Metrics and Analytics</h1>
<p>The Metrics and Analytics feature provides a quantitative overview of the financial asset network's structure and complexity. It calculates key statistical metrics from the underlying graph data and presents them through two distinct user interfaces: a modern Next.js dashboard and the original Gradio UI. This functionality is crucial for users to quickly assess the density, composition, and overall scale of the interconnected assets.</p>
<p>The system is designed to provide real-time metrics that are recalculated whenever the asset graph is updated, ensuring that the analytics always reflect the current state of the data. This feature is central to the project's goal of offering comprehensive analysis of asset relationships.</p>
<p>Sources: [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md844"></a>
Architecture and Data Flow</h2>
<p>The metrics and analytics functionality spans from the core business logic layer, through the API, to the user interface. The <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class is the single source of truth for all metric calculations. This data is then exposed via a FastAPI endpoint to the Next.js frontend or consumed directly by the Gradio UI.</p>
<p>This diagram illustrates the data flow for the metrics feature across both frontend implementations.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Core Logic</div>
<div class="line">        A[src/logic/asset_graph.py] --&gt;|calculate_metrics()| B(Metrics Dictionary)</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API and Frontend</div>
<div class="line">        subgraph Gradio UI</div>
<div class="line">            B --&gt;|Direct Call| C[src/visualizations/metric_visuals.py]</div>
<div class="line">            C --&gt; D[Plotly Gauge &amp; Pie Charts]</div>
<div class="line">            D --&gt; E[Gradio Dashboard]</div>
<div class="line">        end</div>
<div class="line"> </div>
<div class="line">        subgraph Next.js UI</div>
<div class="line">            B --&gt;|FastAPI Endpoint| F(GET /api/metrics)</div>
<div class="line">            F --&gt;|Axios Request| G[frontend/app/lib/api.ts]</div>
<div class="line">            G --&gt; H[frontend/app/components/MetricsDashboard.tsx]</div>
<div class="line">            H --&gt; I[React Component Rendering]</div>
<div class="line">        end</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md845"></a>
Backend: Metric Calculation</h2>
<p>All network metrics are computed within the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class, specifically in the <code>calculate_metrics</code> method. This method aggregates data about the nodes (assets) and edges (relationships) to produce a dictionary of key statistics.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [README.md]()</p>
<h3><a class="anchor" id="autotoc_md846"></a>
Core Method: <code>calculate_metrics</code></h3>
<p>This method is responsible for calculating all network statistics. It raises a <code>ValueError</code> if the graph is empty.</p>
<p>The following table details the metrics calculated by this method.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Metric Key   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Calculation Logic    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>total_assets</code>   </td><td class="markdownTableBodyLeft">The total number of assets (nodes) in the graph.   </td><td class="markdownTableBodyLeft"><code>len(self.assets)</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>total_relationships</code>   </td><td class="markdownTableBodyLeft">The total number of relationships (edges) in the graph.   </td><td class="markdownTableBodyLeft"><code>len(self.relationships)</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>average_relationship_strength</code>   </td><td class="markdownTableBodyLeft">The mean strength of all relationships, clamped between 0 and 1.   </td><td class="markdownTableBodyLeft">&lsquo;np.mean([r['strength&rsquo;] for r in self.relationships])<code>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>network_density<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; A measure of how interconnected the graph is. A value of 1 means all possible connections exist. \ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>(2 * num_relationships) / (num_assets * (num_assets - 1))<code>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>asset_classes<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; A breakdown of assets by their class (e.g., Equity, Bond). \ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Counts assets for each</code>AssetClass<code>enum member. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>average_degree<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; The average number of connections per asset. \ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>(2 * num_relationships) / num_assets<code>\ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>max_degree<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; The highest number of connections for any single asset in the network. \ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>max(degrees)<code>where</code>degrees` is a list of connection counts per asset.   </td></tr>
</table>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>:218-268](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md847"></a>
API Layer: Exposing Metrics</h2>
<p>The calculated metrics are exposed to the Next.js frontend via a dedicated REST API endpoint managed by FastAPI.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md848"></a>
Endpoint: <code>GET /api/metrics</code></h3>
<p>This endpoint retrieves the calculated metrics from the singleton <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> instance and returns them as a JSON object.</p>
<p>The data flow for a frontend request is as follows:</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as &quot;User Interface&quot;</div>
<div class="line">    participant NextApp as &quot;Next.js Frontend&quot;</div>
<div class="line">    participant API as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Graph as &quot;AssetRelationshipGraph&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;NextApp: Loads Metrics Dashboard</div>
<div class="line">    NextApp-&gt;&gt;API: GET /api/metrics</div>
<div class="line">    activate API</div>
<div class="line">    API-&gt;&gt;Graph: get_graph()</div>
<div class="line">    Graph--&gt;&gt;API: Singleton instance</div>
<div class="line">    API-&gt;&gt;Graph: calculate_metrics()</div>
<div class="line">    Graph--&gt;&gt;API: Metrics Dictionary</div>
<div class="line">    API--&gt;&gt;NextApp: 200 OK (JSON Response)</div>
<div class="line">    deactivate API</div>
<div class="line">    NextApp--&gt;&gt;User: Renders Metric Cards</div>
</div><!-- fragment --><p>This sequence shows the Next.js application fetching metrics from the FastAPI backend, which in turn calls the core logic to perform the calculation.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md849"></a>
Data Model: <code>MetricsResponse</code></h3>
<p>The API response is validated using a Pydantic model to ensure type safety and consistency.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Field   </th><th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>total_assets</code>   </td><td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft">Total number of assets.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>total_relationships</code>   </td><td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft">Total number of relationships.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>average_relationship_strength</code>   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">Average strength of relationships.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>network_density</code>   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">Density of the network graph.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>asset_classes</code>   </td><td class="markdownTableBodyLeft"><code>Dict[str, int]</code>   </td><td class="markdownTableBodyLeft">Count of assets per class.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>average_degree</code>   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">Average connections per asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>max_degree</code>   </td><td class="markdownTableBodyLeft"><code>int</code>   </td><td class="markdownTableBodyLeft">Maximum connections for a single asset.   </td></tr>
</table>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md850"></a>
Frontend: Displaying Metrics</h2>
<p>The project provides two different UIs for displaying the calculated metrics, each with its own implementation.</p>
<h3><a class="anchor" id="autotoc_md851"></a>
Next.js Metrics Dashboard</h3>
<p>The Next.js frontend features a <code>MetricsDashboard</code> React component that fetches data from the <code>/api/metrics</code> endpoint and displays it in a series of cards.</p>
<p>Sources: [frontend/app/components/MetricsDashboard.tsx](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h4><a class="anchor" id="autotoc_md852"></a>
Component: <code>MetricsDashboard.tsx</code></h4>
<p>This component is responsible for:</p>
<ol type="1">
<li>Receiving metrics data as props.</li>
<li>Rendering individual "metric cards" for each key statistic.</li>
<li>Formatting numerical data for readability (e.g., percentages, large numbers).</li>
<li>Displaying the asset class breakdown.</li>
</ol>
<p>Key features of the component include:</p>
<ul>
<li><b>Data Formatting</b>: Values like <code>network_density</code> are formatted as percentages.</li>
<li><b>Edge Case Handling</b>: Correctly displays <code>0</code> for metrics when the data is empty or null, preventing <code>NaN</code> errors.</li>
<li><b>Visual Consistency</b>: Ensures a uniform look and feel for all displayed metrics.</li>
</ul>
<p>The following metrics are displayed on the dashboard:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Metric Displayed   </th><th class="markdownTableHeadLeft">Data Source   </th><th class="markdownTableHeadLeft">Formatting    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Total Assets   </td><td class="markdownTableBodyLeft"><code>metrics.total_assets</code>   </td><td class="markdownTableBodyLeft">Raw integer    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Total Relationships   </td><td class="markdownTableBodyLeft"><code>metrics.total_relationships</code>   </td><td class="markdownTableBodyLeft">Raw integer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Network Density   </td><td class="markdownTableBodyLeft"><code>metrics.network_density</code>   </td><td class="markdownTableBodyLeft">Percentage (2 decimal places)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Average Degree   </td><td class="markdownTableBodyLeft"><code>metrics.average_degree</code>   </td><td class="markdownTableBodyLeft">Number (2 decimal places)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Max Degree   </td><td class="markdownTableBodyLeft"><code>metrics.max_degree</code>   </td><td class="markdownTableBodyLeft">Raw integer    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Asset Classes   </td><td class="markdownTableBodyLeft"><code>metrics.asset_classes</code>   </td><td class="markdownTableBodyLeft">List of class names and counts   </td></tr>
</table>
<p>Sources: [frontend/app/components/MetricsDashboard.tsx:11-80](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md853"></a>
Gradio Metrics Dashboard</h3>
<p>The original Gradio UI uses Plotly to create a more visual representation of the metrics, including gauge and pie charts.</p>
<p>Sources: [<a class="el" href="metric__visuals_8py.html">src/visualizations/metric_visuals.py</a>]()</p>
<h4><a class="anchor" id="autotoc_md854"></a>
Functions</h4>
<ul>
<li><b><code>create_metrics_dashboard(metrics)</code></b>: The main function that orchestrates the creation of the entire dashboard layout in Gradio. It calls other helper functions to generate individual plots.</li>
<li><b><code>create_gauge_chart(value, title, reference)</code></b>: Generates a Plotly gauge chart, used for displaying metrics like "Network Density" and "Avg. Relationship Strength".</li>
<li><b><code>create_asset_class_pie_chart(asset_classes)</code></b>: Creates a Plotly pie chart to visualize the distribution of different asset classes.</li>
</ul>
<p>The Gradio dashboard provides a different visual take on the same underlying data, emphasizing visual indicators over raw numbers for some metrics.</p>
<p>Sources: [<a class="el" href="metric__visuals_8py.html">src/visualizations/metric_visuals.py</a>:11-103]()</p>
<h2><a class="anchor" id="autotoc_md855"></a>
Summary</h2>
<p>The Metrics and Analytics feature is a cornerstone of the application, providing essential insights into the structure of the financial asset graph. By centralizing the calculation logic in <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> and offering flexible display options through both a modern Next.js/FastAPI stack and a classic Gradio interface, the system ensures data consistency while catering to different presentation needs. The clear separation of concernsâ€”from calculation to API exposure to frontend renderingâ€”makes the feature robust, testable, and extensible.</p>
<p>Sources: [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md856"></a>
Feature: Regulatory Event Integration</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/models/financial_models.py">src/models/financial_models.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CHANGELOG.md">CHANGELOG.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md857"></a>
Feature: Regulatory Event Integration</h1>
<p>The Regulatory Event Integration feature allows the system to model the impact of corporate and regulatory activities, such as SEC filings or M&amp;A announcements, on financial assets. This is achieved by representing these events as distinct nodes within the asset relationship graph. These event nodes create directional relationships with the assets they affect, with the relationship's strength determined by a predefined impact score. This adds a layer of qualitative, event-driven analysis to the quantitative market data.</p>
<p>Sources: [README.md](), [<a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md858"></a>
Data Models for Regulatory Events</h2>
<p>The feature is built upon two primary data structures defined in the <code><a class="el" href="financial__models_8py.html">financial_models.py</a></code> module: the <code>RegulatoryActivity</code> enum and the <code>RegulatoryEvent</code> dataclass.</p>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md859"></a>
RegulatoryActivity Enum</h3>
<p>This enumeration defines the types of regulatory activities that can be modeled. It provides a fixed set of choices for categorizing events.</p>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md860"></a>
RegulatoryEvent Dataclass</h3>
<p>The <code>RegulatoryEvent</code> is a specialized type of <code>Asset</code> that encapsulates all information about a specific event. It includes a list of impacted asset symbols and an <code>impact_score</code> to quantify the event's effect.</p>
<p>The diagram below shows the structure of the <code>RegulatoryEvent</code> class and its relation to the base <code>Asset</code> class and <code>RegulatoryActivity</code> enum.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +AssetClass asset_class</div>
<div class="line">    }</div>
<div class="line">    class RegulatoryEvent {</div>
<div class="line">        +str date</div>
<div class="line">        +RegulatoryActivity activity_type</div>
<div class="line">        +list[str] impacted_symbols</div>
<div class="line">        +float impact_score</div>
<div class="line">        +str description</div>
<div class="line">        +__post_init__() void</div>
<div class="line">    }</div>
<div class="line">    class RegulatoryActivity {</div>
<div class="line">        &lt;&lt;enumeration&gt;&gt;</div>
<div class="line">        EARNINGS_RELEASE</div>
<div class="line">        SEC_FILING</div>
<div class="line">        MERGER_ACQUISITION</div>
<div class="line">        PRODUCT_LAUNCH</div>
<div class="line">        LEGAL_RULING</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- RegulatoryEvent</div>
<div class="line">    RegulatoryEvent o-- RegulatoryActivity</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<p>The fields of the <code>RegulatoryEvent</code> dataclass are detailed in the table below.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Constraints    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Unique identifier for the event.   </td><td class="markdownTableBodyNone">Inherited from <code>Asset</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>name</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A descriptive name for the event.   </td><td class="markdownTableBodyNone">Inherited from <code>Asset</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>date</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The date of the event in ISO 8601 format.   </td><td class="markdownTableBodyNone">Must be a valid ISO 8601 date string.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>activity_type</code>   </td><td class="markdownTableBodyNone"><code>RegulatoryActivity</code>   </td><td class="markdownTableBodyNone">The type of regulatory activity (e.g., <code>EARNINGS_RELEASE</code>).   </td><td class="markdownTableBodyNone">Must be a member of the <code>RegulatoryActivity</code> enum.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>impacted_symbols</code>   </td><td class="markdownTableBodyNone"><code>List[str]</code>   </td><td class="markdownTableBodyNone">A list of asset symbols (e.g., stock tickers) that are affected by this event.   </td><td class="markdownTableBodyNone">-    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>impact_score</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A normalized score from -1.0 (negative impact) to +1.0 (positive impact) quantifying the event's effect.   </td><td class="markdownTableBodyNone">Must be between -1.0 and 1.0, inclusive.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>description</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A detailed text description of the event.   </td><td class="markdownTableBodyNone">-   </td></tr>
</table>
<p>The <code>__post_init__</code> method in the <code>RegulatoryEvent</code> dataclass performs validation to ensure the <code>impact_score</code> is within its valid range and that the <code>date</code> conforms to the ISO 8601 standard.</p>
<p>Sources: [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md861"></a>
Integration into the Asset Relationship Graph</h2>
<p>Regulatory events are integrated into the graph during the relationship-building phase, which is handled by the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class. The system identifies assets that are <code>RegulatoryEvent</code> instances and creates directional relationships to the assets listed in their <code>impacted_symbols</code> field.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md862"></a>
Relationship Discovery Logic</h3>
<p>The core logic resides within the <code>_find_relationships</code> method of the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>. The process for handling regulatory events is as follows:</p>
<ol type="1">
<li>The method iterates through all pairs of assets in the graph.</li>
<li>It checks if one of the assets in a pair is an instance of <code>RegulatoryEvent</code>.</li>
<li>If an event is found, the logic iterates through the <code>impacted_symbols</code> defined within that event object.</li>
<li>For each <code>impacted_symbol</code>, it checks if the other asset in the pair has a matching symbol.</li>
<li>If a match is found, a new directional relationship of type <code>event_impact</code> is created from the event to the impacted asset.</li>
</ol>
<p>The following flowchart illustrates this discovery process.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start _find_relationships] --&gt; B{Iterate through asset pairs (asset1, asset2)};</div>
<div class="line">    B --&gt; C{Is asset1 a RegulatoryEvent?};</div>
<div class="line">    C -- Yes --&gt; D{Iterate through impacted_symbols in asset1};</div>
<div class="line">    D --&gt; E{Does asset2.symbol match an impacted_symbol?};</div>
<div class="line">    E -- Yes --&gt; F[Create &#39;event_impact&#39; relationship from asset1 to asset2];</div>
<div class="line">    F --&gt; D;</div>
<div class="line">    E -- No --&gt; D;</div>
<div class="line">    D -- End of symbols --&gt; B;</div>
<div class="line">    C -- No --&gt; B;</div>
<div class="line">    B -- End of pairs --&gt; G[End];</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md863"></a>
The 'Event Impact' Relationship</h2>
<p>The integration of regulatory events introduces a unique, directional relationship type called <code>event_impact</code>.</p>
<ul>
<li><b>Directionality</b>: The relationship is always directed <em>from</em> the <code>RegulatoryEvent</code> <em>to</em> the impacted financial asset (e.g., an <code>Equity</code>). This signifies that the event causes an effect on the asset.</li>
<li><b>Strength</b>: The strength of the <code>event_impact</code> relationship is directly derived from the <code>impact_score</code> of the <code>RegulatoryEvent</code>. This allows the graph to model both the existence and the magnitude of an event's influence.</li>
</ul>
<p>This diagram shows an example of an <code>event_impact</code> relationship.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph &quot;Asset Relationship Graph&quot;</div>
<div class="line">        direction LR</div>
<div class="line">        Event[(&quot;Regulatory Event&lt;br&gt;M&amp;A Announcement&lt;br&gt;impact_score: 0.8&quot;)]</div>
<div class="line">        Asset[(&quot;Equity&lt;br&gt;AAPL&quot;)]</div>
<div class="line"> </div>
<div class="line">        Event -- &quot;event_impact&lt;br&gt;strength: 0.8&quot; --&gt; Asset</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [README.md]()</p>
<h2><a class="anchor" id="autotoc_md864"></a>
Validation and Testing</h2>
<p>The system ensures the integrity of regulatory event data through validation and comprehensive testing.</p>
<ul>
<li><b>Data Validation</b>: As noted in the audit report, the <code>RegulatoryEvent</code> model includes <code>__post_init__</code> validation for the <code>impact_score</code> (must be between -1 and 1) and the date format (must be ISO 8601). This prevents malformed event data from entering the system.</li>
<li><b>Unit Testing</b>: The test suite includes fixtures like <code>sample_regulatory_event</code> in <code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code> to create valid event objects for testing. Unit tests in <code><a class="el" href="test__financial__models_8py.html">tests/unit/test_financial_models.py</a></code> and <code><a class="el" href="test__asset__graph_8py.html">tests/unit/test_asset_graph.py</a></code> verify both the model's validation logic and the graph's ability to correctly build relationships from these events.</li>
</ul>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md865"></a>
Summary</h2>
<p>The Regulatory Event Integration feature is a key component for adding qualitative depth to the financial asset graph. By modeling external events as nodes and creating directional, weighted relationships, the system can represent how non-market activities influence specific assets. This is supported by a robust data model with built-in validation and is a core part of the relationship discovery engine.</p>
<p>Sources: [README.md](), [<a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md866"></a>
Data Management and Flow</h2>
<h3><a class="anchor" id="autotoc_md867"></a>
Database Schema</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><code><a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a></code></li>
<li><code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code></li>
<li><code><a class="el" href="AI__RULES_8md.html">AI_RULES.md</a></code></li>
<li><code>README.md</code></li>
<li><code><a class="el" href="SECURITY_8md.html">SECURITY.md</a></code></li>
<li><code><a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a></code></li>
<li><code><a class="el" href="DEPENDENCY__IMPROVEMENTS_8md.html">DEPENDENCY_IMPROVEMENTS.md</a></code></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md868"></a>
Database Schema</h1>
<p>The Financial Asset Relationship Database system is designed to model and visualize complex relationships between various financial assets. The data architecture is evolving from an in-memory model to a persistent database system to ensure scalability, data integrity, and support for advanced analytics. This document outlines both the current in-memory data models and the planned future database schema.</p>
<p>The core of the data layer is built around Python <code>dataclasses</code> which define the structure for assets and their relationships. The future architecture will translate these models into a relational database schema, likely using PostgreSQL, and will be accessed via a Repository Pattern to decouple business logic from data storage.</p>
<p>Sources: [<code><a class="el" href="AI__RULES_8md.html">AI_RULES.md</a></code>](), [<code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>](), [<code><a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a></code>]()</p>
<h2><a class="anchor" id="autotoc_md869"></a>
Data Models (In-Memory)</h2>
<p>The application currently relies on a set of well-defined Python <code>dataclasses</code> to represent financial entities. This approach ensures type safety and clear data definitions for the in-memory graph structure. The primary models are defined for different asset classes, all inheriting from a base <code>Asset</code> class.</p>
<p>Sources: [<code><a class="el" href="AI__RULES_8md.html">AI_RULES.md</a></code>](), [<code>README.md:65-73</code>]()</p>
<h3><a class="anchor" id="autotoc_md870"></a>
Model Inheritance Diagram</h3>
<p>The following diagram illustrates the inheritance hierarchy of the financial data models.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +AssetClass asset_class</div>
<div class="line">        +str sector</div>
<div class="line">        +float price</div>
<div class="line">        +str currency</div>
<div class="line">        +dict additional_fields</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +float pe_ratio</div>
<div class="line">        +float dividend_yield</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +float yield</div>
<div class="line">        +float duration</div>
<div class="line">        +str credit_rating</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        +str contract_size</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        +str country</div>
<div class="line">    }</div>
<div class="line">    class RegulatoryEvent {</div>
<div class="line">        +str event_type</div>
<div class="line">        +float impact_score</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p>Sources: [<code>README.md:65-73</code>](), [<code><a class="el" href="AI__RULES_8md.html">AI_RULES.md</a></code>]()</p>
<h3><a class="anchor" id="autotoc_md871"></a>
Core Asset Models</h3>
<p>The system supports several asset classes, each with specific attributes.</p>
<h4><a class="anchor" id="autotoc_md872"></a>
Asset (Base Class)</h4>
<p>This is the foundational data class from which all specific asset types inherit.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Field   </th><th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>id</code>   </td><td class="markdownTableBodyLeft"><code>str</code>   </td><td class="markdownTableBodyLeft">Unique identifier for the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>symbol</code>   </td><td class="markdownTableBodyLeft"><code>str</code>   </td><td class="markdownTableBodyLeft">The ticker or symbol for the asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>name</code>   </td><td class="markdownTableBodyLeft"><code>str</code>   </td><td class="markdownTableBodyLeft">The full name of the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>asset_class</code>   </td><td class="markdownTableBodyLeft"><code><a class="el" href="classEnum.html">Enum</a></code>   </td><td class="markdownTableBodyLeft">The type of asset (e.g., EQUITY, BOND).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>sector</code>   </td><td class="markdownTableBodyLeft"><code>str</code>   </td><td class="markdownTableBodyLeft">The industry sector the asset belongs to.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>price</code>   </td><td class="markdownTableBodyLeft"><code>float</code>   </td><td class="markdownTableBodyLeft">The current market price.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>currency</code>   </td><td class="markdownTableBodyLeft"><code>str</code>   </td><td class="markdownTableBodyLeft">The currency of the price (3-letter ISO code).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>additional_fields</code>   </td><td class="markdownTableBodyLeft"><code>dict</code>   </td><td class="markdownTableBodyLeft">A dictionary for any extra attributes.   </td></tr>
</table>
<p>Sources: [<code>README.md:65-73</code>](), [<code><a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a></code>]()</p>
<h4><a class="anchor" id="autotoc_md873"></a>
Other Asset Types</h4>
<ul>
<li><b>Equity</b>: Represents stocks and includes fields like <code>pe_ratio</code> and <code>dividend_yield</code>.</li>
<li><b>Bond</b>: Represents fixed-income securities with fields like <code>yield</code>, <code>duration</code>, and <code>credit_rating</code>.</li>
<li><b>Commodity</b>: Represents physical goods or raw materials.</li>
<li><b>Currency</b>: Represents foreign exchange pairs.</li>
<li><b>Regulatory Events</b>: Models corporate events like SEC filings or M&amp;A activities that can impact assets. It includes an <code>impact_score</code> from -1 to +1.</li>
</ul>
<p>Sources: [<code>README.md:65-73</code>]()</p>
<h2><a class="anchor" id="autotoc_md874"></a>
Planned Database Architecture</h2>
<p>To support data persistence, real-time updates, and advanced analytics, the project architecture is planned to incorporate a relational database. The recommended approach involves using a <b>Repository Pattern</b> to abstract data access and a <b>Service Layer</b> for business logic.</p>
<p>Sources: [<code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>](), [<code><a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a></code>]()</p>
<h3><a class="anchor" id="autotoc_md875"></a>
Architectural Layers</h3>
<p>This diagram shows the proposed layers for interacting with the database.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    A[API Layer / UI] --&gt; B[Service Layer];</div>
<div class="line">    B --&gt; C[Repository Interface];</div>
<div class="line">    C --&gt; D[PostgresRepository];</div>
<div class="line">    D --&gt; E[PostgreSQL Database];</div>
<div class="line">    C --&gt; F[InMemoryRepository];</div>
<div class="line">    F --&gt; G[In-Memory Graph];</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Business Logic&quot;</div>
<div class="line">        B</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Data Access Abstraction&quot;</div>
<div class="line">        C</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Data Access Implementation&quot;</div>
<div class="line">        D</div>
<div class="line">        F</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Data Storage&quot;</div>
<div class="line">        E</div>
<div class="line">        G</div>
<div class="line">    end</div>
</div><!-- fragment --><p>This architecture allows the application to switch between an in-memory store and a persistent PostgreSQL database by simply changing the repository implementation injected into the service layer.</p>
<p>Sources: [<code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>]()</p>
<h3><a class="anchor" id="autotoc_md876"></a>
Proposed Entity-Relationship Diagram (ERD)</h3>
<p>The following ERD represents a possible database schema based on the existing in-memory data models. It includes tables for assets, their specific attributes, and the relationships between them.</p>
<div class="fragment"><div class="line">erDiagram</div>
<div class="line">    ASSET {</div>
<div class="line">        varchar(255) id PK</div>
<div class="line">        varchar(255) symbol</div>
<div class="line">        varchar(255) name</div>
<div class="line">        varchar(50) asset_class</div>
<div class="line">        varchar(100) sector</div>
<div class="line">        decimal price</div>
<div class="line">        varchar(3) currency</div>
<div class="line">        jsonb additional_fields</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    EQUITY {</div>
<div class="line">        varchar(255) asset_id PK, FK</div>
<div class="line">        decimal pe_ratio</div>
<div class="line">        decimal dividend_yield</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    BOND {</div>
<div class="line">        varchar(255) asset_id PK, FK</div>
<div class="line">        decimal yield</div>
<div class="line">        decimal duration</div>
<div class="line">        varchar(10) credit_rating</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    REGULATORY_EVENT {</div>
<div class="line">        varchar(255) id PK</div>
<div class="line">        varchar(255) event_type</div>
<div class="line">        text description</div>
<div class="line">        date event_date</div>
<div class="line">        decimal impact_score</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET_RELATIONSHIP {</div>
<div class="line">        varchar(255) source_asset_id PK, FK</div>
<div class="line">        varchar(255) target_asset_id PK, FK</div>
<div class="line">        varchar(100) relationship_type PK</div>
<div class="line">        decimal strength</div>
<div class="line">        boolean is_directional</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    EVENT_ASSET_LINK {</div>
<div class="line">        varchar(255) event_id PK, FK</div>
<div class="line">        varchar(255) asset_id PK, FK</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ASSET ||--o{ EQUITY : &quot;is a&quot;</div>
<div class="line">    ASSET ||--o{ BOND : &quot;is a&quot;</div>
<div class="line">    ASSET ||--o{ ASSET_RELATIONSHIP : &quot;has source&quot;</div>
<div class="line">    ASSET ||--o{ ASSET_RELATIONSHIP : &quot;has target&quot;</div>
<div class="line">    REGULATORY_EVENT ||--|{ EVENT_ASSET_LINK : &quot;affects&quot;</div>
<div class="line">    ASSET ||--|{ EVENT_ASSET_LINK : &quot;is affected by&quot;</div>
</div><!-- fragment --><p>This schema normalizes asset-specific data into separate tables (<code>EQUITY</code>, <code>BOND</code>) linked back to the main <code>ASSET</code> table. Relationships are stored in a dedicated <code>ASSET_RELATIONSHIP</code> table.</p>
<p>Sources: [<code>README.md:65-73</code>](), [<code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>]()</p>
<h2><a class="anchor" id="autotoc_md877"></a>
Database Security</h2>
<p>When implementing the database, several security best practices are recommended to protect sensitive financial data.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Practice   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Parameterized Queries</b>   </td><td class="markdownTableBodyLeft">Use parameterized queries or ORMs to prevent SQL injection attacks.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Secrets Management</b>   </td><td class="markdownTableBodyLeft">Store database credentials securely using environment variables or a secrets manager (e.g., AWS Secrets Manager, Azure Key Vault), not in code.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Connection Pooling</b>   </td><td class="markdownTableBodyLeft">Use connection pooling to manage database connections efficiently and securely.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Encryption</b>   </td><td class="markdownTableBodyLeft">Enable encryption at rest for stored data and encryption in transit (TLS/SSL) for data moving between the application and the database.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Role-Based Access</b>   </td><td class="markdownTableBodyLeft">Configure specific database user roles with the minimum required permissions.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Audit Logging</b>   </td><td class="markdownTableBodyLeft">Enable audit logging on the database to track access and changes to data.   </td></tr>
</table>
<p>Sources: [<code><a class="el" href="SECURITY_8md.html">SECURITY.md</a></code>](), [<code><a class="el" href="DEPENDENCY__IMPROVEMENTS_8md.html">DEPENDENCY_IMPROVEMENTS.md</a></code>]()</p>
<h3><a class="anchor" id="autotoc_md878"></a>
Example: Secure Query</h3>
<p>The following code snippet illustrates the use of parameterized queries to prevent SQL injection.</p>
<div class="fragment"><div class="line"><span class="comment"># GOOD - Use parameterized queries</span></div>
<div class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> text</div>
<div class="line">query = text(<span class="stringliteral">&quot;SELECT * FROM assets WHERE id = :asset_id&quot;</span>)</div>
<div class="line">result = session.execute(query, {<span class="stringliteral">&quot;asset_id&quot;</span>: asset_id})</div>
</div><!-- fragment --><p>Sources: [<code><a class="el" href="SECURITY_8md.html">SECURITY.md</a></code>]()</p>
<h2><a class="anchor" id="autotoc_md879"></a>
Conclusion</h2>
<p>The project's data architecture is strategically designed for evolution. It starts with a flexible, in-memory <code>dataclass</code>-based model that is ideal for rapid development and visualization. The clear and well-documented plan to migrate to a persistent PostgreSQL database using a repository pattern ensures that the system can scale to handle larger datasets, support more complex queries, and provide a robust foundation for future features like real-time analytics and machine learning integration. Adherence to security best practices during this transition will be critical for protecting data integrity.</p>
<h3><a class="anchor" id="autotoc_md880"></a>
Data Repository Pattern</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md881"></a>
Data Repository Pattern</h1>
<p>The Data Repository Pattern is a recommended architectural improvement for the Financial Asset Relationship Database project. Its purpose is to abstract the data access layer from the core business logic. This decouples the application from a specific data storage implementation, enhances testability, and prepares the system for future enhancements like database persistence.</p>
<p>Currently, the project's data management is tightly coupled with the business logic inside the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class. The proposed pattern introduces a dedicated <code>AssetRepository</code> to handle all data operations, creating a more scalable and maintainable layered architecture.</p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-135](), [README.md:65-68]()</p>
<h2><a class="anchor" id="autotoc_md882"></a>
Current Data Management Architecture</h2>
<p>In the existing architecture, the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class serves as both the core logic engine and an in-memory data store. The API layer (FastAPI) or UI layer (Gradio) interacts directly with this class to manage assets and relationships.</p>
<p>Sources: [README.md:65-68](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:38-46]()</p>
<p>The diagram below illustrates the current tightly-coupled data flow.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph API/UI Layer</div>
<div class="line">        A[FastAPI Endpoints]</div>
<div class="line">        B[Gradio Interface]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core Logic</div>
<div class="line">        C[AssetRelationshipGraph]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph In-Memory Storage</div>
<div class="line">        D{Assets &amp; Relationships}</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A --&gt; C</div>
<div class="line">    B --&gt; C</div>
<div class="line">    C -- Manages --&gt; D</div>
<div class="line"> </div>
<div class="line">    style C fill:#f9f,stroke:#333,stroke-width:2px</div>
</div><!-- fragment --><p><em>Diagram showing the API/UI layers directly calling <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>, which manages in-memory data.</em></p>
<p>Sources: [README.md:65-68](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:38-46]()</p>
<h2><a class="anchor" id="autotoc_md883"></a>
Proposed Repository Pattern Architecture</h2>
<p>The <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code> document recommends refactoring the architecture to introduce a formal Repository Pattern. This involves creating a dedicated repository layer that sits between the business logic (Service Layer) and the data source.</p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-125]()</p>
<h3><a class="anchor" id="autotoc_md884"></a>
Key Components</h3>
<p>The proposed architecture consists of three main components:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Component   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>AssetRepository</b>   </td><td class="markdownTableBodyLeft">An interface or class that defines data access methods like <code>get_by_id</code>, <code>get_all</code>, and <code>save</code>. It abstracts the underlying data storage mechanism.   </td><td class="markdownTableBodyLeft"><code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>AssetService</b>   </td><td class="markdownTableBodyLeft">A business logic layer that consumes the <code>AssetRepository</code>. It contains the core application logic, such as calculating portfolio risk, without knowing how data is stored.   </td><td class="markdownTableBodyLeft"><code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Dependency Injection</b>   </td><td class="markdownTableBodyLeft">A mechanism to provide the <code>AssetService</code> with a concrete implementation of the <code>AssetRepository</code>, facilitating easier testing and decoupling.   </td><td class="markdownTableBodyLeft"><code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-150]()</p>
<h3><a class="anchor" id="autotoc_md885"></a>
Proposed Data Flow</h3>
<p>The new data flow would be layered, promoting a clean separation of concerns.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[API Layer] --&gt; B[Service Layer (e.g., AssetService)]</div>
<div class="line">    B --&gt; C[Repository Interface (e.g., AssetRepository)]</div>
<div class="line">    C --&gt; D[Data Source (In-Memory or DB)]</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Business Logic&quot;</div>
<div class="line">        B</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph &quot;Data Access Layer&quot;</div>
<div class="line">        C</div>
<div class="line">    end</div>
</div><!-- fragment --><p><em>Diagram illustrating the proposed layered architecture where the API interacts with a Service Layer, which in turn uses a Repository to access data.</em></p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-150]()</p>
<h3><a class="anchor" id="autotoc_md886"></a>
<code>AssetRepository</code> Interface</h3>
<p>The <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code> document suggests the following structure for the <code>AssetRepository</code>. This interface defines the contract for all data access operations related to assets.</p>
<div class="fragment"><div class="line"><span class="comment"># Proposed in: src/repositories/asset_repository.py</span></div>
<div class="line"><span class="keyword">class </span>AssetRepository:</div>
<div class="line">    <span class="keyword">def </span>get_by_id(self, asset_id: str) -&gt; Optional[Asset]:</div>
<div class="line">        <span class="keywordflow">pass</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>get_all(self) -&gt; List[Asset]:</div>
<div class="line">        <span class="keywordflow">pass</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>save(self, asset: Asset) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line">        <span class="keywordflow">pass</span></div>
</div><!-- fragment --><p><em>Source: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:126-135]()</em></p>
<p>The following class diagram shows the proposed <code>AssetRepository</code> and its relationship with the <code>Asset</code> model.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class AssetRepository {</div>
<div class="line">        &lt;&lt;Interface&gt;&gt;</div>
<div class="line">        +get_by_id(asset_id: str) Optional[Asset]</div>
<div class="line">        +get_all() List[Asset]</div>
<div class="line">        +save(asset: Asset) None</div>
<div class="line">    }</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">    }</div>
<div class="line">    AssetRepository ..&gt; Asset : &quot;manages&quot;</div>
</div><!-- fragment --><p><em>Class diagram for the proposed <code>AssetRepository</code> interface.</em></p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:126-135](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:12-13]()</p>
<h2><a class="anchor" id="autotoc_md887"></a>
Integration with a Service Layer</h2>
<p>The repository is designed to be consumed by a service layer, which will house the business logic currently in <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>. The <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code> document provides an example of an <code>AssetService</code> that uses dependency injection to receive a repository instance.</p>
<div class="fragment"><div class="line"><span class="comment"># Proposed in: src/services/asset_service.py</span></div>
<div class="line"><span class="keyword">class </span>AssetService:</div>
<div class="line">    <span class="keyword">def </span>__init__(self, repository: AssetRepository):</div>
<div class="line">        self.repository = repository</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">def </span>calculate_portfolio_risk(self, assets: List[Asset]) -&gt; float:</div>
<div class="line">        <span class="comment"># Business logic here</span></div>
<div class="line">        <span class="keywordflow">pass</span></div>
</div><!-- fragment --><p><em>Source: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:139-147]()</em></p>
<h3><a class="anchor" id="autotoc_md888"></a>
Sequence of Operations</h3>
<p>This sequence diagram shows how a request to fetch an asset would flow through the proposed architecture.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant API as &quot;API Endpoint&quot;</div>
<div class="line">    participant Service as &quot;AssetService&quot;</div>
<div class="line">    participant Repo as &quot;AssetRepository&quot;</div>
<div class="line">    participant DS as &quot;Data Source&quot;</div>
<div class="line"> </div>
<div class="line">    API-&gt;&gt;Service: get_asset_details(&quot;AAPL&quot;)</div>
<div class="line">    activate Service</div>
<div class="line">    Service-&gt;&gt;Repo: get_by_id(&quot;AAPL&quot;)</div>
<div class="line">    activate Repo</div>
<div class="line">    Repo-&gt;&gt;DS: Retrieve asset data for &quot;AAPL&quot;</div>
<div class="line">    DS--&gt;&gt;Repo: Asset data</div>
<div class="line">    Repo--&gt;&gt;Service: Asset object</div>
<div class="line">    deactivate Repo</div>
<div class="line">    Service--&gt;&gt;API: Asset JSON response</div>
<div class="line">    deactivate Service</div>
</div><!-- fragment --><p><em>Sequence diagram showing an API request being handled by the Service, which uses the Repository to fetch data.</em></p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-150]()</p>
<h2><a class="anchor" id="autotoc_md889"></a>
Benefits of Adopting the Repository Pattern</h2>
<p>Implementing this pattern offers several advantages for the project's long-term health and scalability:</p>
<ul>
<li><b>Separation of Concerns</b>: Isolates data access logic from business logic, making the code easier to understand and maintain.</li>
<li><b>Improved Testability</b>: Business logic can be tested independently of the data layer by mocking the repository interface. This is a key part of the project's testing strategy.</li>
<li><b>Data Source Agnosticism</b>: The underlying data storage can be changed (e.g., from in-memory to a SQL database like PostgreSQL) without affecting the business logic, as long as the new data source class implements the <code>AssetRepository</code> interface.</li>
<li><b>Enables Persistence</b>: It is a prerequisite for adding a persistent data storage layer, a suggested future feature.</li>
</ul>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:123-125, 148-150](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:19-25]()</p>
<h2><a class="anchor" id="autotoc_md890"></a>
Conclusion</h2>
<p>The Data Repository Pattern is a strategic architectural improvement recommended for the <code>financial-asset-relationship-db</code> project. By transitioning from the current monolithic <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> to a layered architecture with a dedicated <code>AssetRepository</code> and <code>AssetService</code>, the project will become more modular, testable, and prepared for future features like database persistence. This change aligns with modern software design principles and is crucial for the application's evolution.</p>
<p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>](), [README.md]()</p>
<h3><a class="anchor" id="autotoc_md891"></a>
Real Data Fetching</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/data/real_data_fetcher.py">src/data/real_data_fetcher.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CHANGELOG.md">CHANGELOG.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md892"></a>
Real Data Fetching</h1>
<p>The Real Data Fetching module is responsible for acquiring live and historical financial market data from external sources. Its primary function is to populate the application's financial models with real-world data, which is essential for both the 3D visualization and the underlying analysis. This functionality is a core component of the system, supporting both the original Gradio interface and the newer FastAPI/Next.js architecture.</p>
<p>The system is standardized to use the <code>yfinance</code> library for all public financial market data acquisition, ensuring a consistent and reliable data source. This module acts as the bridge between the external Yahoo Finance API and the application's internal logic.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [<a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md893"></a>
Core Technology</h2>
<p>The project mandates the use of a specific library for financial data acquisition to ensure consistency and maintainability.</p>
<h3><a class="anchor" id="autotoc_md894"></a>
yfinance Library</h3>
<p>The <code>yfinance</code> library is the sole approved tool for retrieving public financial market data, including stock prices, company information, and news. This rule prevents the implementation of custom web scrapers or the use of other external financial APIs unless explicitly approved.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [README.md]()</p>
<h2><a class="anchor" id="autotoc_md895"></a>
Architecture and Data Flow</h2>
<p>The data fetching mechanism is centralized within the <code>src/data/</code> directory and is called by higher-level application layers like the API backend.</p>
<p>This diagram illustrates the data flow from the API layer to the external data source.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[API Layer / App Logic] --&gt; B[real_data_fetcher.py];</div>
<div class="line">    B --&gt; C{yfinance Library};</div>
<div class="line">    C --&gt; D[(Yahoo Finance API)];</div>
<div class="line">    D --&gt;&gt; C;</div>
<div class="line">    C --&gt;&gt; B;</div>
<div class="line">    B --&gt;&gt; A[Returns Populated Asset Models];</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md896"></a>
Sequence of Operations</h3>
<p>The sequence diagram below shows how the FastAPI backend interacts with the data fetching module to retrieve asset information.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Next_js as &quot;Next.js Frontend&quot;</div>
<div class="line">    participant FastAPI as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Fetcher as &quot;real_data_fetcher.py&quot;</div>
<div class="line">    participant YFinance as &quot;yfinance Library&quot;</div>
<div class="line">    participant YahooAPI as &quot;Yahoo Finance API&quot;</div>
<div class="line"> </div>
<div class="line">    Next_js-&gt;&gt;FastAPI: GET /api/assets</div>
<div class="line">    activate FastAPI</div>
<div class="line">    Note over FastAPI: Uses real data from real_data_fetcher.py</div>
<div class="line">    FastAPI-&gt;&gt;Fetcher: fetch_data()</div>
<div class="line">    activate Fetcher</div>
<div class="line">    Fetcher-&gt;&gt;YFinance: Ticker(symbol).info</div>
<div class="line">    activate YFinance</div>
<div class="line">    YFinance-&gt;&gt;YahooAPI: HTTP GET Request</div>
<div class="line">    YahooAPI--&gt;&gt;YFinance: JSON Response</div>
<div class="line">    YFinance--&gt;&gt;Fetcher: Data Dictionary</div>
<div class="line">    deactivate YFinance</div>
<div class="line">    Fetcher--&gt;&gt;FastAPI: Populated Asset Objects</div>
<div class="line">    deactivate Fetcher</div>
<div class="line">    FastAPI--&gt;&gt;Next_js: JSON Response with Asset Data</div>
<div class="line">    deactivate FastAPI</div>
</div><!-- fragment --><p>This flow demonstrates the clear separation of concerns, where the API layer delegates data acquisition to the specialized fetcher module.</p>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md897"></a>
System Integration</h2>
<p>The real data fetching capability is integrated into multiple parts of the application.</p>
<h3><a class="anchor" id="autotoc_md898"></a>
FastAPI Backend</h3>
<p>The FastAPI backend, located in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>, utilizes <code><a class="el" href="real__data__fetcher_8py.html">src/data/real_data_fetcher.py</a></code> to serve real-time data to the Next.js frontend. This is a key part of the modern web interface, allowing it to display up-to-date financial information in the asset explorer and visualizations.</p>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md899"></a>
Gradio Application</h3>
<p>The initial version of the application, built with Gradio, also relies on <code>yfinance</code> for real-time data fetching to power its interactive visualizations and analytics dashboard. This was a feature from the first major release.</p>
<p>Sources: [<a class="el" href="CHANGELOG_8md.html">CHANGELOG.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md900"></a>
Error Handling and Improvements</h2>
<p>The <code><a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a></code> document highlights an area for enhancement within the <code><a class="el" href="real__data__fetcher_8py.html">real_data_fetcher.py</a></code> module concerning its error handling strategy.</p>
<h3><a class="anchor" id="autotoc_md901"></a>
Broad Exception Handling</h3>
<p>The current implementation in <code><a class="el" href="real__data__fetcher_8py.html">real_data_fetcher.py</a></code> uses broad <code>except Exception</code> clauses. This pattern is discouraged because it can catch unexpected exceptions, making debugging more difficult.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Current (Discouraged)   </th><th class="markdownTableHeadLeft">Recommended    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Catches all exceptions, including system-level ones.   </td><td class="markdownTableBodyLeft">Catches specific, expected exceptions like <code>ValueError</code> or <code>ConnectionError</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">Can hide bugs by catching errors that should have been propagated.   </td><td class="markdownTableBodyLeft">Allows unexpected errors to propagate for easier debugging.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">Makes it hard to distinguish between different error types (e.g., data vs. network).   </td><td class="markdownTableBodyLeft">Provides distinct handling for different error scenarios.   </td></tr>
</table>
<p><b>Recommendation:</b> Refactor the <code>try...except</code> blocks to catch more specific exceptions first, with a final <code>except Exception</code> to log and re-raise any truly unexpected errors.</p>
<div class="fragment"><div class="line"><span class="comment"># Instead of:</span></div>
<div class="line"><span class="keywordflow">try</span>:</div>
<div class="line">    data = fetch_data()</div>
<div class="line"><span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">    logger.error(f<span class="stringliteral">&quot;Error: {e}&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Use specific exceptions:</span></div>
<div class="line"><span class="keywordflow">try</span>:</div>
<div class="line">    data = fetch_data()</div>
<div class="line"><span class="keywordflow">except</span> (ValueError, KeyError, TypeError) <span class="keyword">as</span> e:</div>
<div class="line">    logger.error(f<span class="stringliteral">&quot;Data error: {e}&quot;</span>)</div>
<div class="line"><span class="keywordflow">except</span> ConnectionError <span class="keyword">as</span> e:</div>
<div class="line">    logger.error(f<span class="stringliteral">&quot;Network error: {e}&quot;</span>)</div>
<div class="line"><span class="keywordflow">except</span> Exception <span class="keyword">as</span> e:</div>
<div class="line">    logger.exception(f<span class="stringliteral">&quot;Unexpected error: {e}&quot;</span>)</div>
<div class="line">    <span class="keywordflow">raise</span>  <span class="comment"># Re-raise unexpected errors</span></div>
</div><!-- fragment --><p>Sources: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md902"></a>
Conclusion</h2>
<p>The Real Data Fetching module is a critical, standardized component for sourcing live financial data using the <code>yfinance</code> library. It serves as the data backbone for both the original Gradio application and the newer FastAPI/Next.js stack. While functionally complete, its robustness can be improved by refining its error-handling logic to be more specific, as outlined in the project's improvement recommendations.</p>
<h3><a class="anchor" id="autotoc_md903"></a>
Sample Data Generation</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/data/sample_data.py">src/data/sample_data.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md904"></a>
Sample Data Generation</h1>
<p>The sample data generation module is a core component responsible for creating a static, in-memory dataset of financial assets and regulatory events. Its primary purpose is to allow the application to run and demonstrate its visualization capabilities without requiring live data fetching, making it essential for development, testing, and quick demonstrations.</p>
<p>This module, primarily located in <code><a class="el" href="sample__data_8py.html">src/data/sample_data.py</a></code>, populates the system with a variety of asset classes, including equities, bonds, commodities, and currencies. This pre-defined dataset ensures a consistent and reproducible state for the application's 3D network graph, as the visualization's layout is deterministic.</p>
<p>Sources: [README.md](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md905"></a>
Architecture and Generation Flow</h2>
<p>The sample data generation process is straightforward. A central function orchestrates the creation of various asset objects and collects them into a list. This process is deterministic, partly due to the use of a fixed random seed for any operations involving randomness, ensuring the 3D graph layout remains consistent across application runs.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md906"></a>
Core Function</h3>
<p>The main entry point for data generation is the <code>create_sample_assets()</code> function (inferred name). This function instantiates hardcoded <code>dataclasses</code> for each asset and returns them as a list to be consumed by other parts of the application, such as the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>.</p>
<p>Sources: [README.md](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md907"></a>
Generation Process Flow</h3>
<p>The following diagram illustrates the logical flow of creating the sample dataset.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start: create_sample_assets()] --&gt; B{Initialize empty asset list};</div>
<div class="line">    B --&gt; C[Create Equity objects];</div>
<div class="line">    C --&gt; D[Create Bond objects];</div>
<div class="line">    D --&gt; E[Create Commodity objects];</div>
<div class="line">    E --&gt; F[Create Currency objects];</div>
<div class="line">    F --&gt; G[Create Regulatory Event objects];</div>
<div class="line">    subgraph Asset Creation</div>
<div class="line">        C</div>
<div class="line">        D</div>
<div class="line">        E</div>
<div class="line">        F</div>
<div class="line">        G</div>
<div class="line">    end</div>
<div class="line">    G --&gt; H{Append all objects to list};</div>
<div class="line">    H --&gt; I[Return list of Assets];</div>
<div class="line">    I --&gt; J[End];</div>
</div><!-- fragment --><p>This diagram shows the sequential creation of different asset types, which are then aggregated and returned.</p>
<p>Sources: [README.md](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md908"></a>
Data Models</h2>
<p>The sample data generation relies on a set of well-defined data models defined in <code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code>. These models are implemented using Python's <code>dataclasses</code> and <code>enum</code> modules to ensure type safety, clarity, and maintainability. The core model is a base <code>Asset</code> class from which specific asset types inherit.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md909"></a>
Asset Class Hierarchy</h3>
<p>The system uses a clear inheritance hierarchy for its financial models. This structure allows for both shared attributes and specialized fields for each asset class.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">        +asset_class: AssetClass</div>
<div class="line">        +price: float</div>
<div class="line">        +currency: str</div>
<div class="line">        +sector: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Equity {</div>
<div class="line">        +pe_ratio: float</div>
<div class="line">        +dividend_yield: float</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Bond {</div>
<div class="line">        +yield: float</div>
<div class="line">        +duration: float</div>
<div class="line">        +credit_rating: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Commodity {</div>
<div class="line">        +contract_size: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Currency {</div>
<div class="line">        +country: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class RegulatoryEvent {</div>
<div class="line">        +event_type: RegulatoryActivity</div>
<div class="line">        +impact_score: float</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
<div class="line">    Asset &lt;|-- RegulatoryEvent</div>
</div><!-- fragment --><p>This diagram shows the base <code>Asset</code> class and the specialized classes for <code>Equity</code>, <code>Bond</code>, <code>Commodity</code>, <code>Currency</code>, and <code>RegulatoryEvent</code>.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [README.md]()</p>
<h3><a class="anchor" id="autotoc_md910"></a>
Enumerations</h3>
<p>To enforce a fixed set of choices for categories, the system uses <code>enum</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="classEnum.html">Enum</a> Name   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>AssetClass</code>   </td><td class="markdownTableBodyNone">Defines the major types of assets (e.g., EQUITY, BOND).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>RegulatoryActivity</code>   </td><td class="markdownTableBodyNone">Defines the types of regulatory events (e.g., EARNINGS, SEC_FILING).   </td></tr>
</table>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md911"></a>
Generated Asset Types</h2>
<p>The <code><a class="el" href="sample__data_8py.html">sample_data.py</a></code> module creates instances for all supported asset classes. The hardcoded values provide a rich and interconnected dataset for visualization.</p>
<p>Sources: [README.md](), [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md912"></a>
Equities</h3>
<p>Sample stocks are created with financial metrics like P/E ratio and dividend yield.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Symbol   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Sector    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AAPL   </td><td class="markdownTableBodyNone">Apple Inc.   </td><td class="markdownTableBodyNone">Technology    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MSFT   </td><td class="markdownTableBodyNone">Microsoft Corp.   </td><td class="markdownTableBodyNone">Technology    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JPM   </td><td class="markdownTableBodyNone">JPMorgan Chase &amp; Co.   </td><td class="markdownTableBodyNone">Financials    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">XOM   </td><td class="markdownTableBodyNone">Exxon Mobil Corp.   </td><td class="markdownTableBodyNone">Energy   </td></tr>
</table>
<p>Sources: [README.md](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md913"></a>
Bonds</h3>
<p>Corporate bonds are included, often linked to the equities of the issuing company.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Symbol   </th><th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Issuer    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AAPL25   </td><td class="markdownTableBodyNone">Apple 2.4% 2025   </td><td class="markdownTableBodyNone">Apple Inc.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">MSFT30   </td><td class="markdownTableBodyNone">Microsoft 3.1% 2030   </td><td class="markdownTableBodyNone">Microsoft Corp.   </td></tr>
</table>
<p>Sources: [README.md](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md914"></a>
Other Asset Classes</h3>
<p>The sample dataset also includes:</p>
<ul>
<li><b>Commodities</b>: Such as Gold (GC=F) and Crude Oil (CL=F).</li>
<li><b>Currencies</b>: FX pairs like EUR/USD and GBP/USD.</li>
<li><b>Regulatory Events</b>: SEC filings or earnings reports linked to specific assets.</li>
</ul>
<p>Sources: [README.md](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md915"></a>
Usage in the Application</h2>
<p>The data generated by this module is fundamental to the application's ability to display a graph upon startup. The main application file (<code><a class="el" href="app_8py.html">app.py</a></code> or <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>) fetches this data and uses it to initialize the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>.</p>
<p>Sources: [README.md](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md916"></a>
Data Flow on Application Start</h3>
<p>This sequence diagram shows how the sample data is loaded and processed when the application starts.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User</div>
<div class="line">    participant App as &quot;Application (app.py/api.main.py)&quot;</div>
<div class="line">    participant SampleData as &quot;sample_data.py&quot;</div>
<div class="line">    participant AssetGraph as &quot;AssetRelationshipGraph&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;App: Starts Application</div>
<div class="line">    activate App</div>
<div class="line">    App-&gt;&gt;SampleData: create_sample_assets()</div>
<div class="line">    activate SampleData</div>
<div class="line">    SampleData--&gt;&gt;App: Returns list of Asset objects</div>
<div class="line">    deactivate SampleData</div>
<div class="line">    App-&gt;&gt;AssetGraph: new AssetRelationshipGraph()</div>
<div class="line">    activate AssetGraph</div>
<div class="line">    deactivate AssetGraph</div>
<div class="line">    App-&gt;&gt;AssetGraph: add_asset() for each asset</div>
<div class="line">    App-&gt;&gt;AssetGraph: build_relationships()</div>
<div class="line">    App-&gt;&gt;AssetGraph: get_3d_visualization_data()</div>
<div class="line">    activate AssetGraph</div>
<div class="line">    AssetGraph--&gt;&gt;App: Returns visualization data</div>
<div class="line">    deactivate AssetGraph</div>
<div class="line">    App--&gt;&gt;User: Renders 3D Graph</div>
<div class="line">    deactivate App</div>
</div><!-- fragment --><p>This flow demonstrates the critical role of <code><a class="el" href="sample__data_8py.html">sample_data.py</a></code> in bootstrapping the application's primary feature.</p>
<p>Sources: [README.md](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md917"></a>
Role in Testing</h2>
<p>The sample data provides a reliable and consistent baseline for the project's comprehensive test suite. Test fixtures, defined in <code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code>, are heavily inspired by or are direct subsets of the data generated in <code><a class="el" href="sample__data_8py.html">sample_data.py</a></code>. These fixtures are then used across unit and integration tests to validate the behavior of the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>, API endpoints, and data models.</p>
<p>For example, tests for relationship discovery in <code><a class="el" href="test__asset__graph_8py.html">tests/unit/test_asset_graph.py</a></code> use fixtures representing sample equities and bonds to assert that the correct relationships are created. This ensures that the core logic of the application is sound and behaves as expected with a known dataset.</p>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md918"></a>
Conclusion</h2>
<p>The sample data generation module is a cornerstone of the <code>financial-asset-relationship-db</code> project. It provides a self-contained, deterministic, and representative dataset that enables immediate visualization and robust testing. By decoupling the application's core logic from live data sources, it enhances developer productivity, ensures consistent demonstrations, and provides a stable foundation for the entire test suite.</p>
<h2><a class="anchor" id="autotoc_md919"></a>
Backend Systems</h2>
<h3><a class="anchor" id="autotoc_md920"></a>
FastAPI API Reference</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/unit/test_api_main.py">tests/unit/test_api_main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/DEPLOYMENT.md">DEPLOYMENT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/QUICK_START.md">QUICK_START.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md921"></a>
FastAPI API Reference</h1>
<p>The FastAPI backend serves as the primary data provider for the modern Next.js frontend. Its main purpose is to expose the functionalities of the core <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> logic through a high-performance, RESTful API. The API handles requests for asset data, relationship information, network metrics, and visualization data, returning it in a structured JSON format.</p>
<p>This API is designed to be run as a serverless function on platforms like Vercel, working in tandem with the Next.js application. It includes automatic OpenAPI documentation, which can be accessed at the <code>/docs</code> endpoint during local development.</p>
<p><em>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md922"></a>
Architecture</h2>
<p>The API is built using the FastAPI framework and runs on a Uvicorn ASGI server. It acts as a wrapper around the existing Python business logic, primarily interacting with a singleton instance of the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class. This design separates the web-serving layer from the core data processing engine.</p>
<p><em>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="api_2main_8py.html">api/main.py</a>:18-24]()</em></p>
<p>The following diagram illustrates the high-level architecture and data flow from the user to the core logic via the FastAPI layer.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User_Interface</div>
<div class="line">        A[Next.js Frontend]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph API_Layer</div>
<div class="line">        B[FastAPI Backend]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Core_Logic</div>
<div class="line">        C[AssetRelationshipGraph]</div>
<div class="line">        D[Data Sources e.g., yfinance]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A -- &quot;REST API Calls&quot; --&gt; B</div>
<div class="line">    B -- &quot;Function Calls&quot; --&gt; C</div>
<div class="line">    C -- &quot;Fetches Data&quot; --&gt; D</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</em></p>
<h3><a class="anchor" id="autotoc_md923"></a>
Core Logic Integration</h3>
<p>To ensure efficiency and maintain state, the API uses a thread-safe singleton pattern to manage the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> instance. The graph is initialized only once on the first request and is then reused for all subsequent calls. This avoids the costly process of re-fetching and rebuilding the graph for every API hit.</p>
<p>A <code>threading.Lock</code> is used to prevent race conditions during the initial creation of the graph, making it safe for concurrent requests.</p>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:31-48](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:70-93]()</em></p>
<p>This diagram shows the logic for initializing the singleton graph instance.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Request Received] --&gt; B{graph is None?};</div>
<div class="line">    B -- Yes --&gt; C{Acquire Lock};</div>
<div class="line">    C --&gt; D{graph is None?};</div>
<div class="line">    D -- Yes --&gt; E[Initialize AssetRelationshipGraph];</div>
<div class="line">    E --&gt; F[Set global graph instance];</div>
<div class="line">    F --&gt; G[Release Lock];</div>
<div class="line">    D -- No --&gt; G;</div>
<div class="line">    B -- No --&gt; H[Return Existing Graph];</div>
<div class="line">    G --&gt; H;</div>
<div class="line">    H --&gt; I[Process Request];</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:31-48]()</em></p>
<h3><a class="anchor" id="autotoc_md924"></a>
CORS Configuration</h3>
<p>The API is configured with CORS (Cross-Origin Resource Sharing) middleware to allow requests from the Next.js frontend, which runs on a different port during local development (<code><a href="http://localhost:3000">http://localhost:3000</a></code>) and on Vercel deployment domains (<code><a href="https://">https://</a>*.vercel.app</code>).</p>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:220-229](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md925"></a>
API Endpoints</h2>
<p>The API is available under the <code>/api/</code> prefix.</p>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</em></p>
<h3><a class="anchor" id="autotoc_md926"></a>
Health &amp; Metadata</h3>
<h4><a class="anchor" id="autotoc_md927"></a>
<code>GET /api/health</code></h4>
<p>Returns the operational status of the API.</p>
<ul>
<li><b>Response:</b> <div class="fragment"><div class="line">{</div>
<div class="line">  &quot;status&quot;: &quot;healthy&quot;,</div>
<div class="line">  &quot;graph_initialized&quot;: true</div>
<div class="line">}</div>
</div><!-- fragment --> <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:100-106](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:130-135]()</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md928"></a>
<code>GET /api/asset-classes</code></h4>
<p>Returns a list of all available asset classes.</p>
<ul>
<li><b>Response:</b> <div class="fragment"><div class="line">[&quot;EQUITY&quot;, &quot;BOND&quot;, &quot;COMMODITY&quot;, &quot;CURRENCY&quot;]</div>
</div><!-- fragment --> <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:189-194](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:302-307]()</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md929"></a>
<code>GET /api/sectors</code></h4>
<p>Returns a list of all unique sectors available in the asset graph.</p>
<ul>
<li><b>Response:</b> <div class="fragment"><div class="line">[&quot;Technology&quot;, &quot;Financial Services&quot;, &quot;Consumer Cyclical&quot;]</div>
</div><!-- fragment --> <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:197-202](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:309-314]()</em></li>
</ul>
<h3><a class="anchor" id="autotoc_md930"></a>
Assets</h3>
<h4><a class="anchor" id="autotoc_md931"></a>
<code>GET /api/assets</code></h4>
<p>Retrieves a list of all assets, with optional filtering.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>asset_class</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">(Optional) Filter assets by a specific asset class (e.g., <code>EQUITY</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>sector</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">(Optional) Filter assets by a specific sector (e.g., <code>Technology</code>).   </td></tr>
</table>
<ul>
<li><b>Response:</b> An array of <code>AssetResponse</code> objects. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:110-129](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:151-189]()</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md932"></a>
<code>GET /api/assets/{asset_id}</code></h4>
<p>Retrieves detailed information for a single asset by its ID.</p>
<ul>
<li><b>Response:</b> A single <code>AssetResponse</code> object or a 404 error if not found. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:132-143](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:191-203]()</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md933"></a>
<code>GET /api/assets/{asset_id}/relationships</code></h4>
<p>Retrieves all relationships for a specific asset.</p>
<ul>
<li><b>Response:</b> An array of <code>RelationshipResponse</code> objects. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:146-157](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:221-233]()</em></li>
</ul>
<h3><a class="anchor" id="autotoc_md934"></a>
Relationships</h3>
<h4><a class="anchor" id="autotoc_md935"></a>
<code>GET /api/relationships</code></h4>
<p>Retrieves all relationships in the graph.</p>
<ul>
<li><b>Response:</b> An array of <code>RelationshipResponse</code> objects. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:160-166](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:235-241]()</em></li>
</ul>
<h3><a class="anchor" id="autotoc_md936"></a>
Metrics &amp; Visualization</h3>
<h4><a class="anchor" id="autotoc_md937"></a>
<code>GET /api/metrics</code></h4>
<p>Calculates and returns key metrics about the network graph.</p>
<ul>
<li><b>Response:</b> A <code>MetricsResponse</code> object. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:169-175](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:243-256]()</em></li>
</ul>
<h4><a class="anchor" id="autotoc_md938"></a>
<code>GET /api/visualization</code></h4>
<p>Returns the data required for the frontend to render the 3D network graph.</p>
<ul>
<li><b>Response:</b> A <code>VisualizationDataResponse</code> object containing nodes and edges. <em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:178-186](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:258-279]()</em></li>
</ul>
<p>The following sequence diagram shows a typical request to the visualization endpoint.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Client as &quot;Next.js Frontend&quot;</div>
<div class="line">    participant API as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Graph as &quot;AssetRelationshipGraph&quot;</div>
<div class="line"> </div>
<div class="line">    Client-&gt;&gt;API: GET /api/visualization</div>
<div class="line">    API-&gt;&gt;Graph: get_graph()</div>
<div class="line">    Note right of API: Get singleton instance</div>
<div class="line">    Graph--&gt;&gt;API: graph_instance</div>
<div class="line">    API-&gt;&gt;Graph: get_3d_visualization_data()</div>
<div class="line">    Graph--&gt;&gt;API: {nodes: [...], links: [...]}</div>
<div class="line">    API--&gt;&gt;Client: 200 OK with JSON payload</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:178-186](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md939"></a>
Data Models</h2>
<p>The API uses Pydantic models to define and validate the structure of JSON responses.</p>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:51-97](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:95-128]()</em></p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class AssetResponse {</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +str asset_class</div>
<div class="line">        +str sector</div>
<div class="line">        +str currency</div>
<div class="line">        +float price</div>
<div class="line">        +float market_cap</div>
<div class="line">        +dict additional_fields</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class RelationshipResponse {</div>
<div class="line">        +str source</div>
<div class="line">        +str target</div>
<div class="line">        +str relationship_type</div>
<div class="line">        +float strength</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class MetricsResponse {</div>
<div class="line">        +int total_assets</div>
<div class="line">        +int total_relationships</div>
<div class="line">        +float network_density</div>
<div class="line">        +float average_degree</div>
<div class="line">        +int max_degree</div>
<div class="line">        +dict asset_class_distribution</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class VisualizationNode {</div>
<div class="line">        +str id</div>
<div class="line">        +str name</div>
<div class="line">        +str asset_class</div>
<div class="line">        +str sector</div>
<div class="line">        +float val</div>
<div class="line">        +list~float~ x, y, z</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class VisualizationLink {</div>
<div class="line">        +str source</div>
<div class="line">        +str target</div>
<div class="line">        +str type</div>
<div class="line">        +float strength</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class VisualizationDataResponse {</div>
<div class="line">        +list~VisualizationNode~ nodes</div>
<div class="line">        +list~VisualizationLink~ links</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    AssetResponse &quot;1&quot; -- &quot;0..*&quot; RelationshipResponse : (source/target)</div>
<div class="line">    MetricsResponse ..&gt; AssetResponse : (counts)</div>
<div class="line">    VisualizationDataResponse o-- &quot;many&quot; VisualizationNode</div>
<div class="line">    VisualizationDataResponse o-- &quot;many&quot; VisualizationLink</div>
<div class="line">    VisualizationNode ..&gt; AssetResponse : (derived from)</div>
<div class="line">    VisualizationLink ..&gt; RelationshipResponse : (derived from)</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:51-97]()</em></p>
<h3><a class="anchor" id="autotoc_md940"></a>
AssetResponse</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>id</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Unique identifier for the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>symbol</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Ticker symbol or identifier.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>name</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">Full name of the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_class</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The class of the asset (e.g., <code>EQUITY</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sector</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The industry sector.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>currency</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">The currency of the asset price.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>price</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The current price.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>market_cap</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The market capitalization.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>additional_fields</code>   </td><td class="markdownTableBodyNone"><code>dict</code>   </td><td class="markdownTableBodyNone">A dictionary of asset-specific fields.   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:52-63]()</em></p>
<h3><a class="anchor" id="autotoc_md941"></a>
MetricsResponse</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>total_assets</code>   </td><td class="markdownTableBodyNone"><code>int</code>   </td><td class="markdownTableBodyNone">Total number of assets in the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>total_relationships</code>   </td><td class="markdownTableBodyNone"><code>int</code>   </td><td class="markdownTableBodyNone">Total number of relationships.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>network_density</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The density of the network graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>average_degree</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">The average number of connections per node.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>max_degree</code>   </td><td class="markdownTableBodyNone"><code>int</code>   </td><td class="markdownTableBodyNone">The highest number of connections for any single node.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>asset_class_distribution</code>   </td><td class="markdownTableBodyNone"><code>dict</code>   </td><td class="markdownTableBodyNone">A count of assets per asset class.   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:72-80]()</em></p>
<h2><a class="anchor" id="autotoc_md942"></a>
Error Handling</h2>
<p>The API includes a generic exception handler that catches any unhandled server-side errors. This prevents internal stack traces from being exposed to the client and returns a standard <code>500 Internal Server Error</code> response. Specific errors, such as a non-existent asset, result in a <code>404 Not Found</code> status code.</p>
<p><em>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:205-217](), [<a class="el" href="test__api__main_8py.html">tests/unit/test_api_main.py</a>:316-332]()</em></p>
<h2><a class="anchor" id="autotoc_md943"></a>
Summary</h2>
<p>The FastAPI application provides a robust and modern API layer that decouples the frontend from the core Python logic. It leverages a thread-safe singleton pattern for efficient data management and uses Pydantic for reliable data validation. The well-defined endpoints supply all necessary data for the Next.js frontend to deliver a rich, interactive user experience for exploring financial asset relationships.</p>
<h3><a class="anchor" id="autotoc_md944"></a>
API Authentication</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/auth.py">api/auth.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/integration/test_api_integration.py">tests/integration/test_api_integration.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SECURITY.md">SECURITY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md945"></a>
API Authentication</h1>
<p>The Financial Asset Relationship Database API employs an OAuth2 Password Flow with JSON Web Tokens (JWT) to secure its endpoints. This system ensures that only authenticated users can access protected resources. The implementation is built using FastAPI's security utilities, providing a standardized and robust authentication mechanism.</p>
<p>The core logic is encapsulated within <code><a class="el" href="auth_8py.html">api/auth.py</a></code>, which handles user verification, token creation, and decoding. The main API application, defined in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>, integrates this authentication module to expose a token issuance endpoint and protect specific routes. The entire flow is validated through integration tests found in <code><a class="el" href="test__api__integration_8py.html">tests/integration/test_api_integration.py</a></code>.</p>
<h2><a class="anchor" id="autotoc_md946"></a>
Architecture and Core Components</h2>
<p>The authentication system is composed of several key parts: data models for users and tokens, functions for handling the authentication logic, and API endpoints for user interaction.</p>
<p>Sources: [<a class="el" href="auth_8py.html">api/auth.py</a>](), [<a class="el" href="api_2main_8py.html">api/main.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md947"></a>
Data Models</h3>
<p>Pydantic models are used to define the data structures for users and tokens, ensuring type safety and validation.</p>
<p>This diagram illustrates the Pydantic models used for authentication.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class Token {</div>
<div class="line">        +access_token: str</div>
<div class="line">        +token_type: str</div>
<div class="line">    }</div>
<div class="line">    class TokenData {</div>
<div class="line">        +username: str | None</div>
<div class="line">    }</div>
<div class="line">    class User {</div>
<div class="line">        +username: str</div>
<div class="line">        +email: str | None</div>
<div class="line">        +full_name: str | None</div>
<div class="line">        +disabled: bool | None</div>
<div class="line">    }</div>
<div class="line">    class UserInDB {</div>
<div class="line">        +hashed_password: str</div>
<div class="line">    }</div>
<div class="line">    User &lt;|-- UserInDB</div>
<div class="line"> </div>
<div class="line">    Token --|&gt; TokenData : &quot;Decodes to&quot;</div>
<div class="line">    UserInDB --|&gt; User : &quot;Extends&quot;</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="auth_8py.html">api/auth.py</a>:28-51]()</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Model   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Fields   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>User</code>   </td><td class="markdownTableBodyNone">Basic user model.   </td><td class="markdownTableBodyNone"><code>username</code>, <code>email</code>, <code>full_name</code>, <code>disabled</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:43-47</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>UserInDB</code>   </td><td class="markdownTableBodyNone">Extends <code>User</code> to include the hashed password for storage.   </td><td class="markdownTableBodyNone">Inherits from <code>User</code>, adds <code>hashed_password</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:50-51</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Token</code>   </td><td class="markdownTableBodyNone">Represents the access token returned to the client.   </td><td class="markdownTableBodyNone"><code>access_token</code>, <code>token_type</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:28-30</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>TokenData</code>   </td><td class="markdownTableBodyNone">Represents the data encoded within the JWT.   </td><td class="markdownTableBodyNone"><code>username</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:33-34</code>   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md948"></a>
Configuration</h3>
<p>Authentication behavior is configured through environment variables. A hardcoded user database is present for simplicity, with credentials also loaded from the environment.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default Value   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SECRET_KEY</code>   </td><td class="markdownTableBodyNone">A secret string for encoding and decoding JWTs.   </td><td class="markdownTableBodyNone">"a_very_secret_key"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:18</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ALGORITHM</code>   </td><td class="markdownTableBodyNone">The algorithm used for JWT signing.   </td><td class="markdownTableBodyNone">"HS256"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:19</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ACCESS_TOKEN_EXPIRE_MINUTES</code>   </td><td class="markdownTableBodyNone">The token's validity period in minutes.   </td><td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:20</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ADMIN_USERNAME</code>   </td><td class="markdownTableBodyNone">Username for the default admin user.   </td><td class="markdownTableBodyNone">"admin"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:57</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ADMIN_PASSWORD</code>   </td><td class="markdownTableBodyNone">Password for the default admin user.   </td><td class="markdownTableBodyNone">"admin"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:58</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>ADMIN_EMAIL</code>   </td><td class="markdownTableBodyNone">Email for the default admin user.   </td><td class="markdownTableBodyNone">"admin@example.com"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:59</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ADMIN_FULL_NAME</code>   </td><td class="markdownTableBodyNone">Full name for the default admin user.   </td><td class="markdownTableBodyNone">"Admin User"   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:60</code>   </td></tr>
</table>
<p>The use of these environment variables is confirmed in the integration tests. Sources: [<a class="el" href="auth_8py.html">api/auth.py</a>:17-21, 56-61](), [<a class="el" href="test__api__integration_8py.html">tests/integration/test_api_integration.py</a>:139-142]()</p>
<h3><a class="anchor" id="autotoc_md949"></a>
Key Functions</h3>
<p>The authentication logic is handled by a set of functions in <code><a class="el" href="auth_8py.html">api/auth.py</a></code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>authenticate_user()</code>   </td><td class="markdownTableBodyNone">Verifies a user's credentials (username and password) against the user database.   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:70-79</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>create_access_token()</code>   </td><td class="markdownTableBodyNone">Generates a new JWT for a given username and expiration time.   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:82-90</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>get_current_active_user()</code>   </td><td class="markdownTableBodyNone">A FastAPI dependency that decodes the JWT from the request header and retrieves the corresponding active user.   </td><td class="markdownTableBodyNone"><code><a class="el" href="auth_8py.html">api/auth.py</a>:93-111</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md950"></a>
Authentication Flow</h2>
<p>The process of obtaining and using an access token follows the standard OAuth2 Password Flow.</p>
<h3><a class="anchor" id="autotoc_md951"></a>
1. Token Issuance</h3>
<p>A client requests an access token by sending its credentials to the <code>/token</code> endpoint.</p>
<p>The following sequence diagram shows the token issuance process.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Client</div>
<div class="line">    participant API as &quot;FastAPI App&quot;</div>
<div class="line">    participant Auth as &quot;Auth Module&quot;</div>
<div class="line"> </div>
<div class="line">    Client-&gt;&gt;API: POST /token (username, password)</div>
<div class="line">    activate API</div>
<div class="line">    API-&gt;&gt;Auth: authenticate_user(username, password)</div>
<div class="line">    activate Auth</div>
<div class="line">    Note right of Auth: Verifies password hash</div>
<div class="line">    Auth--&gt;&gt;API: UserInDB object or False</div>
<div class="line">    deactivate Auth</div>
<div class="line">    alt Credentials are valid</div>
<div class="line">        API-&gt;&gt;Auth: create_access_token(data={&quot;sub&quot;: username})</div>
<div class="line">        activate Auth</div>
<div class="line">        Note right of Auth: Encodes JWT with SECRET_KEY</div>
<div class="line">        Auth--&gt;&gt;API: access_token</div>
<div class="line">        deactivate Auth</div>
<div class="line">        API--&gt;&gt;Client: 200 OK { &quot;access_token&quot;: &quot;...&quot;, &quot;token_type&quot;: &quot;bearer&quot; }</div>
<div class="line">    else Credentials are invalid</div>
<div class="line">        API--xClient: 401 Unauthorized</div>
<div class="line">    end</div>
<div class="line">    deactivate API</div>
</div><!-- fragment --><p>This flow is initiated by the <code>login_for_access_token</code> function in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>, which handles the <code>/token</code> endpoint. Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:129-142](), [<a class="el" href="auth_8py.html">api/auth.py</a>:70-90](), [<a class="el" href="test__api__integration_8py.html">tests/integration/test_api_integration.py</a>:137-150]()</p>
<h3><a class="anchor" id="autotoc_md952"></a>
2. Accessing Protected Endpoints</h3>
<p>Once the client has an access token, it can access protected endpoints by including the token in the <code>Authorization</code> header.</p>
<p>This flowchart shows how a request to a protected endpoint is validated.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Client sends request with &#39;Authorization: Bearer TOKEN&#39;] --&gt; B{Protected Endpoint};</div>
<div class="line">    B --&gt; C{Depends(get_current_active_user)};</div>
<div class="line">    C --&gt; D[Decode JWT from header];</div>
<div class="line">    D --&gt; E{Token valid and not expired?};</div>
<div class="line">    E -- Yes --&gt; F[Retrieve username from token payload];</div>
<div class="line">    F --&gt; G[Fetch user from DB];</div>
<div class="line">    G --&gt; H{User exists and is active?};</div>
<div class="line">    H -- Yes --&gt; I[Execute endpoint logic];</div>
<div class="line">    I --&gt; J[Return response];</div>
<div class="line">    E -- No --&gt; K[HTTPException 401 Unauthorized];</div>
<div class="line">    H -- No --&gt; K;</div>
</div><!-- fragment --><p>The <code>get_current_active_user</code> function serves as the FastAPI dependency that enforces this validation. Any endpoint that includes <code>Depends(get_current_active_user)</code> in its signature is automatically protected. Sources: [<a class="el" href="auth_8py.html">api/auth.py</a>:93-111](), [<a class="el" href="api_2main_8py.html">api/main.py</a>:145-149]()</p>
<h2><a class="anchor" id="autotoc_md953"></a>
API Endpoints</h2>
<h3><a class="anchor" id="autotoc_md954"></a>
Authentication Endpoints</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Endpoint   </th><th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Parameters (form-data)   </th><th class="markdownTableHeadNone">Response   </th><th class="markdownTableHeadNone">Source File    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>/token</code>   </td><td class="markdownTableBodyNone"><code>POST</code>   </td><td class="markdownTableBodyNone">Issues a JWT access token upon successful authentication.   </td><td class="markdownTableBodyNone"><code>username: str</code>, <code>password: str</code>   </td><td class="markdownTableBodyNone"><code>Token</code> model   </td><td class="markdownTableBodyNone"><code><a class="el" href="api_2main_8py.html">api/main.py</a>:129-142</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>/api/users/me</code>   </td><td class="markdownTableBodyNone"><code>GET</code>   </td><td class="markdownTableBodyNone">Returns the details of the currently authenticated user. Protected endpoint.   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone"><code>User</code> model   </td><td class="markdownTableBodyNone"><code><a class="el" href="api_2main_8py.html">api/main.py</a>:145-149</code>   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md955"></a>
Example Usage</h3>
<p>To obtain a token, a client sends a POST request with form data.</p>
<div class="fragment"><div class="line">curl -X POST &quot;http://localhost:8000/token&quot; \</div>
<div class="line">-H &quot;Content-Type: application/x-www-form-urlencoded&quot; \</div>
<div class="line">-d &quot;username=admin&amp;password=admin&quot;</div>
</div><!-- fragment --><p>The response will be a JSON object containing the access token.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;,</div>
<div class="line">  &quot;token_type&quot;: &quot;bearer&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This token is then used to access protected endpoints.</p>
<div class="fragment"><div class="line">curl -X GET &quot;http://localhost:8000/api/users/me&quot; \</div>
<div class="line">-H &quot;Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...&quot;</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="test__api__integration_8py.html">tests/integration/test_api_integration.py</a>:137-165]()</p>
<h2><a class="anchor" id="autotoc_md956"></a>
Security Considerations</h2>
<p>The current implementation uses a simple, in-memory user database defined in <code><a class="el" href="auth_8py.html">api/auth.py</a></code>. This is suitable for development and demonstration but is not secure for a production environment. The <code><a class="el" href="SECURITY_8md.html">SECURITY.md</a></code> document recommends implementing JWT authentication, which has been done, but a production system should replace the hardcoded user store with a proper database.</p>
<ul>
<li><b>User Storage</b>: The user database is hardcoded. For production, this should be migrated to a secure database system.</li>
<li><b>Secret Management</b>: The <code>SECRET_KEY</code> should be managed securely via environment variables or a secrets management service, not hardcoded or left as the default.</li>
<li><b>HTTPS</b>: In production, the API should be served over HTTPS to protect credentials and tokens in transit.</li>
</ul>
<p>Sources: [<a class="el" href="auth_8py.html">api/auth.py</a>:54-68](), [<a class="el" href="SECURITY_8md.html">SECURITY.md</a>:53-70]()</p>
<h2><a class="anchor" id="autotoc_md957"></a>
Summary</h2>
<p>The API authentication system provides a secure and standard way to protect endpoints using OAuth2 and JWT. It is configured via environment variables and relies on a core <code>auth</code> module for its logic. While the current user management is basic, the overall structure is robust and follows modern security practices recommended for web APIs. The integration tests confirm that the token issuance and validation flow works as expected.</p>
<h3><a class="anchor" id="autotoc_md958"></a>
Gradio Application (Legacy)</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/app.py">app.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/UI_COMPARISON.md">UI_COMPARISON.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/pyproject.toml">pyproject.toml</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md959"></a>
Gradio Application (Legacy)</h1>
<p>The Gradio application, defined in <code><a class="el" href="app_8py.html">app.py</a></code>, serves as the original, Python-native user interface for the Financial Asset Relationship Database. It provides an interactive web-based demo for visualizing the complex network of financial assets, exploring their relationships, and analyzing key metrics. Built using the Gradio library, it allows for rapid prototyping and direct interaction with the backend Python logic.</p>
<p>This application runs as a standalone web server and is launched via the command <code>python <a class="el" href="app_8py.html">app.py</a></code>. While it remains fully functional, it is considered the legacy UI in comparison to the newer "" "Next.js Frontend", which offers a more modern and scalable architecture. The Gradio app is particularly suited for data scientists and Python developers who need a quick way to visualize and interact with the asset graph without requiring a separate frontend development environment.</p>
<p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>](), [<a class="el" href="UI__COMPARISON_8md.html">UI_COMPARISON.md</a>](), [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md960"></a>
Architecture and Core Components</h2>
<p>The application's logic is encapsulated within the <code>FinancialAssetApp</code> class in <code><a class="el" href="app_8py.html">app.py</a></code>. This class manages the application state, handles data initialization, and defines the methods that respond to user interactions in the UI.</p>
<p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:141-144]()</em></p>
<h3><a class="anchor" id="autotoc_md961"></a>
<code>FinancialAssetApp</code> Class</h3>
<p>The <code>FinancialAssetApp</code> class is the central controller for the Gradio interface. It initializes the core <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> and connects UI components to backend data processing and visualization functions.</p>
<p>The diagram below shows the key methods within the <code>FinancialAssetApp</code> class.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class FinancialAssetApp {</div>
<div class="line">        +graph: AssetRelationshipGraph</div>
<div class="line">        +__init__()</div>
<div class="line">        -_initialize_graph()</div>
<div class="line">        +ensure_graph() AssetRelationshipGraph</div>
<div class="line">        +create_interface() Blocks</div>
<div class="line">        +refresh_all_outputs() Tuple</div>
<div class="line">        +refresh_visualization(...) Tuple</div>
<div class="line">        +update_asset_info(asset_id) Tuple</div>
<div class="line">        +generate_formulaic_analysis() Tuple</div>
<div class="line">        +show_formula_details(formula_name) Tuple</div>
<div class="line">        -_update_metrics_text() str</div>
<div class="line">        -_format_formula_summary() str</div>
<div class="line">    }</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:141-419]()</em></p>
<h3><a class="anchor" id="autotoc_md962"></a>
Key Methods</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Method   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>_initialize_graph()</code>   </td><td class="markdownTableBodyNone">Initializes the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> by calling <code>create_real_database()</code> to fetch data from Yahoo Finance.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:146-156</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>create_interface()</code>   </td><td class="markdownTableBodyNone">Constructs the entire Gradio UI, defining all tabs, components, and their layouts.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:421-638</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>refresh_all_outputs()</code>   </td><td class="markdownTableBodyNone">A master function that refreshes all visualizations and reports across all tabs simultaneously.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:206-236</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>refresh_visualization()</code>   </td><td class="markdownTableBodyNone">Updates the 2D/3D network graph based on user-selected filters (e.g., view mode, relationship types).   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:238-280</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>update_asset_info()</code>   </td><td class="markdownTableBodyNone">Fetches and displays detailed JSON data for a selected asset in the "Asset Explorer" tab.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:189-204</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>generate_formulaic_analysis()</code>   </td><td class="markdownTableBodyNone">Runs the <code>FormulaicdAnalyzer</code> and uses <code>FormulaicVisualizer</code> to create and display plots in the "Formulaic Analysis" tab.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:282-336</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md963"></a>
Application Startup Flow</h2>
<p>When the application is started with <code>python <a class="el" href="app_8py.html">app.py</a></code>, it follows a clear initialization sequence before launching the web interface.</p>
<p>The following flowchart illustrates the startup process.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start `python app.py`] --&gt; B{`if __name__ == &quot;__main__&quot;`};</div>
<div class="line">    B --&gt; C[Instantiate `FinancialAssetApp`];</div>
<div class="line">    C --&gt; D[Call `app._initialize_graph()`];</div>
<div class="line">    D --&gt; E[Call `create_real_database()` from `real_data_fetcher.py`];</div>
<div class="line">    E --&gt; F[Fetch data from yfinance];</div>
<div class="line">    F --&gt; G[Create `AssetRelationshipGraph` instance];</div>
<div class="line">    G --&gt; H[Store graph in `app.graph`];</div>
<div class="line">    H --&gt; I[Call `app.create_interface()`];</div>
<div class="line">    I --&gt; J[Build Gradio UI components];</div>
<div class="line">    J --&gt; K[Call `demo.launch()`];</div>
<div class="line">    K --&gt; L[Gradio UI available at http://localhost:7860];</div>
<div class="line">    E -- On Error --&gt; M{Log Error &amp; Raise};</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:641-648](), [<a class="el" href="app_8py.html">app.py</a>:146-156](), [README.md]()</em></p>
<h2><a class="anchor" id="autotoc_md964"></a>
User Interface Tabs</h2>
<p>The UI is organized into several tabs, each serving a distinct purpose for exploring the financial asset data. The interface is built using Gradio and Plotly for visualizations.</p>
<p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:424-533](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</em></p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Tab Name   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Key Functions    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Network Visualization (2D/3D)</b>   </td><td class="markdownTableBodyNone">The main interactive view of the asset network. Supports 2D and 3D modes with extensive filtering.   </td><td class="markdownTableBodyNone"><code>refresh_visualization</code>, <code>visualize_3d_graph_with_filters</code>, <code>visualize_2d_graph</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Metrics &amp; Analytics</b>   </td><td class="markdownTableBodyNone">Displays quantitative statistics and charts about the network, such as asset distribution and relationship types.   </td><td class="markdownTableBodyNone"><code>update_all_metrics_outputs</code>, <code>visualize_metrics</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Schema &amp; Rules</b>   </td><td class="markdownTableBodyNone">Shows a generated report of the database schema, data models, and business rules for relationships.   </td><td class="markdownTableBodyNone"><code>refresh_all_outputs</code>, <code>generate_schema_report</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Asset Explorer</b>   </td><td class="markdownTableBodyNone">Allows users to select a specific asset from a dropdown and view its detailed attributes and connections in JSON format.   </td><td class="markdownTableBodyNone"><code>update_asset_info</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Formulaic Analysis</b>   </td><td class="markdownTableBodyNone">Provides advanced mathematical analysis, extracting and visualizing formulas and correlations between financial variables.   </td><td class="markdownTableBodyNone"><code>generate_formulaic_analysis</code>, <code>show_formula_details</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Documentation</b>   </td><td class="markdownTableBodyNone">A static tab containing help text and a quick start guide on how to use the application.   </td><td class="markdownTableBodyNone">N/A (Static Markdown)   </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md965"></a>
Network Visualization Tab</h3>
<p>This is the primary tab for visual exploration. It provides numerous controls to filter and customize the graph view.</p>
<h4><a class="anchor" id="autotoc_md966"></a>
Visualization Controls</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Control   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Options   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Visualization Mode   </td><td class="markdownTableBodyNone">Radio   </td><td class="markdownTableBodyNone"><code>3D</code>, <code>2D</code>   </td><td class="markdownTableBodyNone">Toggles between 2D and 3D graph layouts.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:437</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2D Layout Type   </td><td class="markdownTableBodyNone">Radio   </td><td class="markdownTableBodyNone"><code>spring</code>, <code>circular</code>, <code>grid</code>   </td><td class="markdownTableBodyNone">Selects the algorithm for the 2D graph layout. Visible only in 2D mode.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:441</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Relationship Filters   </td><td class="markdownTableBodyNone">Checkbox   </td><td class="markdownTableBodyNone">(Multiple)   </td><td class="markdownTableBodyNone">A series of checkboxes to toggle the visibility of different relationship types (e.g., "Same Sector", "Regulatory Impact").   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:451-465</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Show Direction Arrows   </td><td class="markdownTableBodyNone">Checkbox   </td><td class="markdownTableBodyNone"><code>True</code>, <code>False</code>   </td><td class="markdownTableBodyNone">Toggles the visibility of arrows indicating relationship direction in the 3D view.   </td><td class="markdownTableBodyNone"><code><a class="el" href="app_8py.html">app.py</a>:466</code>   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:432-466]()</em></p>
<h2><a class="anchor" id="autotoc_md967"></a>
Event Handling and Data Flow</h2>
<p>User interactions in the Gradio UI trigger specific Python methods in the <code>FinancialAssetApp</code> class. The <code>gr.State</code> component is used to maintain the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> object between events.</p>
<p>The sequence diagram below shows a typical user interaction: changing a filter and refreshing the 3D visualization.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User</div>
<div class="line">    participant Gradio_UI as &quot;Gradio UI&quot;</div>
<div class="line">    participant FinancialAssetApp as &quot;app.py&quot;</div>
<div class="line">    participant GraphVisuals as &quot;graph_visuals.py&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;Gradio_UI: Clicks &#39;Show Regulatory&#39; checkbox</div>
<div class="line">    Gradio_UI-&gt;&gt;FinancialAssetApp: Calls refresh_visualization()</div>
<div class="line">    Note over FinancialAssetApp: Passes current state of all filter checkboxes</div>
<div class="line"> </div>
<div class="line">    FinancialAssetApp-&gt;&gt;FinancialAssetApp: ensure_graph()</div>
<div class="line">    FinancialAssetApp-&gt;&gt;GraphVisuals: visualize_3d_graph_with_filters(graph, filters)</div>
<div class="line">    GraphVisuals--&gt;&gt;FinancialAssetApp: Returns Plotly Figure object</div>
<div class="line"> </div>
<div class="line">    FinancialAssetApp--&gt;&gt;Gradio_UI: Returns Figure and error state</div>
<div class="line">    Gradio_UI--&gt;&gt;User: Updates 3D Plot component</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>:596-601](), [<a class="el" href="app_8py.html">app.py</a>:238-280]()</em></p>
<h2><a class="anchor" id="autotoc_md968"></a>
Dependencies</h2>
<p>The Gradio application relies on several key Python libraries defined in the project's configuration.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Library   </th><th class="markdownTableHeadNone">Usage   </th><th class="markdownTableHeadNone">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>gradio</code>   </td><td class="markdownTableBodyNone">The core framework for building the web UI.   </td><td class="markdownTableBodyNone"><code>pyproject.toml:16</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>plotly</code>   </td><td class="markdownTableBodyNone">The exclusive library used for all 2D and 3D visualizations.   </td><td class="markdownTableBodyNone"><code>pyproject.toml:17</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pandas</code>   </td><td class="markdownTableBodyNone">Used for data manipulation before visualization.   </td><td class="markdownTableBodyNone"><code>pyproject.toml:22</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>yfinance</code>   </td><td class="markdownTableBodyNone">Fetches real-time financial data to populate the graph.   </td><td class="markdownTableBodyNone"><code>pyproject.toml:20</code>   </td></tr>
</table>
<p><em>Sources: [pyproject.toml:15-23](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md969"></a>
Conclusion</h2>
<p>The <code><a class="el" href="app_8py.html">app.py</a></code> file provides a powerful, self-contained, and interactive tool for financial data analysis. As the original UI, it demonstrates the core value of the project by enabling direct, visual interaction with the asset relationship graph. While the project has evolved to include a more modern Next.js frontend, the Gradio application remains a valuable asset for rapid development, debugging, and Python-centric data exploration.</p>
<p><em>Sources: [<a class="el" href="app_8py.html">app.py</a>](), [<a class="el" href="UI__COMPARISON_8md.html">UI_COMPARISON.md</a>]()</em></p>
<h2><a class="anchor" id="autotoc_md970"></a>
Frontend Components</h2>
<h3><a class="anchor" id="autotoc_md971"></a>
Next.js Frontend Overview</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/package.json">frontend/package.json</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/QUICK_START.md">QUICK_START.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/config/package-validation.test.ts">frontend/**tests**/config/package-validation.test.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/UI_COMPARISON.md">UI_COMPARISON.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md972"></a>
Next.js Frontend Overview</h1>
<p>The Next.js frontend is a modern, responsive, and type-safe web application that serves as the primary user interface for the Financial Asset Relationship Database. It is built with Next.js 14, React 18, and TypeScript, offering a more feature-rich and customizable experience compared to the original Gradio UI. The application communicates with a dedicated FastAPI backend via a REST API to fetch and display complex financial data, including interactive 3D network graphs, analytical metrics, and a filterable asset explorer.</p>
<p>This frontend is designed for scalability and can be deployed on serverless platforms like Vercel. It provides a clear separation between the user interface and the core business logic, which is handled by the Python backend. For more information on the backend, see the Architecture Overview.</p>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="UI__COMPARISON_8md.html">UI_COMPARISON.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md973"></a>
Architecture and Technology Stack</h2>
<p>The frontend application is a client-side Next.js/React application that interacts with a Python-based FastAPI server. This architecture decouples the presentation layer from the data processing and business logic, enabling independent development and scaling.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:4-43](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:65-95]()</p>
<p>This diagram illustrates the high-level system architecture, showing the interaction between the Next.js frontend, the FastAPI backend, and the core Python logic.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User_Browser</div>
<div class="line">        A[Next.js UI on Port 3000]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Vercel_Platform</div>
<div class="line">        B[FastAPI Backend on Port 8000]</div>
<div class="line">        C[Core Business Logic&lt;br&gt;(asset_graph.py)]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A -- &quot;REST API Calls (Axios)&quot; --&gt; B</div>
<div class="line">    B -- &quot;Direct Function Calls&quot; --&gt; C</div>
<div class="line"> </div>
<div class="line">    style A fill:#cde4ff</div>
<div class="line">    style B fill:#d5f0d5</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:120-136](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:65-95]()</p>
<h3><a class="anchor" id="autotoc_md974"></a>
Technology Stack</h3>
<p>The frontend leverages a modern web development stack to deliver a high-quality user experience.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Technology   </th><th class="markdownTableHeadNone">Version   </th><th class="markdownTableHeadNone">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Next.js</b>   </td><td class="markdownTableBodyNone"><code>14.2.35</code>   </td><td class="markdownTableBodyNone">React framework for server-side rendering, routing, and build optimization.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>React</b>   </td><td class="markdownTableBodyNone"><code>^18.2.0</code>   </td><td class="markdownTableBodyNone">UI library for building components.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>TypeScript</b>   </td><td class="markdownTableBodyNone"><code>^5.3.0</code>   </td><td class="markdownTableBodyNone">Provides static typing for code quality and maintainability.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Tailwind CSS</b>   </td><td class="markdownTableBodyNone"><code>^3.3.0</code>   </td><td class="markdownTableBodyNone">A utility-first CSS framework for styling.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Plotly.js</b>   </td><td class="markdownTableBodyNone"><code>^2.27.0</code>   </td><td class="markdownTableBodyNone">Library for creating interactive 2D and 3D visualizations.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Recharts</b>   </td><td class="markdownTableBodyNone"><code>^2.10.0</code>   </td><td class="markdownTableBodyNone">A composable charting library built on React components.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Axios</b>   </td><td class="markdownTableBodyNone"><code>^1.13.2</code>   </td><td class="markdownTableBodyNone">HTTP client for making REST API requests to the backend.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Jest</b>   </td><td class="markdownTableBodyNone"><code>^29.7.0</code>   </td><td class="markdownTableBodyNone">Testing framework for unit and component tests.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>React Testing Library</b>   </td><td class="markdownTableBodyNone"><code>^14.1.2</code>   </td><td class="markdownTableBodyNone">Utilities for testing React components in a user-centric way.   </td></tr>
</table>
<p>Sources: [frontend/package.json:15-39](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:63-69](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:100-107]()</p>
<h2><a class="anchor" id="autotoc_md975"></a>
Project Structure</h2>
<p>The <code>frontend</code> directory is organized to follow Next.js conventions, separating UI components, business logic, type definitions, and static assets.</p>
<p>This diagram shows the layout of the key directories within the <code>frontend</code> folder.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    A(frontend/) --&gt; B(app/)</div>
<div class="line">    A --&gt; C(public/)</div>
<div class="line">    A --&gt; D(package.json)</div>
<div class="line">    A --&gt; E(next.config.js)</div>
<div class="line">    A --&gt; F(tailwind.config.js)</div>
<div class="line">    A --&gt; G(__tests__/)</div>
<div class="line"> </div>
<div class="line">    B --&gt; B1(components/)</div>
<div class="line">    B --&gt; B2(lib/)</div>
<div class="line">    B --&gt; B3(types/)</div>
<div class="line">    B --&gt; B4(page.tsx)</div>
<div class="line">    B --&gt; B5(layout.tsx)</div>
<div class="line">    B --&gt; B6(globals.css)</div>
<div class="line"> </div>
<div class="line">    B1 --&gt; B1a(NetworkVisualization.tsx)</div>
<div class="line">    B1 --&gt; B1b(MetricsDashboard.tsx)</div>
<div class="line">    B1 --&gt; B1c(AssetList.tsx)</div>
<div class="line"> </div>
<div class="line">    B2 --&gt; B2a(api.ts)</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:38-53](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:30-46]()</p>
<h3><a class="anchor" id="autotoc_md976"></a>
Key Directories and Files</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Path   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>app/</code>   </td><td class="markdownTableBodyNone">Contains all application routes, components, and logic, following the Next.js App Router convention.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>app/components/</code>   </td><td class="markdownTableBodyNone">Houses reusable React components like <code>NetworkVisualization.tsx</code>, <code>MetricsDashboard.tsx</code>, and <code>AssetList.tsx</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>app/lib/api.ts</code>   </td><td class="markdownTableBodyNone">The API client module responsible for all communication with the backend. It uses <code>axios</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>app/types/api.ts</code>   </td><td class="markdownTableBodyNone">Contains TypeScript type definitions for API request and response objects.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>app/page.tsx</code>   </td><td class="markdownTableBodyNone">The main entry point page for the application, which integrates all the major components into a tabbed interface.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>app/layout.tsx</code>   </td><td class="markdownTableBodyNone">The root layout component for the application.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>public/</code>   </td><td class="markdownTableBodyNone">Stores static assets like images and fonts.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>__tests__/</code>   </td><td class="markdownTableBodyNone">Contains all Jest tests for components, libraries, and configuration.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>package.json</code>   </td><td class="markdownTableBodyNone">Defines project metadata, dependencies, and npm scripts.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>next.config.js</code>   </td><td class="markdownTableBodyNone">Configuration file for the Next.js framework.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tailwind.config.js</code>   </td><td class="markdownTableBodyNone">Configuration file for Tailwind CSS.   </td></tr>
</table>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:38-53](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:30-46](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:121-122]()</p>
<h2><a class="anchor" id="autotoc_md977"></a>
Core Components</h2>
<p>The UI is built from a set of modular React components, each responsible for a specific feature.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Component   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Features    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>NetworkVisualization.tsx</b>   </td><td class="markdownTableBodyNone">Renders the interactive 3D network graph of financial assets.   </td><td class="markdownTableBodyNone">Uses Plotly.js, supports zoom/pan/rotate, displays node and edge details on hover.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>MetricsDashboard.tsx</b>   </td><td class="markdownTableBodyNone">Displays key statistics and analytics about the asset network.   </td><td class="markdownTableBodyNone">Shows total assets, relationships, network density, and asset class distribution.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>AssetList.tsx</b>   </td><td class="markdownTableBodyNone">Provides a filterable and searchable table of all financial assets.   </td><td class="markdownTableBodyNone">Allows filtering by asset class and sector.   </td></tr>
</table>
<p>These components are integrated into the main page (<code>app/page.tsx</code>) and organized within a tabbed layout, allowing users to switch between different views of the data.</p>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:40-43](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:49-63](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:121-122, 178-185]()</p>
<h2><a class="anchor" id="autotoc_md978"></a>
Data Flow</h2>
<p>User interactions in the frontend trigger API calls to the FastAPI backend to fetch data, which is then rendered by the React components. The <code>app/lib/api.ts</code> module centralizes all data-fetching logic.</p>
<p>The following sequence diagram shows the data flow for loading the 3D visualization.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User as User</div>
<div class="line">    participant ReactComponent as &quot;NetworkVisualization.tsx&quot;</div>
<div class="line">    participant ApiClient as &quot;api.ts (Axios)&quot;</div>
<div class="line">    participant FastAPIServer as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant CoreLogic as &quot;asset_graph.py&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;ReactComponent: Navigates to Visualization Tab</div>
<div class="line">    activate ReactComponent</div>
<div class="line">    ReactComponent-&gt;&gt;ApiClient: getVisualizationData()</div>
<div class="line">    activate ApiClient</div>
<div class="line">    ApiClient-&gt;&gt;FastAPIServer: GET /api/visualization</div>
<div class="line">    activate FastAPIServer</div>
<div class="line">    FastAPIServer-&gt;&gt;CoreLogic: get_3d_visualization_data()</div>
<div class="line">    activate CoreLogic</div>
<div class="line">    CoreLogic--&gt;&gt;FastAPIServer: { nodes: [...], edges: [...] }</div>
<div class="line">    deactivate CoreLogic</div>
<div class="line">    FastAPIServer--&gt;&gt;ApiClient: 200 OK with JSON data</div>
<div class="line">    deactivate FastAPIServer</div>
<div class="line">    ApiClient--&gt;&gt;ReactComponent: Returns visualization data</div>
<div class="line">    deactivate ApiClient</div>
<div class="line">    ReactComponent-&gt;&gt;ReactComponent: Renders data with Plotly.js</div>
<div class="line">    deactivate ReactComponent</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:73-95](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:10-23, 37-38]()</p>
<h2><a class="anchor" id="autotoc_md979"></a>
Setup and Development</h2>
<p>To run the frontend locally, a few setup steps are required.</p>
<h3><a class="anchor" id="autotoc_md980"></a>
Prerequisites</h3>
<ul>
<li>Node.js 18 or higher</li>
<li>npm or yarn</li>
</ul>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:8-9]()</p>
<h3><a class="anchor" id="autotoc_md981"></a>
Installation and Execution</h3>
<ol type="1">
<li><b>Install dependencies</b> from the <code>frontend</code> directory: <code>bash npm install </code></li>
<li><b>Configure environment variables</b>. Create a <code>.env.local</code> file in the <code>frontend</code> directory with the URL of the running backend API: <code>env NEXT_PUBLIC_API_URL=<a href="http://localhost:8000">http://localhost:8000</a> </code></li>
<li><b>Run the development server</b>: <code>bash npm run dev </code> The application will be available at <code><a href="http://localhost:3000">http://localhost:3000</a></code>.</li>
</ol>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:12-24](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:41-52]()</p>
<h3><a class="anchor" id="autotoc_md982"></a>
NPM Scripts</h3>
<p>The <code>package.json</code> file defines several scripts for managing the development lifecycle.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Script   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dev</code>   </td><td class="markdownTableBodyNone">Starts the Next.js development server with hot-reloading.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>build</code>   </td><td class="markdownTableBodyNone">Creates an optimized production build of the application.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start</code>   </td><td class="markdownTableBodyNone">Starts the production server (requires a build first).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>lint</code>   </td><td class="markdownTableBodyNone">Runs ESLint to check for code quality and style issues.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>test</code>   </td><td class="markdownTableBodyNone">Runs the Jest test suite.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>test:watch</code>   </td><td class="markdownTableBodyNone">Runs tests in interactive watch mode.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>test:coverage</code>   </td><td class="markdownTableBodyNone">Runs tests and generates a code coverage report.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>test:ci</code>   </td><td class="markdownTableBodyNone">Runs tests in a CI-friendly mode.   </td></tr>
</table>
<p>Sources: [frontend/package.json:5-12](), [frontend/**tests**/config/package-validation.test.ts:88-95]()</p>
<h2><a class="anchor" id="autotoc_md983"></a>
Testing</h2>
<p>The frontend includes a comprehensive test suite using Jest and React Testing Library. Tests cover components, the API client, and configuration files.</p>
<ul>
<li><b>Component Tests</b>: Verify that components render correctly, handle user interactions, and manage data states (loading, error, success). Key files tested include <code>AssetList.test.tsx</code>, <code>MetricsDashboard.test.tsx</code>, and <code>NetworkVisualization.test.tsx</code>.</li>
<li><b>API Client Tests</b>: The <code>api.test.ts</code> file ensures that the API client correctly calls backend endpoints, handles parameters, and manages success and error responses.</li>
<li><b>Configuration Tests</b>: The <code>package-validation.test.ts</code> file validates the <code>package.json</code> for correct dependencies, scripts, and versioning.</li>
</ul>
<p>To run the tests, use the following commands from the <code>frontend</code> directory:</p>
<ul>
<li><code>npm test</code>: Run all tests.</li>
<li><code>npm test -- --coverage</code>: Run tests with a coverage report.</li>
<li><code>npm test -- --watch</code>: Run tests in watch mode.</li>
</ul>
<p>Sources: [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:28-36](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:92-192]()</p>
<h2><a class="anchor" id="autotoc_md984"></a>
Conclusion</h2>
<p>The Next.js frontend provides a robust, modern, and maintainable interface for the Financial Asset Relationship Database. Its component-based architecture, separation from the backend API, and comprehensive testing strategy make it a scalable solution suitable for production deployment. It stands as a powerful alternative to the original Gradio UI, offering superior customization, user experience, and alignment with modern web development practices.</p>
<p>Sources: [<a class="el" href="UI__COMPARISON_8md.html">UI_COMPARISON.md</a>:13-33, 142-150](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md985"></a>
Frontend API Integration</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/lib/api.ts">frontend/app/lib/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/types/api.ts">frontend/app/types/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/lib/api.test.ts">frontend/**tests**/lib/api.test.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TEST_SUMMARY.md">TEST_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md986"></a>
Frontend API Integration</h1>
<p>The Frontend API integration layer is a TypeScript module that serves as the exclusive communication bridge between the Next.js frontend application and the backend FastAPI server. Its primary purpose is to provide a centralized, type-safe, and testable interface for all data-fetching operations. This module abstracts the underlying HTTP communication, handled by Axios, and exposes a set of asynchronous functions tailored to the application's data requirements, such as fetching assets, relationships, network metrics, and visualization data.</p>
<p>This system is a core part of the modern web interface, which runs parallel to the original Gradio UI. The architecture ensures a clean separation between the frontend presentation logic and the backend business logic, with this API client acting as the intermediary. For more information on the overall system design, see the Architecture Overview.</p>
<p>Sources: [frontend/app/lib/api.ts](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md987"></a>
Architecture and Configuration</h2>
<p>The API client is built around a pre-configured Axios instance. This instance sets the base URL for all API requests, which is dynamically sourced from an environment variable. This approach allows the application to seamlessly switch between different backend environments (e.g., local development, staging, production) without code changes.</p>
<p>Sources: [frontend/app/lib/api.ts:7-11](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md988"></a>
Client Initialization</h3>
<p>An Axios instance is created with the <code>baseURL</code> set to the value of <code>NEXT_PUBLIC_API_URL</code>. If this environment variable is not set, it defaults to <code><a href="http://localhost:8000">http://localhost:8000</a></code>, ensuring functionality in a standard local development setup.</p>
<div class="fragment"><div class="line">// Source: frontend/app/lib/api.ts:7-11</div>
<div class="line">const apiClient = axios.create({</div>
<div class="line">  baseURL: process.env.NEXT_PUBLIC_API_URL || &quot;http://localhost:8000&quot;,</div>
<div class="line">  timeout: 10000, // Example timeout</div>
<div class="line">});</div>
</div><!-- fragment --><p>Sources: [frontend/app/lib/api.ts:7-11](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</p>
<p>The following diagram illustrates the configuration flow for the API client.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    A[Environment] -- reads --&gt; B(process.env.NEXT_PUBLIC_API_URL);</div>
<div class="line">    B -- &quot;Is it defined?&quot; --&gt; C{Use Value};</div>
<div class="line">    B -- &quot;Is it undefined?&quot; --&gt; D[Use Default &#39;http://localhost:8000&#39;];</div>
<div class="line">    C --&gt; E[axios.create({ baseURL })];</div>
<div class="line">    D --&gt; E;</div>
<div class="line">    E --&gt; F(apiClient Instance);</div>
</div><!-- fragment --><p>This diagram shows how the <code>apiClient</code> instance is configured with the correct base URL. Sources: [frontend/app/lib/api.ts:7-11](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md989"></a>
API Client Functions</h2>
<p>The module exports a collection of functions, each corresponding to a specific backend API endpoint. These functions encapsulate the logic for making the request, handling the response data, and managing potential errors.</p>
<p>Sources: [frontend/app/lib/api.ts](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md990"></a>
Endpoint Summary</h3>
<p>The table below maps the client functions to their respective backend API endpoints.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Function Name   </th><th class="markdownTableHeadLeft">HTTP Method   </th><th class="markdownTableHeadLeft">Endpoint Path   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>healthCheck</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/health</code>   </td><td class="markdownTableBodyLeft">Checks the health of the backend API.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getAssets</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets</code>   </td><td class="markdownTableBodyLeft">Fetches a list of assets, with optional filtering.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getAssetDetail</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets/{id}</code>   </td><td class="markdownTableBodyLeft">Fetches detailed information for a single asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getAssetRelationships</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/assets/{id}/relationships</code>   </td><td class="markdownTableBodyLeft">Fetches relationships for a specific asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getAllRelationships</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/relationships</code>   </td><td class="markdownTableBodyLeft">Fetches all relationships in the graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getMetrics</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/metrics</code>   </td><td class="markdownTableBodyLeft">Fetches network-wide metrics.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getVisualizationData</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/visualization</code>   </td><td class="markdownTableBodyLeft">Fetches data required for the 3D network graph.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>getAssetClasses</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/asset-classes</code>   </td><td class="markdownTableBodyLeft">Fetches the list of available asset classes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>getSectors</code>   </td><td class="markdownTableBodyLeft"><code>GET</code>   </td><td class="markdownTableBodyLeft"><code>/api/sectors</code>   </td><td class="markdownTableBodyLeft">Fetches the list of available industry sectors.   </td></tr>
</table>
<p>Sources: [frontend/app/lib/api.ts](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md991"></a>
Function Details</h3>
<h4><a class="anchor" id="autotoc_md992"></a>
<code>getAssets</code></h4>
<p>This function retrieves a list of financial assets. It supports optional filtering by <code>assetClass</code> and <code>sector</code>.</p>
<ul>
<li><b>Parameters</b>:<ul>
<li><code>assetClass</code> (optional, <code>string</code>): The asset class to filter by.</li>
<li><code>sector</code> (optional, <code>string</code>): The sector to filter by.</li>
</ul>
</li>
<li><b>Returns</b>: <code>Promise&lt;Asset[]&gt;</code></li>
</ul>
<p>The function constructs query parameters dynamically based on the provided arguments.</p>
<p>Sources: [frontend/app/lib/api.ts:25-36]()</p>
<h3><a class="anchor" id="autotoc_md993"></a>
API Call Flow Example</h3>
<p>The following sequence diagram illustrates a typical flow when a frontend component calls the <code>getAssets</code> function.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Component as &quot;React Component&quot;</div>
<div class="line">    participant APIClient as &quot;api.ts&quot;</div>
<div class="line">    participant Axios as &quot;Axios Instance&quot;</div>
<div class="line">    participant Backend as &quot;FastAPI Backend&quot;</div>
<div class="line"> </div>
<div class="line">    Component-&gt;&gt;APIClient: getAssets({ assetClass: &#39;Equity&#39; })</div>
<div class="line">    activate APIClient</div>
<div class="line">    APIClient-&gt;&gt;Axios: apiClient.get(&#39;/api/assets&#39;, { params: { asset_class: &#39;Equity&#39; } })</div>
<div class="line">    activate Axios</div>
<div class="line">    Axios-&gt;&gt;Backend: GET /api/assets?asset_class=Equity</div>
<div class="line">    activate Backend</div>
<div class="line">    Backend--&gt;&gt;Axios: 200 OK (JSON: Asset[])</div>
<div class="line">    deactivate Backend</div>
<div class="line">    Axios--&gt;&gt;APIClient: Promise resolves with response</div>
<div class="line">    deactivate Axios</div>
<div class="line">    APIClient--&gt;&gt;Component: return response.data</div>
<div class="line">    deactivate APIClient</div>
</div><!-- fragment --><p>This diagram shows the journey of a request from a React component to the backend and back. Sources: [frontend/app/lib/api.ts:25-36](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md994"></a>
Data Models and Types</h2>
<p>To ensure type safety across the application, all data structures returned by the API are strictly typed using TypeScript interfaces defined in <code>frontend/app/types/api.ts</code>. These types are used as generics in the API client functions to provide compile-time checks and editor autocompletion.</p>
<p>Sources: [frontend/app/types/api.ts](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md995"></a>
Core Data Models</h3>
<p>The diagram below shows the main data entities and their relationships.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: string</div>
<div class="line">        +symbol: string</div>
<div class="line">        +name: string</div>
<div class="line">        +asset_class: string</div>
<div class="line">        +sector: string</div>
<div class="line">        +currency: string</div>
<div class="line">        +market_cap: number</div>
<div class="line">        +price: number</div>
<div class="line">        +additional_fields: object</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Relationship {</div>
<div class="line">        +source: string</div>
<div class="line">        +target: string</div>
<div class="line">        +type: string</div>
<div class="line">        +strength: number</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Metrics {</div>
<div class="line">        +total_assets: number</div>
<div class="line">        +total_relationships: number</div>
<div class="line">        +network_density: number</div>
<div class="line">        +average_degree: number</div>
<div class="line">        +max_degree: AssetDegree</div>
<div class="line">        +asset_class_distribution: object</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class VisualizationData {</div>
<div class="line">        +nodes: Node[]</div>
<div class="line">        +edges: Edge[]</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Node {</div>
<div class="line">      +id: string</div>
<div class="line">      +label: string</div>
<div class="line">      +color: string</div>
<div class="line">      +size: number</div>
<div class="line">      +details: Asset</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    class Edge {</div>
<div class="line">      +source: string</div>
<div class="line">      +target: string</div>
<div class="line">      +strength: number</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    VisualizationData &quot;1&quot; -- &quot;0..*&quot; Node</div>
<div class="line">    VisualizationData &quot;1&quot; -- &quot;0..*&quot; Edge</div>
<div class="line">    Node &quot;1&quot; -- &quot;1&quot; Asset : contains</div>
<div class="line">    Edge &quot;1&quot; -- &quot;1&quot; Relationship : represents</div>
</div><!-- fragment --><p>This class diagram outlines the structure of the primary data types used in the API communication. Sources: [frontend/app/types/api.ts](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md996"></a>
<code>Asset</code> Interface</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Property   </th><th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>id</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">Unique identifier for the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>symbol</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">The ticker symbol or identifier.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>name</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">The full name of the asset.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>asset_class</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">The class of the asset (e.g., 'Equity', 'Bond').    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>sector</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">The industry sector.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>currency</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">The currency the asset is priced in (ISO code).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>market_cap</code>   </td><td class="markdownTableBodyLeft"><code>number</code>   </td><td class="markdownTableBodyLeft">The market capitalization.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>price</code>   </td><td class="markdownTableBodyLeft"><code>number</code>   </td><td class="markdownTableBodyLeft">The current price of the asset.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>additional_fields</code>   </td><td class="markdownTableBodyLeft"><code>Record&lt;string, any&gt;</code>   </td><td class="markdownTableBodyLeft">A key-value map for asset-specific data.   </td></tr>
</table>
<p>Sources: [frontend/app/types/api.ts:1-11]()</p>
<h2><a class="anchor" id="autotoc_md997"></a>
Error Handling</h2>
<p>Error handling is implemented using <code>try...catch</code> blocks within each API function. The client is designed to catch errors thrown by Axios, which are typically instances of <code>AxiosError</code>. The caught error is logged to the console, and the function re-throws the error to allow the calling component to implement its own UI-specific error handling logic (e.g., displaying a notification or a fallback UI).</p>
<p>The test suite validates this behavior by mocking various error scenarios, including network errors, timeouts, and HTTP status codes like 404 and 500.</p>
<p>Sources: [frontend/app/lib/api.ts](), [frontend/**tests**/lib/api.test.ts]()</p>
<h3><a class="anchor" id="autotoc_md998"></a>
Error Handling Flow</h3>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Component calls API function] --&gt; B{try...catch block};</div>
<div class="line">    B -- &quot;try&quot; --&gt; C[apiClient makes HTTP request];</div>
<div class="line">    C --&gt; D{Request Successful?};</div>
<div class="line">    D -- Yes --&gt; E[Return response.data];</div>
<div class="line">    D -- No --&gt; F[Axios throws error];</div>
<div class="line">    F --&gt; G[catch (error) block];</div>
<div class="line">    G --&gt; H[Log error to console];</div>
<div class="line">    H --&gt; I[Re-throw error];</div>
<div class="line">    I --&gt; J[Calling component handles error];</div>
<div class="line">    E --&gt; J;</div>
</div><!-- fragment --><p>This flowchart shows the standardized error handling process for all API calls. Sources: [frontend/app/lib/api.ts:13-23](), [frontend/**tests**/lib/api.test.ts]()</p>
<h2><a class="anchor" id="autotoc_md999"></a>
Testing</h2>
<p>The API client is extensively tested using Jest. The tests cover every exported function and validate multiple scenarios:</p>
<ul>
<li><b>Configuration</b>: Ensures the Axios instance is created correctly.</li>
<li><b>Successful Responses</b>: Verifies that data is returned in the expected format.</li>
<li><b>Filtering</b>: Confirms that query parameters are correctly passed for functions like <code>getAssets</code>.</li>
<li><b>Error Handling</b>: Mocks network errors, HTTP 404/500 errors, and timeouts to ensure they are handled gracefully.</li>
<li><b>Type Safety</b>: The tests are written in TypeScript, implicitly validating the data models.</li>
</ul>
<p>These tests provide a safety net against regressions and ensure the API client remains reliable and consistent with the backend contract.</p>
<p>Sources: [frontend/**tests**/lib/api.test.ts](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md1000"></a>
Component: NetworkVisualization</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/components/NetworkVisualization.tsx">frontend/app/components/NetworkVisualization.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/components/NetworkVisualization.test.tsx">frontend/**tests**/components/NetworkVisualization.test.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/types/api.ts">frontend/app/types/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/page.tsx">frontend/app/page.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1001"></a>
Component: NetworkVisualization</h1>
<p>The <code>NetworkVisualization</code> component is a client-side React component responsible for rendering an interactive 3D graph of financial assets and their relationships. It utilizes the <code>react-plotly.js</code> library to create the visualization based on data fetched from the backend API. This component is a core feature of the Next.js frontend, providing a visual representation of the interconnected financial network.</p>
<p>The component is designed to be integrated into a tabbed interface on the main application page, where it receives processed data and handles its own rendering logic, including loading and empty states.</p>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx](), [frontend/app/page.tsx:16](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1002"></a>
Component Architecture</h2>
<p>The component receives visualization data as a prop and processes it into a format suitable for Plotly.js. Its internal logic handles different states: loading, empty data, and successful data rendering.</p>
<h3><a class="anchor" id="autotoc_md1003"></a>
Component Props</h3>
<p>The component accepts a single prop:</p>
<p>| Prop | Type | Description | | :--&mdash; | :--------------&mdash; | :-------&mdash; | ---------------------------------------------------------------------------------&mdash; | | <code>data</code> | <code>VisualizationData | null</code> | An object containing node and edge data for the graph, or <code>null</code> if data is loading. |</p>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx:11]()</p>
<h3><a class="anchor" id="autotoc_md1004"></a>
State Management</h3>
<p>The component is stateless and derives its entire view from the <code>data</code> prop. It implements conditional rendering based on the state of this prop:</p>
<ol type="1">
<li>If <code>data</code> is <code>null</code>, it displays a "Loading visualization..." message.</li>
<li>If <code>data</code> is present but <code>data.nodes</code> is an empty array, it displays a "No visualization data available." message.</li>
<li>If <code>data</code> and <code>data.nodes</code> are populated, it renders the Plotly graph.</li>
</ol>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx:14-19]()</p>
<h3><a class="anchor" id="autotoc_md1005"></a>
Rendering Flow</h3>
<p>The following diagram illustrates the component's rendering logic.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Component Renders] --&gt; B{Is `data` prop null?};</div>
<div class="line">    B -- Yes --&gt; C[Display &quot;Loading visualization...&quot;];</div>
<div class="line">    B -- No --&gt; D{Is `data.nodes` empty?};</div>
<div class="line">    D -- Yes --&gt; E[Display &quot;No visualization data available.&quot;];</div>
<div class="line">    D -- No --&gt; F[Process Nodes and Edges];</div>
<div class="line">    F --&gt; G[Configure Plotly Data and Layout];</div>
<div class="line">    G --&gt; H[Render Plotly 3D Graph];</div>
</div><!-- fragment --><p><em>This diagram shows the conditional rendering path based on the <code>data</code> prop.</em></p>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx:13-89]()</p>
<h2><a class="anchor" id="autotoc_md1006"></a>
Data Processing</h2>
<p>The component receives data structured according to the <code>VisualizationData</code> type and transforms it into traces for Plotly.</p>
<h3><a class="anchor" id="autotoc_md1007"></a>
Input Data Structure</h3>
<p>The <code>data</code> prop conforms to the <code>VisualizationData</code> interface, which is defined in <code>frontend/app/types/api.ts</code>.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class VisualizationData {</div>
<div class="line">        +Node[] nodes</div>
<div class="line">        +Edge[] edges</div>
<div class="line">    }</div>
<div class="line">    class Node {</div>
<div class="line">        +string id</div>
<div class="line">        +string label</div>
<div class="line">        +string color</div>
<div class="line">        +number size</div>
<div class="line">        +number x</div>
<div class="line">        +number y</div>
<div class="line">        +number z</div>
<div class="line">    }</div>
<div class="line">    class Edge {</div>
<div class="line">        +string source</div>
<div class="line">        +string target</div>
<div class="line">        +string color</div>
<div class="line">        +number width</div>
<div class="line">    }</div>
<div class="line">    VisualizationData &quot;1&quot; *-- &quot;0..*&quot; Node</div>
<div class="line">    VisualizationData &quot;1&quot; *-- &quot;0..*&quot; Edge</div>
</div><!-- fragment --><p><em>This diagram shows the structure of the <code>VisualizationData</code> object, including its <code>Node</code> and <code>Edge</code> arrays.</em></p>
<p>Sources: [frontend/app/types/api.ts:25-41]()</p>
<h3><a class="anchor" id="autotoc_md1008"></a>
Node and Edge Transformation</h3>
<p>The component processes the <code>nodes</code> and <code>edges</code> arrays to create separate traces for the Plotly chart.</p>
<ol type="1">
<li><b>Node Processing</b>: It iterates through <code>data.nodes</code> to create a <code>scatter3d</code> trace. The <code>x</code>, <code>y</code>, <code>z</code>, <code>text</code>, <code>marker.color</code>, and <code>marker.size</code> properties are populated from the corresponding fields in each <code>Node</code> object. Sources: [frontend/app/components/NetworkVisualization.tsx:23-32]()</li>
<li><b>Edge Processing</b>: It constructs a <code>scatter3d</code> trace for the edges. For each edge, it finds the coordinates of the source and target nodes and adds them to <code>x</code>, <code>y</code>, and <code>z</code> arrays, with a <code>null</code> value in between to create separate lines for each edge. Sources: [frontend/app/components/NetworkVisualization.tsx:34-52]()</li>
</ol>
<h2><a class="anchor" id="autotoc_md1009"></a>
Plotly Configuration</h2>
<p>The visualization is configured through <code>data</code> (traces) and <code>layout</code> objects passed to the <code>Plot</code> component from <code>react-plotly.js</code>.</p>
<h3><a class="anchor" id="autotoc_md1010"></a>
Plotly Traces</h3>
<p>Two <code>scatter3d</code> traces are generated: one for nodes and one for edges.</p>
<h4><a class="anchor" id="autotoc_md1011"></a>
Node Trace (<code>nodeTrace</code>)</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Property   </th><th class="markdownTableHeadLeft">Value   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>x</code>, <code>y</code>, <code>z</code>   </td><td class="markdownTableBodyLeft">Arrays of coordinates from <code>data.nodes</code>   </td><td class="markdownTableBodyLeft">Positions the nodes in 3D space.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>text</code>   </td><td class="markdownTableBodyLeft">Array of labels from <code>data.nodes</code>   </td><td class="markdownTableBodyLeft">Text to display on hover.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>mode</code>   </td><td class="markdownTableBodyLeft">&lsquo;'markers&rsquo;<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Renders nodes as markers (points). \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>hoverinfo<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'text'<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Shows only the</code>text<code>field on hover. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>marker.color<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Array of colors from</code>data.nodes<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Sets the color for each node. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>marker.size<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Array of sizes from</code>data.nodes<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Sets the size for each node. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>marker.sizemode<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'diameter'<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Interprets</code>size` as the marker diameter.   </td></tr>
</table>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx:21-33]()</p>
<h4><a class="anchor" id="autotoc_md1012"></a>
Edge Trace (<code>edgeTrace</code>)</h4>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Property   </th><th class="markdownTableHeadLeft">Value   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>x</code>, <code>y</code>, <code>z</code>   </td><td class="markdownTableBodyLeft">Arrays of interleaved source/target coordinates separated by <code>null</code>   </td><td class="markdownTableBodyLeft">Defines the start and end points for each edge line.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>mode</code>   </td><td class="markdownTableBodyLeft">&lsquo;'lines&rsquo;<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Renders edges as lines. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>hoverinfo<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'none'<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Disables hover interactions for edges. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>line.color<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'#888'<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Sets a default gray color for all edges. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>line.width<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>1`   </td><td class="markdownTableBodyLeft">Sets a default width for all edges.   </td></tr>
</table>
<p>Sources: [frontend/app/components/NetworkVisualization.tsx:34-53]()</p>
<h3><a class="anchor" id="autotoc_md1013"></a>
Plotly Layout</h3>
<p>The <code>layout</code> object configures the overall appearance and behavior of the 3D scene.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Property   </th><th class="markdownTableHeadLeft">Value   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>title</code>   </td><td class="markdownTableBodyLeft">&lsquo;'Financial Asset Relationship Network&rsquo;<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; The title of the graph. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>autosize<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>true<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Allows the plot to fill its container. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>showlegend<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>false<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Hides the plot legend. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>scene.xaxis.visible<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>false<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Hides the x-axis lines, labels, and grid. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>scene.yaxis.visible<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>false<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Hides the y-axis lines, labels, and grid. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>scene.zaxis.visible<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>false<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Hides the z-axis lines, labels, and grid. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>margin<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>{ l: 0, r: 0, b: 0, t: 40 }<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Removes margins around the plot area. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowEven"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>paper_bgcolor<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'#f0f2f5'<code>(light) or</code>'#1a202c'<code>(dark) \ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt; Sets the background color of the plot container. \ilinebr &lt;/td&gt; &lt;/tr&gt; &lt;tr class="markdownTableRowOdd"&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>plot_bgcolor<code>\ilinebr &lt;/td&gt; &lt;td class="markdownTableBodyLeft"&gt;</code>'#f0f2f5'<code>(light) or</code>'#1a202c'` (dark)   </td><td class="markdownTableBodyLeft">Sets the background color of the plotting area.   </td></tr>
</table>
<p><em>Note: Background colors are conditionally set based on the theme, but the provided file only shows one set of values.</em> Sources: [frontend/app/components/NetworkVisualization.tsx:55-73]()</p>
<h2><a class="anchor" id="autotoc_md1014"></a>
Integration</h2>
<p>The <code>NetworkVisualization</code> component is used within the main application page, <code>frontend/app/page.tsx</code>.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Page as &quot;app/page.tsx&quot;</div>
<div class="line">    participant API as &quot;FastAPI Backend&quot;</div>
<div class="line">    participant Viz as &quot;NetworkVisualization&quot;</div>
<div class="line"> </div>
<div class="line">    Page-&gt;&gt;API: GET /api/visualization</div>
<div class="line">    API--&gt;&gt;Page: { nodes: [...], edges: [...] }</div>
<div class="line">    Page-&gt;&gt;Viz: Renders &lt;NetworkVisualization data={vizData} /&gt;</div>
<div class="line">    Note over Viz: Component processes data and renders Plotly graph</div>
</div><!-- fragment --><p><em>This diagram shows how the main page fetches data and passes it to the <code>NetworkVisualization</code> component.</em></p>
<p>In <code>page.tsx</code>, it is rendered inside a <code>TabsContent</code> container, making it visible when the "3D Visualization" tab is active. The <code>vizData</code> state from the page is passed directly to the component's <code>data</code> prop.</p>
<p>Sources: [frontend/app/page.tsx:16, 68-70](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1015"></a>
Testing</h2>
<p>The component is tested in <code>frontend/__tests__/components/NetworkVisualization.test.tsx</code>. The tests cover several key areas:</p>
<ul>
<li><b>Rendering States</b>:<ul>
<li>It correctly displays a loading message when <code>data</code> is <code>null</code>.</li>
<li>It correctly displays an empty state message when <code>data.nodes</code> is an empty array.</li>
<li>It renders the <code>Plot</code> component when valid data is provided.</li>
</ul>
</li>
<li><b>Data Processing</b>:<ul>
<li>It processes node data correctly into Plotly-compatible <code>x</code>, <code>y</code>, <code>z</code>, <code>color</code>, and <code>size</code> arrays.</li>
<li>It processes edge data correctly, ensuring source and target nodes are connected.</li>
</ul>
</li>
<li><b>Plotly Configuration</b>:<ul>
<li>It verifies that the <code>data</code> and <code>layout</code> props passed to the <code>Plot</code> component have the correct structure and values.</li>
</ul>
</li>
<li><b>Edge Cases</b>:<ul>
<li>Handles scenarios with a single node and no edges.</li>
<li>Handles empty data gracefully.</li>
</ul>
</li>
</ul>
<p>Sources: [frontend/**tests**/components/NetworkVisualization.test.tsx]()</p>
<h2><a class="anchor" id="autotoc_md1016"></a>
Summary</h2>
<p>The <code>NetworkVisualization</code> component is a specialized, presentation-focused component that encapsulates the logic for displaying a complex 3D financial network graph. It effectively decouples the visualization logic from the data-fetching and state management concerns, which are handled by its parent component (<code>page.tsx</code>). By relying on a well-defined <code>VisualizationData</code> structure, it serves as a robust and testable module for the application's primary visual feature.</p>
<h3><a class="anchor" id="autotoc_md1017"></a>
Component: AssetList</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/components/AssetList.tsx">frontend/app/components/AssetList.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/__tests__/components/AssetList.test.tsx">frontend/**tests**/components/AssetList.test.tsx</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/lib/api.ts">frontend/app/lib/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/app/types/api.ts">frontend/app/types/api.ts</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md1018"></a>
Component: AssetList</h1>
<p>The <code>AssetList</code> is a stateful React component responsible for displaying a filterable and paginated list of financial assets. It fetches data from the backend API, manages loading and error states, and updates the view based on user interactions with filter and pagination controls. The component's state is synchronized with the URL query parameters, allowing for shareable and bookmarkable views.</p>
<p>Sources: [frontend/app/components/AssetList.tsx](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:30-34]()</p>
<h2><a class="anchor" id="autotoc_md1019"></a>
Architecture and Data Flow</h2>
<p>The component's logic is centered around a <code>useEffect</code> hook that triggers data fetching whenever URL search parameters change. It uses hooks from <code>next/navigation</code> to read and write to the URL, creating a single source of truth for the component's state.</p>
<p>Sources: [frontend/app/components/AssetList.tsx:41-69]()</p>
<h3><a class="anchor" id="autotoc_md1020"></a>
Component Lifecycle and State Management</h3>
<p>The following diagram illustrates the data flow from component mount to rendering the asset list.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    subgraph AssetList Component</div>
<div class="line">        A[Mount] --&gt; B{Read URL Search Params};</div>
<div class="line">        B --&gt; C[Set Initial State (page, filters)];</div>
<div class="line">        C --&gt; D[useEffect Trigger];</div>
<div class="line">        D --&gt; E{Fetch Data from API};</div>
<div class="line">        E -- Success --&gt; F[Set Assets &amp; Pagination Data];</div>
<div class="line">        E -- Error --&gt; G[Set Error State];</div>
<div class="line">        F --&gt; H[Render Asset Table &amp; Filters];</div>
<div class="line">        G --&gt; I[Render Error Message];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph User Interaction</div>
<div class="line">        J[User changes filter/page] --&gt; K[Update URL Search Params];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    K --&gt; D;</div>
</div><!-- fragment --><p>This diagram shows the reactive loop where changes to URL parameters trigger a data refetch. Sources: [frontend/app/components/AssetList.tsx:28-69]()</p>
<h3><a class="anchor" id="autotoc_md1021"></a>
API Interaction</h3>
<p><code>AssetList</code> interacts with three main functions from the API client library (<code>app/lib/api.ts</code>):</p>
<ol type="1">
<li><code>api.getAssetClasses()</code>: To populate the "Asset Class" filter dropdown.</li>
<li><code>api.getSectors()</code>: To populate the "Sector" filter dropdown.</li>
<li><code>api.getAssets()</code>: To fetch the paginated list of assets based on current filters.</li>
</ol>
<p>Sources: [frontend/app/components/AssetList.tsx:44-50](), [frontend/**tests**/components/AssetList.test.tsx:43-45]()</p>
<p>The following sequence diagram details the process of fetching assets.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant User</div>
<div class="line">    participant AssetList as &quot;AssetList.tsx&quot;</div>
<div class="line">    participant APIClient as &quot;api.ts&quot;</div>
<div class="line">    participant Backend as &quot;Backend API&quot;</div>
<div class="line"> </div>
<div class="line">    User-&gt;&gt;AssetList: Changes filter (e.g., selects &#39;EQUITY&#39;)</div>
<div class="line">    activate AssetList</div>
<div class="line">    AssetList-&gt;&gt;AssetList: handleFilterChange()</div>
<div class="line">    AssetList-&gt;&gt;AssetList: Updates URL with new search param</div>
<div class="line">    Note over AssetList: useEffect hook is triggered by URL change</div>
<div class="line">    AssetList-&gt;&gt;APIClient: api.getAssets({ asset_class: &#39;EQUITY&#39;, ... })</div>
<div class="line">    deactivate AssetList</div>
<div class="line">    activate APIClient</div>
<div class="line">    APIClient-&gt;&gt;Backend: GET /api/assets?asset_class=EQUITY</div>
<div class="line">    activate Backend</div>
<div class="line">    Backend--&gt;&gt;APIClient: PaginatedAssetsResponse</div>
<div class="line">    deactivate Backend</div>
<div class="line">    APIClient--&gt;&gt;AssetList: Promise resolves with asset data</div>
<div class="line">    deactivate APIClient</div>
<div class="line">    activate AssetList</div>
<div class="line">    AssetList-&gt;&gt;AssetList: Updates state with new assets</div>
<div class="line">    AssetList--&gt;&gt;User: Renders updated asset table</div>
<div class="line">    deactivate AssetList</div>
</div><!-- fragment --><p>This diagram illustrates how a user filter change propagates through the component to the backend API and back to the UI. Sources: [frontend/app/components/AssetList.tsx:41-69](), [frontend/app/lib/api.ts:20-33]()</p>
<h3><a class="anchor" id="autotoc_md1022"></a>
<code>getAssets</code> API Parameters</h3>
<p>The <code>getAssets</code> function accepts several parameters to filter and paginate the results.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Parameter   </th><th class="markdownTableHeadLeft">Type   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>page</code>   </td><td class="markdownTableBodyLeft"><code>number</code>   </td><td class="markdownTableBodyLeft">The page number to retrieve.   </td><td class="markdownTableBodyLeft"><code>[frontend/app/lib/api.ts:21]()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>per_page</code>   </td><td class="markdownTableBodyLeft"><code>number</code>   </td><td class="markdownTableBodyLeft">The number of assets to retrieve per page.   </td><td class="markdownTableBodyLeft"><code>[frontend/app/lib/api.ts:21]()</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>asset_class</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">Filters assets by their class (e.g., 'EQUITY').   </td><td class="markdownTableBodyLeft"><code>[frontend/app/lib/api.ts:21]()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>sector</code>   </td><td class="markdownTableBodyLeft"><code>string</code>   </td><td class="markdownTableBodyLeft">Filters assets by their sector (e.g., 'Technology').   </td><td class="markdownTableBodyLeft"><code>[frontend/app/lib/api.ts:21]()</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1023"></a>
UI Components</h2>
<h3><a class="anchor" id="autotoc_md1024"></a>
Filters</h3>
<p>The "Filters" section contains two dropdown menus: "Asset Class" and "Sector".</p>
<ul>
<li>The options for these dropdowns are fetched from the <code>getAssetClasses</code> and <code>getSectors</code> API endpoints on component mount.</li>
<li>Changing a filter's value triggers the <code>handleFilterChange</code> function, which updates the corresponding URL search parameter and resets the page to 1. This change automatically triggers a data refetch via the <code>useEffect</code> hook.</li>
</ul>
<p>Sources: [frontend/app/components/AssetList.tsx:75-111](), [frontend/**tests**/components/AssetList.test.tsx:81-96]()</p>
<h3><a class="anchor" id="autotoc_md1025"></a>
Asset Table</h3>
<p>The main content area is a table that displays the fetched assets. If the data is loading or an error occurs, a message is displayed instead.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Column   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Data Type    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Symbol</b>   </td><td class="markdownTableBodyLeft">The asset's ticker symbol.   </td><td class="markdownTableBodyLeft"><code>string</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Name</b>   </td><td class="markdownTableBodyLeft">The full name of the asset.   </td><td class="markdownTableBodyLeft"><code>string</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Asset Class</b>   </td><td class="markdownTableBodyLeft">The class of the asset (e.g., EQUITY, BOND).   </td><td class="markdownTableBodyLeft"><code>string</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Sector</b>   </td><td class="markdownTableBodyLeft">The industry sector of the asset.   </td><td class="markdownTableBodyLeft"><code>string</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Price</b>   </td><td class="markdownTableBodyLeft">The current price of the asset.   </td><td class="markdownTableBodyLeft"><code>number</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Market Cap</b>   </td><td class="markdownTableBodyLeft">The market capitalization of the asset.   </td><td class="markdownTableBodyLeft"><code>number</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Currency</b>   </td><td class="markdownTableBodyLeft">The currency of the price and market cap.   </td><td class="markdownTableBodyLeft"><code>string</code>   </td></tr>
</table>
<p>The data for this table corresponds to the <code>Asset</code> type definition. Sources: [frontend/app/components/AssetList.tsx:125-163](), [frontend/app/types/api.ts:1-10]()</p>
<h3><a class="anchor" id="autotoc_md1026"></a>
Pagination</h3>
<p>Pagination controls are rendered below the table.</p>
<ul>
<li>They include "Previous" and "Next" buttons.</li>
<li>The component calculates whether to disable these buttons based on the current <code>page</code> and the <code>total</code> number of assets returned from the API.</li>
<li>Clicking a button updates the <code>page</code> search parameter in the URL, triggering a refetch for the new page.</li>
</ul>
<p>Sources: [frontend/app/components/AssetList.tsx:165-186](), [frontend/**tests**/components/AssetList.test.tsx:128-143]()</p>
<h2><a class="anchor" id="autotoc_md1027"></a>
Error Handling and Loading States</h2>
<p>The component manages its state through <code>useState</code> hooks for <code>loading</code> and <code>error</code>.</p>
<ul>
<li><b>Loading</b>: The <code>loading</code> state is <code>true</code> while an API request is in progress. The UI displays a "Loading results..." message.</li>
<li><b>Error</b>: If an API call fails, the <code>error</code> state is set with an error message. The UI displays an alert with the error, and the error is logged to the console via <code>console.error</code>.</li>
<li><b>Empty State</b>: If the API returns no assets, a "No assets found" message is displayed.</li>
</ul>
<p>Sources: [frontend/app/components/AssetList.tsx:23-24, 60-64, 113-124](), [frontend/**tests**/components/AssetList.test.tsx:116-127]()</p>
<h2><a class="anchor" id="autotoc_md1028"></a>
Testing</h2>
<p>The component is tested comprehensively in <code>AssetList.test.tsx</code>. The tests cover:</p>
<ul>
<li>Initial component rendering.</li>
<li>Data loading and display from a mocked API.</li>
<li>Functionality of asset class and sector filters.</li>
<li>Pagination logic (next/previous page requests).</li>
<li>Correct handling of loading, empty, and error states.</li>
<li>Respecting initial state from URL query parameters on mount.</li>
</ul>
<p>The tests use <code>jest.mock</code> to mock the <code>api</code> client and <code>next/navigation</code> hooks, ensuring the component's logic is tested in isolation.</p>
<p>Sources: [frontend/**tests**/components/AssetList.test.tsx](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:73-93]()</p>
<h2><a class="anchor" id="autotoc_md1029"></a>
Summary</h2>
<p>The <code>AssetList</code> component serves as a robust and interactive data browser for financial assets. By leveraging URL parameters for state management, it provides a clean, shareable, and bookmarkable user experience. Its clear separation of concernsâ€”fetching data, managing state, and rendering UIâ€”makes it a maintainable and central part of the application's frontend.</p>
<h2><a class="anchor" id="autotoc_md1030"></a>
Deployment and Infrastructure</h2>
<h3><a class="anchor" id="autotoc_md1031"></a>
Local Development Setup</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p><ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/run-dev.sh">run-dev.sh</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/run-dev.bat">run-dev.bat</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/README.md">frontend/README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1032"></a>
Local Development Setup</h1>
<p>The project supports multiple local development environments, including a modern Next.js frontend with a FastAPI backend, an original Gradio-based UI, and a containerized Docker setup. This guide provides instructions for setting up and running the application locally for development and testing purposes. The recommended setup for most developers is the Next.js and FastAPI combination, which can be launched with a single script.</p>
<p>For more information on the system's components and how they interact, refer to the Architecture Overview. For contribution guidelines, including coding standards and pull request processes, see the Contributing Guide.</p>
<h2><a class="anchor" id="autotoc_md1033"></a>
Prerequisites</h2>
<p>Before starting, ensure you have the following tools installed on your system.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Tool   </th><th class="markdownTableHeadNone">Minimum Version   </th><th class="markdownTableHeadNone">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Python   </td><td class="markdownTableBodyNone">3.8+   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Node.js   </td><td class="markdownTableBodyNone">18+   </td><td class="markdownTableBodyNone"><code>README.md</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Git   </td><td class="markdownTableBodyNone">N/A   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Virtual Env Tool   </td><td class="markdownTableBodyNone"><code>venv</code>, <code>virtualenv</code>, or <code>conda</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:16-20](), [README.md:8-9]()</p>
<h2><a class="anchor" id="autotoc_md1034"></a>
Core Environment Setup</h2>
<p>This initial setup is required for all development options except Docker. It involves creating a Python virtual environment and installing all necessary dependencies.</p>
<h3><a class="anchor" id="autotoc_md1035"></a>
1. Clone the Repository</h3>
<p>First, clone your fork of the repository to your local machine. Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:25-28]()</p>
<h3><a class="anchor" id="autotoc_md1036"></a>
2. Create and Activate Virtual Environment</h3>
<p>It is crucial to use a virtual environment to isolate project dependencies.</p>
<p><b>Create the environment:</b></p>
<div class="fragment"><div class="line">python -m venv .venv</div>
</div><!-- fragment --><p><b>Activate the environment:</b></p>
<ul>
<li><b>Windows (PowerShell):</b> <code>.\.venv\Scripts\Activate.ps1</code></li>
<li><b>Windows (Command Prompt):</b> <code>.venv\Scripts\activate.bat</code></li>
<li><b>macOS/Linux:</b> <code>source .venv/bin/activate</code></li>
</ul>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:40-56](), [README.md:17-29]()</p>
<h3><a class="anchor" id="autotoc_md1037"></a>
3. Install Dependencies</h3>
<p>The project separates production and development dependencies. The <code>install-dev</code> Makefile command installs both.</p>
<div class="fragment"><div class="line"># Install all dependencies using the Makefile</div>
<div class="line">make install-dev</div>
</div><!-- fragment --><p>Alternatively, you can install them manually:</p>
<div class="fragment"><div class="line"># Install production dependencies</div>
<div class="line">pip install -r requirements.txt</div>
<div class="line"> </div>
<div class="line"># Install development dependencies</div>
<div class="line">pip install -r requirements-dev.txt</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:58-68](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:32-33]()</p>
<h2><a class="anchor" id="autotoc_md1038"></a>
Development Environment Options</h2>
<p>The project can be run in three different modes for local development.</p>
<h3><a class="anchor" id="autotoc_md1039"></a>
Option 1: Next.js Frontend + FastAPI Backend (Recommended)</h3>
<p>This setup runs the modern web frontend and the REST API backend. It is the recommended approach for most development tasks.</p>
<h4><a class="anchor" id="autotoc_md1040"></a>
Automated Quick Start</h4>
<p>The easiest way to start is by using the provided run scripts, which launch both the backend and frontend servers concurrently.</p>
<ul>
<li><b>Linux/macOS:</b> <code>./run-dev.sh</code></li>
<li><b>Windows:</b> <code>run-dev.bat</code></li>
</ul>
<p>This will start the FastAPI backend on <code><a href="http://localhost:8000">http://localhost:8000</a></code> and the Next.js frontend on <code><a href="http://localhost:3000">http://localhost:3000</a></code>.</p>
<p>The following diagram illustrates the process executed by the <code>run-dev</code> scripts.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start run-dev.sh / run-dev.bat] --&gt; B{Terminal 1};</div>
<div class="line">    A --&gt; C{Terminal 2};</div>
<div class="line">    B --&gt; D[Start FastAPI Backend];</div>
<div class="line">    D --&gt; E[&quot;uvicorn api.main:app --reload --port 8000&quot;];</div>
<div class="line">    C --&gt; F[Start Next.js Frontend];</div>
<div class="line">    F --&gt; G[&quot;cd frontend &amp;&amp; npm run dev&quot;];</div>
<div class="line">    E --&gt; H[Backend running on port 8000];</div>
<div class="line">    G --&gt; I[Frontend running on port 3000];</div>
</div><!-- fragment --><p>Sources: [README.md:35-42](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:129-137](), [run-dev.sh](), [run-dev.bat]()</p>
<h4><a class="anchor" id="autotoc_md1041"></a>
Manual Setup</h4>
<p>You can also start the servers manually in two separate terminals.</p>
<ol type="1">
<li><p class="startli"><b>Start the FastAPI Backend (Terminal 1):</b> Ensure your Python virtual environment is activated.</p>
<p class="startli"><code>bash python -m uvicorn <a class="el" href="namespaceapi_1_1main.html">api.main</a>:app --reload --port 8000 </code></p>
<p class="startli">The API and its auto-generated documentation will be available at <code><a href="http://localhost:8000">http://localhost:8000</a></code> and <code><a href="http://localhost:8000/docs">http://localhost:8000/docs</a></code> respectively.</p>
</li>
<li><b>Start the Next.js Frontend (Terminal 2):</b> <code>bash cd frontend npm install npm run dev </code> The frontend application will be accessible at <code><a href="http://localhost:3000">http://localhost:3000</a></code>.</li>
</ol>
<p>The local development architecture for this option is shown below.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph &quot;Developer Machine&quot;</div>
<div class="line">        Frontend[&quot;Next.js (npm run dev)&lt;br&gt;Port 3000&quot;]</div>
<div class="line">        Backend[&quot;FastAPI (uvicorn)&lt;br&gt;Port 8000&quot;]</div>
<div class="line">        Frontend -- &quot;HTTP REST API&quot; --&gt; Backend</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [README.md:44-58](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:15-21](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:204-217]()</p>
<h3><a class="anchor" id="autotoc_md1042"></a>
Option 2: Gradio UI (Original)</h3>
<p>This option runs the original Python-based Gradio interface. This is useful for tasks directly related to the <code><a class="el" href="app_8py.html">app.py</a></code> logic.</p>
<ol type="1">
<li>Ensure your Python virtual environment is activated and dependencies are installed.</li>
<li>Run the application: <code>bash python <a class="el" href="app_8py.html">app.py</a> </code></li>
<li>The application will be available at <code><a href="http://localhost:7860">http://localhost:7860</a></code>.</li>
</ol>
<p>Sources: [README.md:11-33]()</p>
<h3><a class="anchor" id="autotoc_md1043"></a>
Option 3: Docker Installation (Alternative)</h3>
<p>For a containerized environment that encapsulates all dependencies, you can use Docker.</p>
<ol type="1">
<li><p class="startli"><b>Using Docker Compose (Recommended):</b> This command builds the necessary images and starts the services defined in <code>docker-compose.yml</code>.</p>
<p class="startli"><code>bash docker-compose up --build </code></p>
<p class="startli">You can also use the Makefile shortcut:</p>
<p class="startli"><code>bash make docker-compose-up </code></p>
</li>
<li><b>Using Docker Directly:</b> This method builds a single image and runs the Gradio application. <code>bash docker build -t financial-asset-db . docker run -p 7860:7860 financial-asset-db </code></li>
</ol>
<p>Sources: [README.md:62-77]()</p>
<h2><a class="anchor" id="autotoc_md1044"></a>
Development Tools and Workflow</h2>
<p>The repository is configured with a suite of tools to ensure code quality and consistency. These are managed via <code>pre-commit</code> hooks and <code>Makefile</code> commands.</p>
<h3><a class="anchor" id="autotoc_md1045"></a>
Pre-commit Hooks</h3>
<p>Pre-commit hooks automatically run checks before each commit. It is highly recommended to install them.</p>
<div class="fragment"><div class="line"># Install hooks</div>
<div class="line">pre-commit install</div>
<div class="line"> </div>
<div class="line"># Or use the Makefile</div>
<div class="line">make pre-commit</div>
</div><!-- fragment --><p>The hooks are configured in <code>.pre-commit-config.yaml</code> and run tools like <code>black</code>, <code>isort</code>, <code>flake8</code>, and <code>mypy</code>. Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:70-76](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:35-36](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:195-204]()</p>
<h3><a class="anchor" id="autotoc_md1046"></a>
Makefile Commands</h3>
<p>The <code>Makefile</code> provides shortcuts for common development tasks.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make help</code>   </td><td class="markdownTableBodyNone">Show all available commands.   </td><td class="markdownTableBodyNone"><code><a class="el" href="SUMMARY_8md.html">SUMMARY.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make install-dev</code>   </td><td class="markdownTableBodyNone">Install both production and development dependencies.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make check</code>   </td><td class="markdownTableBodyNone">Run all checks: format, lint, type-check, and test.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make format</code>   </td><td class="markdownTableBodyNone">Format code with <code>black</code> and <code>isort</code>.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make lint</code>   </td><td class="markdownTableBodyNone">Run linters (<code>flake8</code> and <code>pylint</code>).   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make type-check</code>   </td><td class="markdownTableBodyNone">Run <code>mypy</code> type checker.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make test</code>   </td><td class="markdownTableBodyNone">Run <code>pytest</code> with coverage.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>make test-fast</code>   </td><td class="markdownTableBodyNone">Run <code>pytest</code> without coverage.   </td><td class="markdownTableBodyNone"><code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>make run</code>   </td><td class="markdownTableBodyNone">Run the application (likely <code>python <a class="el" href="app_8py.html">app.py</a></code>).   </td><td class="markdownTableBodyNone"><code><a class="el" href="SUMMARY_8md.html">SUMMARY.md</a></code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:47-62](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:95-112]()</p>
<h3><a class="anchor" id="autotoc_md1047"></a>
Running Tests</h3>
<p>The project has separate test suites for the backend and frontend.</p>
<h4><a class="anchor" id="autotoc_md1048"></a>
Backend Testing (Python)</h4>
<p>Use <code>pytest</code> to run the backend tests.</p>
<div class="fragment"><div class="line"># Run all tests</div>
<div class="line">pytest</div>
<div class="line"> </div>
<div class="line"># Run with coverage</div>
<div class="line">pytest --cov=src</div>
</div><!-- fragment --><p>Makefile shortcuts are also available: <code>make test</code> or <code>make test-fast</code>. Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:173-189](), [README.md:188-196]()</p>
<h4><a class="anchor" id="autotoc_md1049"></a>
Frontend Testing (TypeScript)</h4>
<p>The frontend tests use Jest.</p>
<div class="fragment"><div class="line">cd frontend</div>
<div class="line"> </div>
<div class="line"># Run all tests</div>
<div class="line">npm test</div>
<div class="line"> </div>
<div class="line"># Run tests with coverage</div>
<div class="line">npm test -- --coverage</div>
</div><!-- fragment --><p>Sources: [README.md:198-206](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:25-31]()</p>
<h2><a class="anchor" id="autotoc_md1050"></a>
Summary</h2>
<p>The local development setup is flexible, offering a modern dual-server environment with Next.js and FastAPI, a legacy Gradio UI, and a containerized Docker option. The recommended path for most developers is the Next.js/FastAPI setup, which is easily launched using the <code>run-dev</code> scripts. The project is also equipped with a robust set of development tools, managed through <code>pre-commit</code> hooks and a <code>Makefile</code>, to streamline development and maintain high code quality.</p>
<h3><a class="anchor" id="autotoc_md1051"></a>
Docker Deployment</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/DOCKER.md">DOCKER.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SECURITY.md">SECURITY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md1052"></a>
Docker Deployment</h1>
<p>The Financial Asset Relationship Database application can be deployed and run within Docker containers, providing a consistent and isolated environment. This approach simplifies dependency management and ensures the application runs the same way regardless of the host machine. Deployment can be managed using Docker Compose for multi-container setups (including an optional database) or by building and running the application container directly with Docker.</p>
<p>While automated CI/CD workflows for publishing Docker images were removed to streamline the build process, local Docker-based deployment remains a supported and documented method for running the application.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>](), [README.md:49-62](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:83-85]()</p>
<h2><a class="anchor" id="autotoc_md1053"></a>
Quick Start</h2>
<p>There are two primary methods for launching the application with Docker.</p>
<h3><a class="anchor" id="autotoc_md1054"></a>
Using Docker Compose (Recommended)</h3>
<p>This method builds and starts the application service defined in <code>docker-compose.yml</code>.</p>
<div class="fragment"><div class="line"># Build and start the application</div>
<div class="line">docker-compose up --build</div>
</div><!-- fragment --><p>The application will be accessible at <code><a href="http://localhost:7860">http://localhost:7860</a></code>.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:6-11](), [README.md:52-54]()</p>
<h3><a class="anchor" id="autotoc_md1055"></a>
Using Docker Directly</h3>
<p>This method involves manually building the Docker image from the <code>Dockerfile</code> and then running it as a container.</p>
<div class="fragment"><div class="line"># 1. Build the image</div>
<div class="line">docker build -t financial-asset-db .</div>
<div class="line"> </div>
<div class="line"># 2. Run the container, mapping port 7860</div>
<div class="line">docker run -p 7860:7860 financial-asset-db</div>
</div><!-- fragment --><p>The application will be accessible at <code><a href="http://localhost:7860">http://localhost:7860</a></code>.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:13-20](), [README.md:56-58]()</p>
<h2><a class="anchor" id="autotoc_md1056"></a>
Deployment Architecture</h2>
<p>The Docker deployment isolates the application and its dependencies. The <code>docker-compose.yml</code> file orchestrates the services, including the main application and an optional PostgreSQL database.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:10-47](), [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:36-46]()</p>
<h3><a class="anchor" id="autotoc_md1057"></a>
Service Interaction</h3>
<p>The following diagram illustrates the services defined in the Docker Compose setup.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Docker Environment</div>
<div class="line">        App_Service[app: financial-asset-db]</div>
<div class="line">        Postgres_Service[postgres (Optional)]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    User[User] --&gt;|HTTP Request on localhost:7860| App_Service</div>
<div class="line">    App_Service --&gt;|Connects via internal network| Postgres_Service</div>
<div class="line"> </div>
<div class="line">    style App_Service fill:#d4f0fd</div>
<div class="line">    style Postgres_Service fill:#fcf3cf</div>
</div><!-- fragment --><p>This diagram shows the user accessing the <code>app</code> service, which can optionally connect to a <code>postgres</code> database service within the same Docker network.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:36-46]()</p>
<h2><a class="anchor" id="autotoc_md1058"></a>
Configuration</h2>
<h3><a class="anchor" id="autotoc_md1059"></a>
Docker Compose Services</h3>
<p>The <code>docker-compose.yml</code> file describes the services, networks, and volumes. Although the file is not present, <code><a class="el" href="DOCKER_8md.html">DOCKER.md</a></code> outlines its key components: an <code>app</code> service for the Gradio application and an optional <code>postgres</code> service for data persistence. The <code>app</code> service mounts the local <code>src/</code> directory for live development.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:24-28, 36-38]()</p>
<h3><a class="anchor" id="autotoc_md1060"></a>
Environment Variables</h3>
<p>Application behavior is configured via environment variables set in <code>docker-compose.yml</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Variable   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Default Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>GRADIO_SERVER_NAME</code>   </td><td class="markdownTableBodyLeft">The host address the Gradio server binds to. <code>0.0.0.0</code> makes it accessible externally.   </td><td class="markdownTableBodyLeft"><code>0.0.0.0</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>GRADIO_SERVER_PORT</code>   </td><td class="markdownTableBodyLeft">The port the Gradio server listens on inside the container.   </td><td class="markdownTableBodyLeft"><code>7860</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>DATABASE_URL</code>   </td><td class="markdownTableBodyLeft">The connection string for the PostgreSQL database.   </td><td class="markdownTableBodyLeft"><code>postgresql://finuser:changeme@postgres:5432/financial_assets</code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:48-53]()</p>
<h3><a class="anchor" id="autotoc_md1061"></a>
Port Mapping</h3>
<p>To avoid conflicts, the host port can be changed in <code>docker-compose.yml</code>. The following example maps host port <code>8080</code> to the container's port <code>7860</code>.</p>
<div class="fragment"><div class="line">ports:</div>
<div class="line">  - &quot;8080:7860&quot; # Use port 8080 on the host</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:100-103]()</p>
<h2><a class="anchor" id="autotoc_md1062"></a>
Dockerfile and Security</h2>
<p>The project emphasizes security in its Docker configuration, following several best practices.</p>
<p>Sources: [<a class="el" href="SECURITY_8md.html">SECURITY.md</a>:13-18, 209-229](), [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:115-118]()</p>
<h3><a class="anchor" id="autotoc_md1063"></a>
Key Security Practices</h3>
<ul>
<li><b>Non-Root User</b>: The <code>Dockerfile</code> creates and switches to a non-root user named <code>appuser</code> to reduce potential security risks.</li>
<li><b>Minimal <a class="el" href="classBase.html">Base</a> Image</b>: The image is based on <code>python:3.11-slim</code> to minimize the attack surface by excluding unnecessary packages.</li>
<li><b>No Hardcoded Secrets</b>: Secrets and passwords should be managed through environment variables or a secrets management tool, not hardcoded in the image.</li>
<li><b>Health Checks</b>: The application includes health checks that Docker can use to verify the container's status.</li>
</ul>
<p>This diagram shows the flow for checking container health.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Docker Daemon] -- Periodically runs --&gt; B{Health Check Command}</div>
<div class="line">    B -- Success --&gt; C[State: healthy]</div>
<div class="line">    B -- Failure --&gt; D[State: unhealthy]</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="SECURITY_8md.html">SECURITY.md</a>:15, 212-213](), [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:88-93, 116]()</p>
<h3><a class="anchor" id="autotoc_md1064"></a>
Multi-Stage Build (Advanced)</h3>
<p>For smaller production images, a multi-stage build is recommended. This separates the build environment from the runtime environment, ensuring the final image contains only the necessary artifacts.</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Build stage</span></div>
<div class="line">FROM python:3.11-slim as builder</div>
<div class="line">WORKDIR /<a class="code hl_namespace" href="namespaceapp.html">app</a></div>
<div class="line">COPY requirements.txt .</div>
<div class="line">RUN pip install --user --no-cache-dir -r requirements.txt</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor"># Runtime stage</span></div>
<div class="line">FROM python:3.11-slim</div>
<div class="line">WORKDIR /<a class="code hl_namespace" href="namespaceapp.html">app</a></div>
<div class="line">COPY --from=builder /root/.local /root/.local</div>
<div class="line">COPY . .</div>
<div class="line">ENV PATH=/root/.local/bin:$PATH</div>
<div class="line">CMD [<span class="stringliteral">&quot;python&quot;</span>, <span class="stringliteral">&quot;app.py&quot;</span>]</div>
<div class="ttc" id="anamespaceapp_html"><div class="ttname"><a href="namespaceapp.html">app</a></div><div class="ttdef"><b>Definition</b> app.py:1</div></div>
</div><!-- fragment --><p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:128-141]()</p>
<h2><a class="anchor" id="autotoc_md1065"></a>
Command Reference</h2>
<p>The <code><a class="el" href="DOCKER_8md.html">DOCKER.md</a></code> file provides a comprehensive list of commands for managing the application with both Docker and Docker Compose.</p>
<h3><a class="anchor" id="autotoc_md1066"></a>
Docker Commands</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker build -t financial-asset-db .</code>   </td><td class="markdownTableBodyLeft">Build the Docker image.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker run -p 7860:7860 financial-asset-db</code>   </td><td class="markdownTableBodyLeft">Run the container and map ports.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker ps</code>   </td><td class="markdownTableBodyLeft">List running containers.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker logs -f &lt;container_name&gt;</code>   </td><td class="markdownTableBodyLeft">Follow the logs of a container.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker stop &lt;container_name&gt;</code>   </td><td class="markdownTableBodyLeft">Stop a running container.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker rm &lt;container_name&gt;</code>   </td><td class="markdownTableBodyLeft">Remove a stopped container.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker rmi &lt;image_name&gt;</code>   </td><td class="markdownTableBodyLeft">Remove a Docker image.   </td></tr>
</table>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:55-86]()</p>
<h3><a class="anchor" id="autotoc_md1067"></a>
Docker Compose Commands</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker-compose up</code>   </td><td class="markdownTableBodyLeft">Start services in the foreground.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker-compose up -d</code>   </td><td class="markdownTableBodyLeft">Start services in detached (background) mode.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker-compose down</code>   </td><td class="markdownTableBodyLeft">Stop and remove containers, networks.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker-compose down -v</code>   </td><td class="markdownTableBodyLeft">Stop and remove containers, networks, and volumes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker-compose build</code>   </td><td class="markdownTableBodyLeft">Rebuild service images.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>docker-compose up --build</code>   </td><td class="markdownTableBodyLeft">Rebuild images and then start services.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docker-compose logs -f app</code>   </td><td class="markdownTableBodyLeft">Follow logs for the <code>app</code> service.   </td></tr>
</table>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>:88-113]()</p>
<h2><a class="anchor" id="autotoc_md1068"></a>
Summary</h2>
<p>Docker provides a powerful and flexible way to run the Financial Asset Relationship Database locally. Using Docker Compose is the recommended approach as it simplifies the management of the application and its optional database service. The project incorporates security best practices into its Docker setup, such as using a non-root user and minimal base images, to provide a secure runtime environment.</p>
<p>Sources: [<a class="el" href="DOCKER_8md.html">DOCKER.md</a>](), [README.md:49-62]()</p>
<h3><a class="anchor" id="autotoc_md1069"></a>
Vercel Deployment</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/vercel.json">vercel.json</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/DEPLOYMENT.md">DEPLOYMENT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/VERCEL_DEPLOYMENT_CHECKLIST.md">VERCEL_DEPLOYMENT_CHECKLIST.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/unit/test_dev_scripts.py">tests/unit/test_dev_scripts.py</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1070"></a>
Vercel Deployment</h1>
<p>This project utilizes Vercel for deploying its integrated frontend and backend components. The deployment architecture consists of a Next.js frontend application and a Python-based FastAPI backend, which runs as a Vercel Serverless Function. This setup allows for a scalable, modern web application with a powerful Python backend for data processing and API services.</p>
<p>The Vercel deployment is configured to handle both the Next.js application and the Python API within a single project, routing requests appropriately based on the URL path. This guide provides a comprehensive overview of the deployment architecture, configuration, processes, and troubleshooting steps. For more details on the overall system design, see the <a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">Architecture Overview</a>.</p>
<p>Sources: [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1071"></a>
Architecture on Vercel</h2>
<p>The application is deployed on Vercel as a monorepo containing two primary components: the Next.js frontend and the FastAPI backend. Vercel automatically handles the build and deployment of both.</p>
<ul>
<li><b>Next.js Frontend</b>: Served by Vercel's Edge Network, providing fast delivery of static assets and server-side rendered pages.</li>
<li><b>Python Backend</b>: The FastAPI application located in the <code>/api</code> directory is deployed as a Vercel Serverless Function. This function handles all API requests.</li>
</ul>
<p>The diagram below illustrates the Vercel deployment architecture.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph User</div>
<div class="line">        A[Internet Users]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Vercel Platform</div>
<div class="line">        A -- HTTPS --&gt; B{Vercel Edge Network};</div>
<div class="line">        B -- / (root) --&gt; C[Next.js Frontend];</div>
<div class="line">        B -- /api/... --&gt; D[Python Serverless Function];</div>
<div class="line"> </div>
<div class="line">        subgraph Frontend</div>
<div class="line">            C(Static Pages &amp; React Components)</div>
<div class="line">        end</div>
<div class="line"> </div>
<div class="line">        subgraph Backend</div>
<div class="line">            D(FastAPI App)</div>
<div class="line">        end</div>
<div class="line"> </div>
<div class="line">        C -.-&gt; D;</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    style C fill:#f9f,stroke:#333,stroke-width:2px</div>
<div class="line">    style D fill:#ccf,stroke:#333,stroke-width:2px</div>
</div><!-- fragment --><p>This diagram shows that user requests are routed by Vercel's Edge Network. Requests to the root path (<code>/</code>) are served by the Next.js frontend, while requests to <code>/api/...</code> are directed to the Python Serverless Function running the FastAPI application.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1072"></a>
Deployment Configuration</h2>
<p>The core of the Vercel deployment is managed by the <code>vercel.json</code> file located in the project root. This file instructs Vercel on how to build and route the different parts of the application.</p>
<p>Sources: [vercel.json](), [<a class="el" href="test__dev__scripts_8py.html">tests/unit/test_dev_scripts.py</a>:15-23]()</p>
<h3><a class="anchor" id="autotoc_md1073"></a>
<code>vercel.json</code> Structure</h3>
<p>The configuration is split into two main sections: <code>builds</code> and <code>routes</code>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  &quot;builds&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;src&quot;: &quot;api/main.py&quot;,</div>
<div class="line">      &quot;use&quot;: &quot;@vercel/python&quot;,</div>
<div class="line">      &quot;config&quot;: {</div>
<div class="line">        &quot;maxLambdaSize&quot;: &quot;50mb&quot;</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;src&quot;: &quot;frontend/package.json&quot;,</div>
<div class="line">      &quot;use&quot;: &quot;@vercel/next&quot;</div>
<div class="line">    }</div>
<div class="line">  ],</div>
<div class="line">  &quot;routes&quot;: [</div>
<div class="line">    {</div>
<div class="line">      &quot;src&quot;: &quot;/api/(.*)&quot;,</div>
<div class="line">      &quot;dest&quot;: &quot;api/main.py&quot;</div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">      &quot;src&quot;: &quot;/(.*)&quot;,</div>
<div class="line">      &quot;dest&quot;: &quot;frontend/$1&quot;</div>
<div class="line">    }</div>
<div class="line">  ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Sources: [vercel.json](), [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:126-135]()</p>
<h4><a class="anchor" id="autotoc_md1074"></a>
Builds Configuration</h4>
<p>The <code>builds</code> array defines how Vercel should compile the project source code.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft"><code>src</code>   </th><th class="markdownTableHeadLeft"><code>use</code>   </th><th class="markdownTableHeadLeft"><code>config</code>   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code><a class="el" href="api_2main_8py.html">api/main.py</a></code>   </td><td class="markdownTableBodyLeft"><code>@vercel/python</code>   </td><td class="markdownTableBodyLeft"><code>{"maxLambdaSize": "50mb"}</code>   </td><td class="markdownTableBodyLeft">Specifies that the Python API entrypoint is <code><a class="el" href="api_2main_8py.html">api/main.py</a></code> and should be built using the Vercel Python runtime. The <code>maxLambdaSize</code> is increased to 50MB to accommodate dependencies.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>frontend/package.json</code>   </td><td class="markdownTableBodyLeft"><code>@vercel/next</code>   </td><td class="markdownTableBodyLeft">N/A   </td><td class="markdownTableBodyLeft">Specifies that the <code>frontend</code> directory contains a Next.js application, identified by its <code>package.json</code> file. It will be built using the Vercel Next.js runtime.   </td></tr>
</table>
<p>Sources: [vercel.json:2-15](), [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:126-135](), [<a class="el" href="test__dev__scripts_8py.html">tests/unit/test_dev_scripts.py</a>:25-35]()</p>
<h4><a class="anchor" id="autotoc_md1075"></a>
Routes Configuration</h4>
<p>The <code>routes</code> array defines how incoming requests are routed to the built outputs.</p>
<p>The following diagram illustrates the routing logic defined in <code>vercel.json</code>.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Incoming Request] --&gt; B{Path Matching};</div>
<div class="line">    B -- &quot;/api/...&quot; --&gt; C[Route to api/main.py];</div>
<div class="line">    B -- &quot;/...&quot; --&gt; D[Route to frontend];</div>
</div><!-- fragment --><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft"><code>src</code>   </th><th class="markdownTableHeadLeft"><code>dest</code>   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>/api/(.*)</code>   </td><td class="markdownTableBodyLeft"><code><a class="el" href="api_2main_8py.html">api/main.py</a></code>   </td><td class="markdownTableBodyLeft">Any request path starting with <code>/api/</code> is rewritten and handled by the Python serverless function defined in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>/(.*)</code>   </td><td class="markdownTableBodyLeft"><code>frontend/$1</code>   </td><td class="markdownTableBodyLeft">All other requests are routed to the Next.js application in the <code>frontend</code> directory.   </td></tr>
</table>
<p>Sources: [vercel.json:16-26](), [<a class="el" href="test__dev__scripts_8py.html">tests/unit/test_dev_scripts.py</a>:37-45]()</p>
<h2><a class="anchor" id="autotoc_md1076"></a>
Deployment Process</h2>
<p>There are two recommended methods for deploying the application to Vercel: GitHub Integration and the Vercel CLI.</p>
<p>Sources: [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>:63-84](), [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:43-108]()</p>
<h3><a class="anchor" id="autotoc_md1077"></a>
GitHub Integration (Recommended)</h3>
<p>This method provides continuous deployment, automatically deploying changes pushed to the repository.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Dev as Developer</div>
<div class="line">    participant GitHub</div>
<div class="line">    participant Vercel</div>
<div class="line"> </div>
<div class="line">    Dev-&gt;&gt;GitHub: git push origin main</div>
<div class="line">    activate GitHub</div>
<div class="line">    GitHub-&gt;&gt;Vercel: Webhook: Code pushed</div>
<div class="line">    deactivate GitHub</div>
<div class="line">    activate Vercel</div>
<div class="line">    Vercel--&gt;&gt;Vercel: Auto-detects Next.js &amp; Python</div>
<div class="line">    Vercel--&gt;&gt;Vercel: Runs builds based on vercel.json</div>
<div class="line">    Vercel--&gt;&gt;Vercel: Deploys to production URL</div>
<div class="line">    deactivate Vercel</div>
</div><!-- fragment --><p><b>Steps:</b></p>
<ol type="1">
<li><b>Push to GitHub</b>: Ensure all code is committed and pushed to the <code>main</code> branch.</li>
<li><b>Connect to Vercel</b>: In the Vercel dashboard, create a "New Project" and import the GitHub repository.</li>
<li><b>Configure Project</b>: Vercel will auto-detect the Next.js framework. The root directory should be left as the default.</li>
<li><b>Set Environment Variables</b>: Add <code>NEXT_PUBLIC_API_URL</code> in the project settings.</li>
<li><b>Deploy</b>: Click "Deploy". Vercel will build and deploy the application.</li>
</ol>
<p>Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:43-78](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>:72-84]()</p>
<h3><a class="anchor" id="autotoc_md1078"></a>
Vercel CLI</h3>
<p>This method is useful for manual deployments from your local machine.</p>
<ol type="1">
<li><b>Install Vercel CLI</b>: <code>bash npm install -g vercel </code></li>
<li><b>Login</b>: <code>bash vercel login </code></li>
<li><b>Deploy</b>: From the project root, run the deployment command and follow the prompts. <code>bash @section autotoc_md1079 Deploy to production vercel --prod </code> Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:80-108](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>:63-70]()</li>
</ol>
<h2><a class="anchor" id="autotoc_md1080"></a>
Environment Variables</h2>
<p>The frontend requires an environment variable to know the URL of the backend API.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Variable   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Example Value (Production)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>NEXT_PUBLIC_API_URL</code>   </td><td class="markdownTableBodyLeft">The absolute URL of the deployed backend API. The <code>NEXT_PUBLIC_</code> prefix makes it available in the browser.   </td><td class="markdownTableBodyLeft"><code><a href="https://your-project.vercel.app">https://your-project.vercel.app</a></code>   </td></tr>
</table>
<p>This variable must be set in the Vercel project settings under "Environment Variables". After the first deployment, you must update this variable with the actual Vercel project URL and redeploy if necessary.</p>
<p>Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:63-78, 100-103, 149-155](), [<a class="el" href="DEPLOYMENT_8md.html">DEPLOYMENT.md</a>:120-126]()</p>
<h2><a class="anchor" id="autotoc_md1081"></a>
Post-Deployment and Troubleshooting</h2>
<p>After each deployment, it is crucial to verify that the application is functioning correctly. A checklist is provided for this purpose.</p>
<h3><a class="anchor" id="autotoc_md1082"></a>
Verification Checklist</h3>
<ul class="check">
<li class="unchecked">Open the deployed URL and check that the frontend loads without errors.</li>
</ul>
<ul class="check">
<li class="unchecked">Verify the API health by visiting <code><a href="https://your-project.vercel.app/api/health">https://your-project.vercel.app/api/health</a></code>.</li>
</ul>
<ul class="check">
<li class="unchecked">Test the interactive API documentation at <code><a href="https://your-project.vercel.app/docs">https://your-project.vercel.app/docs</a></code>.</li>
</ul>
<ul class="check">
<li class="unchecked">Test all major features: 3D visualization, metrics, and the asset explorer.</li>
</ul>
<ul class="check">
<li class="unchecked">Check the browser console for any CORS or JavaScript errors.</li>
</ul>
<p>Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:110-124]()</p>
<h3><a class="anchor" id="autotoc_md1083"></a>
Common Issues and Solutions</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Issue   </th><th class="markdownTableHeadLeft">Solution    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>Build Failed</b>   </td><td class="markdownTableBodyLeft">Check build logs in the Vercel dashboard. Verify all dependencies are listed in <code>requirements.txt</code> and <code>frontend/package.json</code>. Run the build locally (<code>cd frontend &amp;&amp; npm run build</code>) to debug.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>API Not Found (404)</b>   </td><td class="markdownTableBodyLeft">Ensure <code>vercel.json</code> is in the project root and correctly configured. Verify that <code><a class="el" href="api_2main_8py.html">api/main.py</a></code> exists and is the correct entry point.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><b>CORS Errors</b>   </td><td class="markdownTableBodyLeft">The FastAPI backend must be configured to allow origins from your Vercel domain. Update the <code>allow_origins</code> list in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><b>Lambda Size Exceeded</b>   </td><td class="markdownTableBodyLeft">The Python serverless function has a size limit. This is pre-configured to <code>50mb</code> in <code>vercel.json</code>. If this error occurs, remove unused dependencies or consider lighter alternatives.   </td></tr>
</table>
<p>Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:137-183]()</p>
<p>A code snippet for configuring CORS in <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>:</p>
<div class="fragment"><div class="line"><span class="comment"># In api/main.py</span></div>
<div class="line">app.add_middleware(</div>
<div class="line">    CORSMiddleware,</div>
<div class="line">    allow_origins=[<span class="stringliteral">&quot;https://*.vercel.app&quot;</span>, <span class="stringliteral">&quot;https://your-domain.com&quot;</span>],</div>
<div class="line">    allow_credentials=<span class="keyword">True</span>,</div>
<div class="line">    allow_methods=[<span class="stringliteral">&quot;*&quot;</span>],</div>
<div class="line">    allow_headers=[<span class="stringliteral">&quot;*&quot;</span>],</div>
<div class="line">)</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="VERCEL__DEPLOYMENT__CHECKLIST_8md.html">VERCEL_DEPLOYMENT_CHECKLIST.md</a>:160-168]()</p>
<h3><a class="anchor" id="autotoc_md1084"></a>
Configuration</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/pyproject.toml">pyproject.toml</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/api/main.py">api/main.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/next.config.js">frontend/next.config.js</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/Makefile">Makefile</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/package.json">frontend/package.json</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/.pre-commit-config.yaml">.pre-commit-config.yaml</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/.flake8">.flake8</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/requirements-dev.txt">requirements-dev.txt</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md1085"></a>
Configuration</h1>
<p>Configuration for the <code>financial-asset-relationship-db</code> project is managed through a combination of files that define the development environment, tool settings, application behavior, and deployment processes. The project uses a monorepo-like structure with distinct configurations for the Python backend and the Next.js frontend, unified by top-level tooling and scripts.</p>
<p>Key configuration files like <code>pyproject.toml</code>, <code>Makefile</code>, and <code>package.json</code> orchestrate a suite of development tools for testing, linting, and formatting, ensuring code quality and consistency. Application-level settings, such as API CORS policies and frontend build options, are handled within their respective codebases.</p>
<h2><a class="anchor" id="autotoc_md1086"></a>
Project-Level Configuration</h2>
<p>Project-level configuration centralizes development tooling and provides a consistent interface for developers through <code>Makefile</code> commands.</p>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md1087"></a>
Development Tooling (<code>pyproject.toml</code>)</h3>
<p>The <code>pyproject.toml</code> file is the central configuration hub for Python development tools, standardizing settings for testing, formatting, and static analysis.</p>
<p>The diagram below shows the tools configured in <code>pyproject.toml</code>.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    A[pyproject.toml] --&gt; B[pytest]</div>
<div class="line">    A --&gt; C[coverage]</div>
<div class="line">    A --&gt; D[black]</div>
<div class="line">    A --&gt; E[isort]</div>
<div class="line">    A --&gt; F[mypy]</div>
<div class="line">    A --&gt; G[pylint]</div>
<div class="line"> </div>
<div class="line">    subgraph Testing</div>
<div class="line">        B</div>
<div class="line">        C</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Formatting</div>
<div class="line">        D</div>
<div class="line">        E</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Static Analysis</div>
<div class="line">        F</div>
<div class="line">        G</div>
<div class="line">    end</div>
</div><!-- fragment --><p>Sources: [pyproject.toml](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:83-90]()</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Tool   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Key Configurations    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>pytest</code>   </td><td class="markdownTableBodyNone">Test runner   </td><td class="markdownTableBodyNone">Verbose output, test markers (<code>unit</code>, <code>integration</code>, <code>slow</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>coverage</code>   </td><td class="markdownTableBodyNone">Code coverage   </td><td class="markdownTableBodyNone">Generates HTML and XML reports, sets a failure threshold of 80%.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>black</code>   </td><td class="markdownTableBodyNone">Code formatter   </td><td class="markdownTableBodyNone">Line length set to 120, targets Python 3.8+.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>isort</code>   </td><td class="markdownTableBodyNone">Import sorter   </td><td class="markdownTableBodyNone">Uses a <code>black</code>-compatible profile.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>mypy</code>   </td><td class="markdownTableBodyNone">Static type checker   </td><td class="markdownTableBodyNone">Checks untyped definitions, warns on return issues.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pylint</code>   </td><td class="markdownTableBodyNone">Linter   </td><td class="markdownTableBodyNone">Fails on a score below 8.0, ignores docstring warnings.   </td></tr>
</table>
<p>Sources: [pyproject.toml](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:83-90](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:121-127]()</p>
<h3><a class="anchor" id="autotoc_md1088"></a>
Linter Configuration (<code>.flake8</code>)</h3>
<p>While most tools are configured in <code>pyproject.toml</code>, <code>flake8</code> uses a dedicated <code>.flake8</code> file.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Option   </th><th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>max-line-length</code>   </td><td class="markdownTableBodyNone">120   </td><td class="markdownTableBodyNone">Sets the maximum line length to 120 characters.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>max-complexity</code>   </td><td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone">Sets the maximum cyclomatic complexity for functions.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>ignore</code>   </td><td class="markdownTableBodyNone">E203, E501, W503   </td><td class="markdownTableBodyNone">Ignores specific error codes that conflict with <code>black</code>.   </td></tr>
</table>
<p>Sources: [.flake8](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:84](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:129-134]()</p>
<h3><a class="anchor" id="autotoc_md1089"></a>
Development Commands (<code>Makefile</code>)</h3>
<p>The <code>Makefile</code> provides a set of shortcut commands to simplify common development tasks, orchestrating the configured tools.</p>
<p>This diagram illustrates the workflow of the <code>make check</code> command.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    Start(make check) --&gt; Format{make format-check}</div>
<div class="line">    Format --&gt; Lint{make lint}</div>
<div class="line">    Lint --&gt; TypeCheck{make type-check}</div>
<div class="line">    TypeCheck --&gt; Test{make test}</div>
<div class="line">    Test --&gt; End(All Checks Pass)</div>
<div class="line"> </div>
<div class="line">    Format -- Fails --&gt; Stop_Format(Stop &amp; Report Error)</div>
<div class="line">    Lint -- Fails --&gt; Stop_Lint(Stop &amp; Report Error)</div>
<div class="line">    TypeCheck -- Fails --&gt; Stop_Type(Stop &amp; Report Error)</div>
<div class="line">    Test -- Fails --&gt; Stop_Test(Stop &amp; Report Error)</div>
</div><!-- fragment --><p>Sources: [Makefile:54-55](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:65-79]()</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>install-dev</code>   </td><td class="markdownTableBodyNone">Installs both production and development dependencies.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>pre-commit</code>   </td><td class="markdownTableBodyNone">Installs pre-commit hooks.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>format</code>   </td><td class="markdownTableBodyNone">Formats code using <code>black</code> and <code>isort</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>lint</code>   </td><td class="markdownTableBodyNone">Runs linters (<code>flake8</code> and <code>pylint</code>).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>type-check</code>   </td><td class="markdownTableBodyNone">Runs <code>mypy</code> for static type analysis.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>test</code>   </td><td class="markdownTableBodyNone">Runs <code>pytest</code> with code coverage.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>check</code>   </td><td class="markdownTableBodyNone">Runs all checks: format check, lint, type-check, and test.   </td></tr>
</table>
<p>Sources: [Makefile](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:73-90]()</p>
<h3><a class="anchor" id="autotoc_md1090"></a>
Pre-commit Hooks</h3>
<p>The <code>.pre-commit-config.yaml</code> file configures hooks that run automatically before each commit to ensure code quality.</p>
<p>The sequence diagram below shows the pre-commit process.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Dev as Developer</div>
<div class="line">    participant Git as Git Client</div>
<div class="line">    participant Hooks as Pre-commit Hooks</div>
<div class="line"> </div>
<div class="line">    Dev-&gt;&gt;Git: git commit -m &quot;...&quot;</div>
<div class="line">    Git-&gt;&gt;Hooks: Execute hooks on staged files</div>
<div class="line">    activate Hooks</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run trailing-whitespace</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run end-of-file-fixer</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run check-yaml</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run black (formatter)</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run isort (importer sorter)</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run flake8 (linter)</div>
<div class="line">    Hooks-&gt;&gt;Hooks: Run mypy (type checker)</div>
<div class="line">    alt All hooks pass</div>
<div class="line">        Hooks--&gt;&gt;Git: Success</div>
<div class="line">        Git--&gt;&gt;Dev: Commit successful</div>
<div class="line">    else At least one hook fails</div>
<div class="line">        Hooks--xGit: Failure</div>
<div class="line">        Git--xDev: Commit failed, fix errors</div>
<div class="line">    end</div>
<div class="line">    deactivate Hooks</div>
</div><!-- fragment --><p>Sources: [.pre-commit-config.yaml](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:154-164]()</p>
<h2><a class="anchor" id="autotoc_md1091"></a>
Backend API Configuration (<code>api/main.py</code>)</h2>
<p>The FastAPI server configuration is defined directly within <code><a class="el" href="api_2main_8py.html">api/main.py</a></code>.</p>
<h3><a class="anchor" id="autotoc_md1092"></a>
CORS Middleware</h3>
<p>The API uses <code>CORSMiddleware</code> to control cross-origin requests from the frontend.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Configuration   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>allow_origins</code>   </td><td class="markdownTableBodyNone">A list of allowed origins, including localhost for development and Vercel deployment URLs.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>allow_credentials</code>   </td><td class="markdownTableBodyNone"><code>True</code>, allows cookies to be included in cross-origin requests.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>allow_methods</code>   </td><td class="markdownTableBodyNone"><code>["*"]</code>, allows all standard HTTP methods.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>allow_headers</code>   </td><td class="markdownTableBodyNone"><code>["*"]</code>, allows all request headers.   </td></tr>
</table>
<p>The allowed origins are dynamically generated based on the <code>VERCEL_URL</code> environment variable for production/preview deployments on Vercel, with localhost ports for local development.</p>
<p>Sources: [<a class="el" href="api_2main_8py.html">api/main.py</a>:27-49]()</p>
<h3><a class="anchor" id="autotoc_md1093"></a>
Application Startup</h3>
<p>The FastAPI application is launched using Uvicorn. The recommended command for development starts the server with auto-reloading on port 8000.</p>
<div class="fragment"><div class="line">python -m uvicorn api.main:app --reload --port 8000</div>
</div><!-- fragment --><p>Sources: [README.md:52](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:43]()</p>
<h2><a class="anchor" id="autotoc_md1094"></a>
Frontend Configuration</h2>
<p>The Next.js frontend configuration is split between <code>package.json</code> for scripts and dependencies, and <code>next.config.js</code> for framework-specific settings.</p>
<h3><a class="anchor" id="autotoc_md1095"></a>
Scripts (<code>frontend/package.json</code>)</h3>
<p>The <code>scripts</code> section in <code>package.json</code> defines commands for building, running, and testing the frontend application.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Script   </th><th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>dev</code>   </td><td class="markdownTableBodyNone"><code>next dev</code>   </td><td class="markdownTableBodyNone">Starts the Next.js development server.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>build</code>   </td><td class="markdownTableBodyNone"><code>next build</code>   </td><td class="markdownTableBodyNone">Creates an optimized production build.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>start</code>   </td><td class="markdownTableBodyNone"><code>next start</code>   </td><td class="markdownTableBodyNone">Starts a production server.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>lint</code>   </td><td class="markdownTableBodyNone"><code>next lint</code>   </td><td class="markdownTableBodyNone">Runs the Next.js linter (ESLint).    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>test</code>   </td><td class="markdownTableBodyNone"><code>jest --silent</code>   </td><td class="markdownTableBodyNone">Runs Jest tests.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>test:coverage</code>   </td><td class="markdownTableBodyNone"><code>jest --coverage --silent</code>   </td><td class="markdownTableBodyNone">Runs Jest tests and generates a coverage report.   </td></tr>
</table>
<p>Sources: [frontend/package.json](), [frontend/**tests**/config/package-validation.test.ts:90-128]()</p>
<h3><a class="anchor" id="autotoc_md1096"></a>
Next.js Build (<code>frontend/next.config.js</code>)</h3>
<p>The <code>next.config.js</code> file contains settings for the Next.js build process. The current configuration is minimal, enabling React's Strict Mode.</p>
<div class="fragment"><div class="line">/** @type {import(&#39;next&#39;).NextConfig} */</div>
<div class="line">const nextConfig = {</div>
<div class="line">  reactStrictMode: true,</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">module.exports = nextConfig;</div>
</div><!-- fragment --><p>This setting helps identify potential problems in the application by running effects and checks twice in development mode.</p>
<p>Sources: [frontend/next.config.js:1-6]()</p>
<h3><a class="anchor" id="autotoc_md1097"></a>
Environment Variables</h3>
<p>The frontend relies on an environment variable to locate the backend API.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Variable   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Example    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>NEXT_PUBLIC_API_URL</code>   </td><td class="markdownTableBodyNone">The base URL for the FastAPI backend.   </td><td class="markdownTableBodyNone"><code><a href="http://localhost:8000">http://localhost:8000</a></code>   </td></tr>
</table>
<p>This is configured in a <code>.env.local</code> file in the <code>frontend</code> directory, based on the <code>.env.example</code> template in the project root.</p>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:200-203](), [<a class="el" href="QUICK__START_8md.html">QUICK_START.md</a>:49-51]()</p>
<h2><a class="anchor" id="autotoc_md1098"></a>
Deployment Configuration (<code>vercel.json</code>)</h2>
<p>Deployment to Vercel is configured via <code>vercel.json</code>. This file defines how the project is built and how incoming requests are routed to either the Next.js frontend or the Python API.</p>
<p>The diagram below shows Vercel's request routing.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Vercel Platform</div>
<div class="line">        A[Incoming Request] --&gt; B{Request Path}</div>
<div class="line">        B -- /api/* --&gt; C[Python/FastAPI Backend]</div>
<div class="line">        B -- else --&gt; D[Next.js Frontend]</div>
<div class="line">    end</div>
</div><!-- fragment --><p>This configuration ensures that API calls are correctly forwarded to the serverless Python function, while all other paths are handled by the Next.js application.</p>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:104-108](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:65-68]()</p>
<h2><a class="anchor" id="autotoc_md1099"></a>
Extensibility and Customization</h2>
<h3><a class="anchor" id="autotoc_md1100"></a>
How-To: Add a New Asset Type</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/models/financial_models.py">src/models/financial_models.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/data/sample_data.py">src/data/sample_data.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/ARCHITECTURE.md">ARCHITECTURE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/INTEGRATION_SUMMARY.md">INTEGRATION_SUMMARY.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1101"></a>
How-To: Add a New Asset Type</h1>
<p>This guide provides a step-by-step process for extending the financial asset relationship database with a new asset type. The system is designed to be extensible, allowing developers to incorporate new financial instruments beyond the core classes of Equities, Bonds, Commodities, and Currencies.</p>
<p>Adding a new asset type primarily involves defining its data structure, adding it to the system's enumeration of asset classes, and implementing the logic that governs its relationships with other assets. Following these steps will ensure the new asset is properly integrated into the graph visualization, metrics calculation, and API responses.</p>
<p>Sources: [README.md](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1102"></a>
Process Overview</h2>
<p>The overall process for adding a new asset type involves modifications to the data, logic, and potentially the presentation layers.</p>
<p>This flowchart shows the high-level workflow for integrating a new asset type.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Step 1: Extend Data Model&lt;br/&gt;Create new dataclass] --&gt; B[Step 2: Update AssetClass Enum&lt;br/&gt;Add new type to enum]</div>
<div class="line">    B --&gt; C[Step 3: Add Sample Data&lt;br/&gt;(Optional) Create sample instances]</div>
<div class="line">    C --&gt; D[Step 4: Define Relationship Rules&lt;br/&gt;Update AssetRelationshipGraph]</div>
<div class="line">    D --&gt; E[Step 5: Update Frontend&lt;br/&gt;(If needed) Modify types and components]</div>
<div class="line">    E --&gt; F[Step 6: Add Tests&lt;br/&gt;Unit and integration tests]</div>
</div><!-- fragment --><p>Sources: [README.md:112-122](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:195-203]()</p>
<h2><a class="anchor" id="autotoc_md1103"></a>
Step 1: Extend the Data Model</h2>
<p>The first step is to define the data structure for the new asset. All asset types are Python dataclasses that inherit from the base <code>Asset</code> class defined in <code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code>.</p>
<p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:14](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:201]()</p>
<h3><a class="anchor" id="autotoc_md1104"></a>
Create a New Dataclass</h3>
<p>Create a new Python file or add to the existing <code><a class="el" href="financial__models_8py.html">financial_models.py</a></code> a new dataclass that inherits from <code>Asset</code>. This new class should include fields specific to the new asset type. The project standard is to use Python's <code>dataclasses</code> module for all structured data objects.</p>
<p>For example, to add a <code>Derivative</code> asset type:</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> src.models.financial_models <span class="keyword">import</span> Asset, AssetClass</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">@dataclass</span></div>
<div class="line"><span class="keyword">class </span>Derivative(Asset):</div>
<div class="line">    underlying_asset: str</div>
<div class="line">    expiration_date: str</div>
<div class="line">    strike_price: Optional[float] = <span class="keywordtype">None</span></div>
</div><!-- fragment --><p>Sources: [README.md:112-118](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:37-38]()</p>
<p>The base <code>Asset</code> class provides a set of common fields that all asset types must have.</p>
<p>This class diagram illustrates how a new <code>Derivative</code> class inherits from the base <code>Asset</code> class, alongside other existing asset types.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class Asset {</div>
<div class="line">        +str id</div>
<div class="line">        +str symbol</div>
<div class="line">        +str name</div>
<div class="line">        +AssetClass asset_class</div>
<div class="line">        +str sector</div>
<div class="line">        +str currency</div>
<div class="line">        +float price</div>
<div class="line">        +dict additional_fields</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +float pe_ratio</div>
<div class="line">        +float dividend_yield</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +float yield</div>
<div class="line">        +float duration</div>
<div class="line">    }</div>
<div class="line">    class Derivative {</div>
<div class="line">        +str underlying_asset</div>
<div class="line">        +str expiration_date</div>
<div class="line">        +float strike_price</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Derivative</div>
</div><!-- fragment --><p>Sources: [README.md:112-118](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md1105"></a>
Step 2: Update the <code>AssetClass</code> Enum</h2>
<p>The <code>AssetClass</code> enumeration in <code><a class="el" href="financial__models_8py.html">src/models/financial_models.py</a></code> is used to categorize and identify different types of assets throughout the application. You must add your new asset type to this enum.</p>
<div class="fragment"><div class="line"><span class="comment"># In src/models/financial_models.py</span></div>
<div class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>AssetClass(<a class="code hl_class" href="classEnum.html">Enum</a>):</div>
<div class="line">    EQUITY = <span class="stringliteral">&quot;Equity&quot;</span></div>
<div class="line">    BOND = <span class="stringliteral">&quot;Fixed Income&quot;</span></div>
<div class="line">    COMMODITY = <span class="stringliteral">&quot;Commodity&quot;</span></div>
<div class="line">    CURRENCY = <span class="stringliteral">&quot;Currency&quot;</span></div>
<div class="line">    REGULATORY_EVENT = <span class="stringliteral">&quot;Regulatory Event&quot;</span></div>
<div class="line">    DERIVATIVE = <span class="stringliteral">&quot;Derivative&quot;</span> <span class="comment"># Add the new type here</span></div>
<div class="ttc" id="aclassEnum_html"><div class="ttname"><a href="classEnum.html">Enum</a></div></div>
</div><!-- fragment --><p>Sources: [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:39-40](), [<a class="el" href="financial__models_8py.html">src/models/financial_models.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md1106"></a>
Step 3: Add Sample Data (Optional)</h2>
<p>To test and visualize the new asset type, it is recommended to add sample instances to <code><a class="el" href="sample__data_8py.html">src/data/sample_data.py</a></code>. This file is responsible for creating the initial dataset used in the application.</p>
<p>You would instantiate your new dataclass and add it to the list of assets that are loaded into the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>.</p>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:202](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:79-85]()</p>
<h2><a class="anchor" id="autotoc_md1107"></a>
Step 4: Define New Relationship Rules</h2>
<p>The core of the system is the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> in <code><a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a></code>, which automatically discovers relationships between assets. To make the system aware of how your new asset type interacts with others, you must update the <code>_find_relationships</code> method within this class.</p>
<p>This method iterates through pairs of assets and appends relationship tuples <code>(type, strength, is_bidirectional)</code> based on custom logic.</p>
<p>The following flowchart shows the logic inside the <code>_find_relationships</code> method.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    start[Start _find_relationships] --&gt; loop{For each pair of assets (asset1, asset2)}</div>
<div class="line">    loop --&gt; check_type{Check asset types}</div>
<div class="line">    check_type --&gt; rule1{Is asset1 a Derivative and asset2 an Equity?}</div>
<div class="line">    rule1 -- Yes --&gt; check_underlying{Is asset1.underlying_asset == asset2.symbol?}</div>
<div class="line">    check_underlying -- Yes --&gt; add_rel[Add (&quot;derivative_underlying&quot;, 0.95, False)]</div>
<div class="line">    add_rel --&gt; loop</div>
<div class="line">    check_underlying -- No --&gt; loop</div>
<div class="line">    rule1 -- No --&gt; other_rules(...)</div>
<div class="line">    other_rules --&gt; loop</div>
<div class="line">    loop --&gt; finish[End]</div>
</div><!-- fragment --><p>Sources: [README.md:120-122](), [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:46-53]()</p>
<p>Add a new conditional block to implement the logic for your new asset type. For example, to link a <code>Derivative</code> to its underlying <code>Equity</code>:</p>
<div class="fragment"><div class="line"><span class="comment"># Add to _find_relationships() in AssetRelationshipGraph</span></div>
<div class="line"><span class="keywordflow">if</span> isinstance(asset1, Derivative) <span class="keywordflow">and</span> isinstance(asset2, Equity):</div>
<div class="line">    <span class="keywordflow">if</span> asset1.underlying_asset == asset2.symbol:</div>
<div class="line">        relationships.append((<span class="stringliteral">&quot;derivative_underlying&quot;</span>, 0.95, <span class="keyword">False</span>))</div>
</div><!-- fragment --><p>Sources: [README.md:120-122]()</p>
<h2><a class="anchor" id="autotoc_md1108"></a>
Step 5: Update the Frontend (If Applicable)</h2>
<p>If the new asset type has unique fields that need to be displayed in the user interface, you may need to update the frontend code. The project has a Next.js frontend that communicates with a FastAPI backend.</p>
<p>Key files to update include:</p>
<ul>
<li><b><code>frontend/app/types/api.ts</code></b>: Add the new asset type and its specific fields to the TypeScript interfaces to ensure type safety.</li>
<li><b><code>frontend/app/components/AssetList.tsx</code></b>: Modify the component to display the new fields in the asset explorer table.</li>
<li><b><code><a class="el" href="api_2main_8py.html">api/main.py</a></code></b>: Ensure the FastAPI endpoint serializes the new asset's fields correctly.</li>
</ul>
<p>Sources: [<a class="el" href="INTEGRATION__SUMMARY_8md.html">INTEGRATION_SUMMARY.md</a>:41-58](), [<a class="el" href="frontend_2README_8md.html">frontend/README.md</a>:41-51]()</p>
<h2><a class="anchor" id="autotoc_md1109"></a>
Step 6: Add Tests</h2>
<p>Finally, it is crucial to add tests for the new functionality. The project uses <code>pytest</code> for backend testing.</p>
<ul>
<li><b>Unit Tests</b>: Add tests to <code>tests/unit/test_models.py</code> to validate the new dataclass, including any custom validation in <code>__post_init__</code>.</li>
<li><b>Integration Tests</b>: Add tests to <code>tests/unit/test_graph.py</code> to verify that the new relationship rules are correctly identified and that metrics are calculated properly with the new asset type included.</li>
</ul>
<p>Follow the guidelines in <code><a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a></code> for writing and running tests. New features must be accompanied by tests.</p>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:129-170](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:111-128]()</p>
<h2><a class="anchor" id="autotoc_md1110"></a>
Summary</h2>
<p>Adding a new asset type is a structured process that touches multiple layers of the application architecture. By extending the data model, updating enums, defining relationship logic, and adding tests, you can seamlessly integrate new financial instruments into the system. This modular design is a core strength of the <code>financial-asset-relationship-db</code> project, enabling it to evolve and support a wider range of financial analysis scenarios.</p>
<p>Sources: [<a class="el" href="ARCHITECTURE_8md.html">ARCHITECTURE.md</a>:173-182](), [README.md:109-110]()</p>
<h3><a class="anchor" id="autotoc_md1111"></a>
How-To: Create Custom Relationship Rules</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p><ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/src/logic/asset_graph.py">src/logic/asset_graph.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AI_RULES.md">AI_RULES.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/IMPROVEMENTS.md">IMPROVEMENTS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1112"></a>
How-To: Create Custom Relationship Rules</h1>
<p>The financial asset relationship database is designed to automatically discover connections between different financial assets. This guide explains how developers can extend the system by defining and implementing custom relationship rules. The core of this functionality resides in the <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class, which processes assets and identifies relationships based on a predefined set of rules.</p>
<p>Creating a custom rule involves defining the conditions under which two assets are considered related, the type of relationship, and its relative strength. This process typically requires modifying the core relationship discovery engine and may involve extending the existing data models to support new asset types or attributes.</p>
<p>Sources: [README.md:82-85](), [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md1113"></a>
Understanding Core Components</h2>
<p>Before creating a new rule, it's essential to understand the primary components that govern asset relationships.</p>
<p>Sources: [README.md:65-76](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:31-34]()</p>
<h3><a class="anchor" id="autotoc_md1114"></a>
Asset Data Models</h3>
<p>All assets in the system are defined using Python <code>dataclasses</code>. There is a base <code>Asset</code> class, and specific asset types like <code>Equity</code>, <code>Bond</code>, and <code>Commodity</code> inherit from it. To create rules for a new type of asset, you must first define its model.</p>
<p>The diagram below shows the inheritance structure of the core financial models.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class Asset {</div>
<div class="line">        +id: str</div>
<div class="line">        +symbol: str</div>
<div class="line">        +name: str</div>
<div class="line">        +asset_class: AssetClass</div>
<div class="line">        +price: float</div>
<div class="line">    }</div>
<div class="line">    class Equity {</div>
<div class="line">        +sector: str</div>
<div class="line">        +market_cap: float</div>
<div class="line">    }</div>
<div class="line">    class Bond {</div>
<div class="line">        +issuer: str</div>
<div class="line">        +credit_rating: str</div>
<div class="line">    }</div>
<div class="line">    class Commodity {</div>
<div class="line">        +unit: str</div>
<div class="line">    }</div>
<div class="line">    class Currency {</div>
<div class="line">        +country: str</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    Asset &lt;|-- Equity</div>
<div class="line">    Asset &lt;|-- Bond</div>
<div class="line">    Asset &lt;|-- Commodity</div>
<div class="line">    Asset &lt;|-- Currency</div>
</div><!-- fragment --><p>This class diagram illustrates the inheritance hierarchy for financial asset models.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:21-25](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:31-34]()</p>
<h3><a class="anchor" id="autotoc_md1115"></a>
The Relationship Discovery Engine</h3>
<p>The <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> class is the engine for relationship management. The automatic discovery process is handled by the <code>build_relationships()</code> method, which in turn calls the private <code>_find_relationships()</code> method. This is the primary location for adding custom rule logic.</p>
<p>The <code>_find_relationships()</code> method iterates through all possible pairs of assets in the graph and applies a series of conditional checks to identify relationships.</p>
<p>The following sequence diagram shows the high-level flow when discovering relationships.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant App as &quot;Application&quot;</div>
<div class="line">    participant Graph as &quot;AssetRelationshipGraph&quot;</div>
<div class="line">    App-&gt;&gt;Graph: build_relationships()</div>
<div class="line">    activate Graph</div>
<div class="line">    Graph-&gt;&gt;Graph: _find_relationships()</div>
<div class="line">    Note over Graph: Iterates through all asset pairs</div>
<div class="line">    Graph-&gt;&gt;Graph: add_relationship(source, target, type, strength)</div>
<div class="line">    deactivate Graph</div>
<div class="line">    App--&gt;&gt;App: Relationships built</div>
</div><!-- fragment --><p>This diagram shows the method calls involved in the automatic relationship discovery process.</p>
<p>Sources: [README.md:85](), [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md1116"></a>
Step-by-Step Guide to Creating a Custom Rule</h2>
<p>Follow these steps to add a new relationship rule to the system.</p>
<h3><a class="anchor" id="autotoc_md1117"></a>
1. Define or Extend Asset Models (If Necessary)</h3>
<p>If your new rule involves a new type of financial instrument, you must first define it as a <code>dataclass</code> that inherits from <code>Asset</code>. The project standards mandate the use of <code>dataclasses</code> for all structured data objects.</p>
<p>For example, to add a rule for derivatives, you would first define a <code>Derivative</code> class.</p>
<div class="fragment"><div class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</div>
<div class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Optional</div>
<div class="line"><span class="keyword">from</span> src.models.financial_models <span class="keyword">import</span> Asset, AssetClass</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">@dataclass</span></div>
<div class="line"><span class="keyword">class </span>Derivative(Asset):</div>
<div class="line">    underlying_asset: str</div>
<div class="line">    expiration_date: str</div>
<div class="line">    strike_price: Optional[float] = <span class="keywordtype">None</span></div>
</div><!-- fragment --><p><em>Source: [README.md:88-96]()</em></p>
<p>Sources: [README.md:88-96](), [<a class="el" href="AI__RULES_8md.html">AI_RULES.md</a>:31-34]()</p>
<h3><a class="anchor" id="autotoc_md1118"></a>
2. Modify the Relationship Discovery Logic</h3>
<p>The logic for all relationship rules is centralized in the <code>_find_relationships()</code> method within <code><a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a></code>. This method contains a nested loop that compares every asset with every other asset.</p>
<p>The general flow of this method is as follows:</p>
<ol type="1">
<li>Iterate through each asset (<code>asset1</code>).</li>
<li>Iterate through each subsequent asset (<code>asset2</code>) to form a pair.</li>
<li>Apply a series of <code>if</code> statements to check the types and attributes of <code>asset1</code> and <code>asset2</code>.</li>
<li>If a condition is met, create a relationship tuple and append it to a list.</li>
<li>After checking all conditions for the pair, add the identified relationships to the graph.</li>
</ol>
<p>The flowchart below visualizes this process.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start _find_relationships] --&gt; B{Loop through all asset pairs};</div>
<div class="line">    B --&gt; C[Get asset1, asset2];</div>
<div class="line">    C --&gt; D{Check Rule 1: Same Sector?};</div>
<div class="line">    D -- Yes --&gt; E[Append &#39;same_sector&#39; relationship];</div>
<div class="line">    D -- No --&gt; F{Check Rule 2: Corporate Bond?};</div>
<div class="line">    E --&gt; F;</div>
<div class="line">    F -- Yes --&gt; G[Append &#39;corp_bond_to_equity&#39; relationship];</div>
<div class="line">    F -- No --&gt; H{...Check other rules...};</div>
<div class="line">    G --&gt; H;</div>
<div class="line">    H -- Yes --&gt; I[Append custom relationship];</div>
<div class="line">    H -- No --&gt; J[End of checks for pair];</div>
<div class="line">    I --&gt; J;</div>
<div class="line">    J --&gt; B;</div>
<div class="line">    B -- All pairs checked --&gt; K[Add all found relationships to graph];</div>
<div class="line">    K --&gt; L[End];</div>
</div><!-- fragment --><p>This diagram shows the logical flow for checking relationship rules between asset pairs.</p>
<p>Sources: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>](), [README.md:85]()</p>
<h3><a class="anchor" id="autotoc_md1119"></a>
3. Implement the Rule Logic</h3>
<p>To implement your custom rule, add a new <code>if</code> block inside the nested loop in <code>_find_relationships()</code>. This block should check the asset types and the specific attributes that define the relationship.</p>
<p>When a relationship is found, you must create a tuple with the following structure and append it to the <code>relationships</code> list.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Element   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>type</code>   </td><td class="markdownTableBodyNone"><code>str</code>   </td><td class="markdownTableBodyNone">A unique name for the relationship (e.g., <code>derivative_underlying</code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>strength</code>   </td><td class="markdownTableBodyNone"><code>float</code>   </td><td class="markdownTableBodyNone">A normalized value from 0.0 to 1.0 indicating the relationship's strength.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>bidirectional</code>   </td><td class="markdownTableBodyNone"><code>bool</code>   </td><td class="markdownTableBodyNone"><code>True</code> if the relationship is symmetric (A-&gt;B and B-&gt;A), <code>False</code> otherwise.   </td></tr>
</table>
<p><em>Source: [<a class="el" href="asset__graph_8py.html">src/logic/asset_graph.py</a>]()</em></p>
<p>Here is an example of adding a rule to link a <code>Derivative</code> to its underlying <code>Equity</code>.</p>
<div class="fragment"><div class="line"><span class="comment"># Add to _find_relationships() in AssetRelationshipGraph</span></div>
<div class="line"><span class="keywordflow">if</span> isinstance(asset1, Derivative) <span class="keywordflow">and</span> isinstance(asset2, Equity):</div>
<div class="line">    <span class="keywordflow">if</span> asset1.underlying_asset == asset2.symbol:</div>
<div class="line">        relationships.append((<span class="stringliteral">&quot;derivative_underlying&quot;</span>, 0.95, <span class="keyword">False</span>))</div>
</div><!-- fragment --><p><em>Source: [README.md:99-102]()</em></p>
<p>This code checks if one asset is a <code>Derivative</code> and the other is an <code>Equity</code>. If the derivative's underlying asset symbol matches the equity's symbol, it creates a directional relationship with a strength of 0.95.</p>
<h2><a class="anchor" id="autotoc_md1120"></a>
Best Practices and Configuration</h2>
<h3><a class="anchor" id="autotoc_md1121"></a>
Managing Relationship Strengths</h3>
<p>The codebase has been identified as having hardcoded "magic numbers" for relationship strengths (e.g., <code>0.7</code> for <code>same_sector</code>). It is recommended to extract these values into a centralized configuration file, such as <code>src/config.py</code>, to improve maintainability.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Relationship Type   </th><th class="markdownTableHeadNone">Hardcoded Strength   </th><th class="markdownTableHeadNone">Recommended Constant    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>same_sector</code>   </td><td class="markdownTableBodyNone"><code>0.7</code>   </td><td class="markdownTableBodyNone"><code>SAME_SECTOR_STRENGTH</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>corporate_bond_to_equity</code>   </td><td class="markdownTableBodyNone"><code>0.9</code>   </td><td class="markdownTableBodyNone"><code>CORPORATE_BOND_STRENGTH</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>currency_exposure</code>   </td><td class="markdownTableBodyNone"><code>0.8</code>   </td><td class="markdownTableBodyNone"><code>CURRENCY_EXPOSURE_STRENGTH</code>   </td></tr>
</table>
<p><em>Source: [<a class="el" href="IMPROVEMENTS_8md.html">IMPROVEMENTS.md</a>:23-39]()</em></p>
<h3><a class="anchor" id="autotoc_md1122"></a>
Testing Your New Rule</h3>
<p>All new features and bug fixes must be accompanied by tests. When you add a new relationship rule, you should also add a corresponding unit test to validate its behavior.</p>
<ol type="1">
<li><b>Test Structure</b>: Tests for the graph logic are located in <code><a class="el" href="test__asset__graph_8py.html">tests/unit/test_asset_graph.py</a></code>.</li>
<li><b>Fixtures</b>: Use shared fixtures from <code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code> to create sample assets for your test cases.</li>
<li><b>Test Case</b>: Write a test function that:<ul>
<li>Creates an <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>.</li>
<li>Adds the specific assets needed to trigger your new rule.</li>
<li>Calls <code>build_relationships()</code>.</li>
<li>Asserts that the new relationship was created correctly with the expected type and strength.</li>
</ul>
</li>
</ol>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:129-161](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:105-118]()</em></p>
<h2><a class="anchor" id="autotoc_md1123"></a>
Summary</h2>
<p>Creating a custom relationship rule is a straightforward process that extends the core functionality of the application. The key steps are to define the necessary asset models, add conditional logic to the <code>_find_relationships</code> method in <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code>, and provide comprehensive tests to ensure the rule functions as expected. By centralizing rule strengths and following the established testing patterns, you can contribute new, maintainable, and robust features to the relationship discovery engine.</p>
<h2><a class="anchor" id="autotoc_md1124"></a>
Development and Testing</h2>
<h3><a class="anchor" id="autotoc_md1125"></a>
Testing Strategy</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/unit/test_documentation_validation.py">tests/unit/test_documentation_validation.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/integration/test_workflow_documentation.py">tests/integration/test_workflow_documentation.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/COMPREHENSIVE_TEST_SUMMARY.md">COMPREHENSIVE_TEST_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TEST_DOCUMENTATION_SUMMARY.md">TEST_DOCUMENTATION_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING.md">TESTING.md</a></li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md1126"></a>
Testing Strategy</h1>
<p>The project employs a comprehensive testing strategy that covers both the Python backend and the TypeScript/React frontend. The approach emphasizes unit and integration tests to ensure code quality, data integrity, and prevent regressions. The strategy also includes unique validation for documentation and configuration files, treating them as critical project artifacts. The core frameworks are <code>pytest</code> for the backend and <code>Jest</code> with <code>@testing-library/react</code> for the frontend.</p>
<p>The testing infrastructure was a significant addition to the project, which initially had no tests. The current suite includes over 140 test cases across backend and frontend, validating everything from API endpoints and component rendering to Markdown file structure and dependency consistency.</p>
<p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:21-26](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:113-145]()</em></p>
<h2><a class="anchor" id="autotoc_md1127"></a>
Test Architecture</h2>
<p>The testing architecture is segregated by application layer (backend, frontend) and test type (unit, integration). This separation ensures clarity and maintainability.</p>
<p>This diagram illustrates the high-level organization of the test suites.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Testing</div>
<div class="line">        A[Test Suites] --&gt; B[Backend Tests];</div>
<div class="line">        A --&gt; C[Frontend Tests];</div>
<div class="line">        A --&gt; D[Documentation &amp; Config Tests];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Backend</div>
<div class="line">        B --&gt; B1[Pytest];</div>
<div class="line">        B1 --&gt; B2[Unit Tests: `tests/unit`];</div>
<div class="line">        B1 --&gt; B3[Integration Tests: `tests/integration`];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Frontend</div>
<div class="line">        C --&gt; C1[Jest];</div>
<div class="line">        C1 --&gt; C2[Component Tests: `frontend/__tests__/components`];</div>
<div class="line">        C1 --&gt; C3[API Client Tests: `frontend/__tests__/lib`];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Docs_and_Config</div>
<div class="line">        D --&gt; D1[Pytest];</div>
<div class="line">        D1 --&gt; D2[Markdown Validation: `test_documentation_validation.py`];</div>
<div class="line">        D1 --&gt; D3[Config Validation: `test_config_validation.py`];</div>
<div class="line">        D1 --&gt; D4[Requirements Validation: `test_requirements.py`];</div>
<div class="line">    end</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:104-112](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:114-120](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:18, 59]()</em></p>
<h3><a class="anchor" id="autotoc_md1128"></a>
Directory Structure</h3>
<p>The project organizes test files into dedicated directories:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Path   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tests/</code>   </td><td class="markdownTableBodyNone">Root directory for all backend Python tests.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>tests/unit/</code>   </td><td class="markdownTableBodyNone">Contains unit tests for isolated backend components like API endpoints and data models.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>tests/integration/</code>   </td><td class="markdownTableBodyNone">Contains integration tests for backend components, such as documentation and workflow validation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code>   </td><td class="markdownTableBodyNone">Provides shared <code>pytest</code> fixtures for backend tests.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>frontend/__tests__/</code>   </td><td class="markdownTableBodyNone">Root directory for all frontend TypeScript/React tests.   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:104-112](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:114-120]()</em></p>
<h2><a class="anchor" id="autotoc_md1129"></a>
Backend Testing (Python)</h2>
<p>Backend testing is performed using <code>pytest</code> and focuses on the FastAPI application, data models, and core logic. The suite covers API endpoints, CORS configuration, Pydantic model validation, and error handling.</p>
<p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:18-58](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>:10-56]()</em></p>
<h3><a class="anchor" id="autotoc_md1130"></a>
Key Test Areas</h3>
<ul>
<li><b>API Endpoints</b>: All REST endpoints are tested for correct responses, query parameter handling, and filtering logic.</li>
<li><b>CORS and Security</b>: <code>TestValidateOrigin</code> ensures that Cross-Origin Resource Sharing (CORS) rules correctly validate origins from localhost and Vercel deployments, preventing unauthorized access.</li>
<li><b>Concurrency</b>: Tests verify that the core <code><a class="el" href="classAssetRelationshipGraph.html">AssetRelationshipGraph</a></code> is initialized in a thread-safe manner.</li>
<li><b>Model Validation</b>: Pydantic response models are validated to ensure data integrity and correct structure.</li>
<li><b>Error Handling</b>: The system is tested against invalid requests, server errors, and 404 not-found scenarios.</li>
</ul>
<p>This class diagram shows some of the key test classes for the backend.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    direction LR</div>
<div class="line">    class TestValidateOrigin {</div>
<div class="line">        +test_http_localhost_dev()</div>
<div class="line">        +test_vercel_url()</div>
<div class="line">        +test_invalid_domain()</div>
<div class="line">    }</div>
<div class="line">    class TestAPIEndpoints {</div>
<div class="line">        +test_get_all_assets()</div>
<div class="line">        +test_filter_by_asset_class()</div>
<div class="line">        +test_asset_detail_retrieval()</div>
<div class="line">        +test_network_metrics()</div>
<div class="line">    }</div>
<div class="line">    class TestErrorHandling {</div>
<div class="line">        +test_server_error_handling()</div>
<div class="line">        +test_404_responses()</div>
<div class="line">    }</div>
<div class="line">    class TestConcurrency {</div>
<div class="line">        +test_thread_safe_double_check_locking()</div>
<div class="line">    }</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:37-54](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>:16-56]()</em></p>
<h3><a class="anchor" id="autotoc_md1131"></a>
Test Fixtures</h3>
<p>Shared test data and setup are managed using fixtures in <code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code>. This includes sample assets (<code>sample_equity</code>, <code>sample_bond</code>) and graph instances (<code>empty_graph</code>, <code>populated_graph</code>), promoting test isolation and reusability.</p>
<p><em>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:114-122]()</em></p>
<h2><a class="anchor" id="autotoc_md1132"></a>
Frontend Testing (TypeScript)</h2>
<p>Frontend testing uses <code>Jest</code> and <code>@testing-library/react</code> to validate React components, the API client, and user interactions. Tests are located in the <code>frontend/__tests__</code> directory.</p>
<p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:59-130](), [README.md:191-199]()</em></p>
<h3><a class="anchor" id="autotoc_md1133"></a>
Key Test Areas</h3>
<ul>
<li><b>API Client (<code>api.test.ts</code>)</b>: The Axios-based API client is extensively tested to verify correct endpoint calls, parameter handling, and response data parsing. All API methods, including <code>getAssets</code>, <code>getAssetDetail</code>, and <code>getVisualizationData</code>, are covered.</li>
<li><b>React Components</b>: Components like <code>AssetList</code>, <code>MetricsDashboard</code>, and <code>NetworkVisualization</code> are tested for rendering, data loading, user interactions (e.g., filtering), and handling of empty or error states.</li>
<li><b>Mock Data Validation</b>: A dedicated test file, <code>frontend/__tests__/test-utils.test.ts</code>, validates all mock data objects used in the test suite to ensure they conform to TypeScript interfaces and maintain data integrity.</li>
<li><b>Page-Level Integration</b>: The main application page is tested to ensure correct component integration, tab switching, and data loading flows.</li>
</ul>
<p>This diagram shows the structure of the frontend test suites.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Frontend_Tests</div>
<div class="line">        FT[Jest Test Suites] --&gt; API[API Client: api.test.ts];</div>
<div class="line">        FT --&gt; Comp[Component Tests];</div>
<div class="line">        FT --&gt; Mock[Mock Data Validation: test-utils.test.ts];</div>
<div class="line">        FT --&gt; Page[Page Integration: page.test.tsx];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Components</div>
<div class="line">        Comp --&gt; AL[AssetList.test.tsx];</div>
<div class="line">        Comp --&gt; MD[MetricsDashboard.test.tsx];</div>
<div class="line">        Comp --&gt; NV[NetworkVisualization.test.tsx];</div>
<div class="line">    end</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:61-130](), [<a class="el" href="COMPREHENSIVE__TEST__SUMMARY_8md.html">COMPREHENSIVE_TEST_SUMMARY.md</a>:20-44]()</em></p>
<h2><a class="anchor" id="autotoc_md1134"></a>
Documentation and Configuration Testing</h2>
<p>A unique aspect of this project's testing strategy is the validation of non-code artifacts like Markdown documentation and configuration files. These tests run within the <code>pytest</code> framework and ensure that project metadata and documentation remain accurate and well-formatted.</p>
<p><em>Sources: [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>](), [<a class="el" href="unit_2test__documentation__validation_8py.html">tests/unit/test_documentation_validation.py</a>]()</em></p>
<h3><a class="anchor" id="autotoc_md1135"></a>
Documentation Validation</h3>
<p>Tests in <code><a class="el" href="unit_2test__documentation__validation_8py.html">tests/unit/test_documentation_validation.py</a></code> and <code><a class="el" href="test__workflow__documentation_8py.html">tests/integration/test_workflow_documentation.py</a></code> validate <code>.md</code> files for:</p>
<ul>
<li><b>Structure</b>: Presence of required titles and sections (e.g., <code>## Overview</code>).</li>
<li><b>Formatting</b>: Correct Markdown syntax, no trailing whitespace, and proper code block closure.</li>
<li><b>Content Accuracy</b>: Mentions of key files and technologies (e.g., <code>pytest</code>, <code>pr-agent.yml</code>).</li>
<li><b>Consistency</b>: Cross-validation between different documentation files to ensure file counts and other metrics match.</li>
<li><b>Security</b>: Checks for hardcoded secrets like GitHub tokens.</li>
</ul>
<p>The following class diagram outlines the test classes responsible for documentation validation.</p>
<div class="fragment"><div class="line">classDiagram</div>
<div class="line">    class TestDependencyMatrix {</div>
<div class="line">        +test_file_counts_match()</div>
<div class="line">        +test_dependency_format()</div>
<div class="line">    }</div>
<div class="line">    class TestSystemManifest {</div>
<div class="line">        +test_has_project_overview()</div>
<div class="line">        +test_directory_structure_format()</div>
<div class="line">    }</div>
<div class="line">    class TestDocumentationConsistency {</div>
<div class="line">        +test_file_counts_match_between_documents()</div>
<div class="line">        +test_timestamps_are_recent()</div>
<div class="line">    }</div>
<div class="line">    class TestDocumentationRealisticContent {</div>
<div class="line">        +test_documented_files_exist()</div>
<div class="line">        +test_documented_dependencies_are_real_packages()</div>
<div class="line">    }</div>
<div class="line">    class TestSecurityAndBestPractices {</div>
<div class="line">        +test_no_hardcoded_secrets()</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    TestDependencyMatrix --|&gt; DocumentationValidation</div>
<div class="line">    TestSystemManifest --|&gt; DocumentationValidation</div>
<div class="line">    TestDocumentationConsistency --|&gt; DocumentationValidation</div>
<div class="line">    TestDocumentationRealisticContent --|&gt; DocumentationValidation</div>
<div class="line">    TestSecurityAndBestPractices --|&gt; DocumentationValidation</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>:21-65](), [<a class="el" href="unit_2test__documentation__validation_8py.html">tests/unit/test_documentation_validation.py</a>](), [<a class="el" href="integration_2test__documentation__validation_8py.html">tests/integration/test_documentation_validation.py</a>:228-244]()</em></p>
<h3><a class="anchor" id="autotoc_md1136"></a>
Configuration and Dependency Testing</h3>
<p>Tests like <code><a class="el" href="test__config__validation_8py.html">tests/unit/test_config_validation.py</a></code> and <code><a class="el" href="test__requirements_8py.html">tests/integration/test_requirements.py</a></code> validate:</p>
<ul>
<li><b>JSON/YAML Syntax</b>: Ensures configuration files like <code>vercel.json</code> and <code>.github/workflows/pr-agent.yml</code> are well-formed.</li>
<li><b>Dependency Integrity</b>: <code>requirements.txt</code> and <code>package.json</code> are checked for required packages, consistent versioning, and security pins.</li>
</ul>
<p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:40-58](), [<a class="el" href="TEST__GENERATION__SUMMARY_8md.html">TEST_GENERATION_SUMMARY.md</a>:10-31](), [<a class="el" href="COMPREHENSIVE__TEST__SUMMARY_8md.html">COMPREHENSIVE_TEST_SUMMARY.md</a>:83-85]()</em></p>
<h2><a class="anchor" id="autotoc_md1137"></a>
Execution and CI/CD</h2>
<p>Tests are designed to be run locally by developers and automatically in a CI/CD pipeline.</p>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:99-111](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:132-171]()</em></p>
<h3><a class="anchor" id="autotoc_md1138"></a>
Local Execution</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Environment   </th><th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Backend</b>   </td><td class="markdownTableBodyNone"><code>pytest</code>   </td><td class="markdownTableBodyNone">Runs all Python tests.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>pytest --cov=api --cov=src</code>   </td><td class="markdownTableBodyNone">Runs tests with a coverage report.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Frontend</b>   </td><td class="markdownTableBodyNone"><code>cd frontend &amp;&amp; npm test</code>   </td><td class="markdownTableBodyNone">Runs all TypeScript/React tests.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone"><code>cd frontend &amp;&amp; npm test -- --coverage</code>   </td><td class="markdownTableBodyNone">Runs frontend tests with coverage.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>All Checks</b>   </td><td class="markdownTableBodyNone"><code>make check</code>   </td><td class="markdownTableBodyNone">A utility command to run formatting, linting, type-checking, and all tests.   </td></tr>
</table>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:104, 133-145](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:134-158](), [README.md:185-212]()</em></p>
<h3><a class="anchor" id="autotoc_md1139"></a>
CI/CD Integration</h3>
<p>Tests are integrated into a GitHub Actions workflow (<code>.github/workflows/ci.yml</code>), which runs on every push and pull request.</p>
<p>This flowchart shows the CI testing pipeline.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Push or PR] --&gt; B{CI Workflow};</div>
<div class="line">    B --&gt; C[Backend Job];</div>
<div class="line">    B --&gt; D[Frontend Job];</div>
<div class="line"> </div>
<div class="line">    subgraph C [Backend Job]</div>
<div class="line">        C1[Setup Python] --&gt; C2[Install Dependencies];</div>
<div class="line">        C2 --&gt; C3[Lint &amp; Format Check];</div>
<div class="line">        C3 --&gt; C4[Run Pytest];</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph D [Frontend Job]</div>
<div class="line">        D1[Setup Node.js] --&gt; D2[Install Dependencies];</div>
<div class="line">        D2 --&gt; D3[Run Jest Tests];</div>
<div class="line">    end</div>
</div><!-- fragment --><p><em>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:239-268](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:144-155]()</em></p>
<h3><a class="anchor" id="autotoc_md1140"></a>
Pre-commit Hooks</h3>
<p>To ensure code quality before commits, the project uses <code>pre-commit</code> hooks. These hooks automatically run formatters (<code>black</code>, <code>isort</code>), linters (<code>flake8</code>), and type checkers (<code>mypy</code>), catching issues early.</p>
<p><em>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:86-92](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:159-168]()</em></p>
<h2><a class="anchor" id="autotoc_md1141"></a>
Conclusion</h2>
<p>The testing strategy for the Financial Asset Relationship Database is robust and multi-faceted. It provides comprehensive coverage for backend logic, frontend components, and critical project artifacts like documentation and configuration. By integrating automated checks into both pre-commit hooks and the CI/CD pipeline, the strategy enforces high standards of quality and stability, enabling developers to contribute with confidence.</p>
<p><em>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:255-265](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:167-171]()</em></p>
<h3><a class="anchor" id="autotoc_md1142"></a>
Running Tests</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/pyproject.toml">pyproject.toml</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/conftest.py">conftest.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/frontend/jest.config.js">frontend/jest.config.js</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/test_scripts.sh">test_scripts.sh</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/integration/test_documentation_validation.py">tests/integration/test_documentation_validation.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/COMPREHENSIVE_TEST_SUMMARY.md">COMPREHENSIVE_TEST_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TEST_DOCUMENTATION_SUMMARY.md">TEST_DOCUMENTATION_SUMMARY.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1143"></a>
Running Tests</h1>
<p>The project employs a comprehensive testing strategy that covers both the Python backend and the Next.js frontend, ensuring code quality, stability, and correctness. The testing infrastructure is built around industry-standard tools: <code>pytest</code> for the backend and <code>Jest</code> with <code>React Testing Library</code> for the frontend. With over 140 test cases, the suite validates everything from API endpoints and component rendering to configuration files and documentation integrity.</p>
<p>This guide provides a detailed overview of the testing architecture, command-line execution, and the different types of tests available in the repository. For more information on development workflows, see the <a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> guide.</p>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:5-8](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:100-103](), [README.md:144-146]()</p>
<h2><a class="anchor" id="autotoc_md1144"></a>
Test Architecture Overview</h2>
<p>The project maintains two parallel testing stacks, one for the Python backend and one for the TypeScript/React frontend. This separation allows for isolated, framework-specific testing while ensuring complete coverage of the application.</p>
<p>The following diagram illustrates the high-level testing architecture.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Backend Testing [Python]</div>
<div class="line">        B1[Pytest] --&gt; B2{Test Runner};</div>
<div class="line">        B3[tests/unit] --&gt; B1;</div>
<div class="line">        B4[tests/integration] --&gt; B1;</div>
<div class="line">        B5[conftest.py] --&gt; B1;</div>
<div class="line">        B6[pyproject.toml] -- config --&gt; B1;</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Frontend Testing [TypeScript/React]</div>
<div class="line">        F1[Jest] --&gt; F2{Test Runner};</div>
<div class="line">        F3[frontend/__tests__] --&gt; F1;</div>
<div class="line">        F4[React Testing Library] --&gt; F1;</div>
<div class="line">        F5[jest.config.js] -- config --&gt; F1;</div>
<div class="line">        F6[package.json] -- scripts --&gt; F1;</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph CI/CD [GitHub Actions]</div>
<div class="line">        G1[Push/PR] --&gt; G2{Run Tests};</div>
<div class="line">        G2 --&gt; B2;</div>
<div class="line">        G2 --&gt; F2;</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    B2 --&gt; B7[Coverage Report];</div>
<div class="line">    F2 --&gt; F7[Coverage Report];</div>
</div><!-- fragment --><p>This diagram shows the separate testing stacks for the backend (Pytest) and frontend (Jest), both of which are executed during the CI/CD process.</p>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:10-21](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:105-112](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:104-107]()</p>
<h2><a class="anchor" id="autotoc_md1145"></a>
Backend Testing (Python)</h2>
<p>The backend test suite uses <code>pytest</code> to validate the FastAPI application, core logic, data models, and configuration files. Tests are organized into <code>unit</code> and <code>integration</code> directories.</p>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:23-25](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:105-112]()</p>
<h3><a class="anchor" id="autotoc_md1146"></a>
Structure and Configuration</h3>
<ul>
<li><b>Test Runner</b>: <code>pytest</code></li>
<li><b>Configuration</b>: <code>pyproject.toml</code> defines pytest settings, including test paths and markers.</li>
<li><b>Fixtures</b>: Shared test fixtures, such as <code>sample_equity</code> and <code>populated_graph</code>, are defined in <code><a class="el" href="tests_2conftest_8py.html">tests/conftest.py</a></code> to provide reusable data for tests.</li>
<li><b>Directory Structure</b>:<ul>
<li><code>tests/unit/</code>: For isolated tests of individual components, such as API endpoints or data models.</li>
<li><code>tests/integration/</code>: For tests that verify interactions between multiple components or validate entire files (e.g., documentation, requirements).</li>
</ul>
</li>
</ul>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:105-112](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:113-122](), [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>:11]()</p>
<h3><a class="anchor" id="autotoc_md1147"></a>
Test Coverage</h3>
<p>The backend tests provide extensive coverage, including:</p>
<ul>
<li>API endpoints, query parameters, and filtering.</li>
<li>CORS configuration and security validation.</li>
<li>Pydantic model validation and error handling.</li>
<li>Thread-safe graph initialization.</li>
<li>Configuration file validation (<code>vercel.json</code>, <code>requirements.txt</code>).</li>
<li>Documentation file integrity and formatting.</li>
</ul>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:31-59](), [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>:15-49]()</p>
<h3><a class="anchor" id="autotoc_md1148"></a>
Running Backend Tests</h3>
<p>The following table summarizes the commands used to run backend tests. These can be executed directly or via the <code>Makefile</code>.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>pytest</code>   </td><td class="markdownTableBodyLeft">Runs all tests in the <code>tests/</code> directory.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:126]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>pytest -v</code>   </td><td class="markdownTableBodyLeft">Runs all tests with verbose output.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:121]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>pytest --cov=api --cov=src</code>   </td><td class="markdownTableBodyLeft">Runs tests and generates a coverage report.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:124]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>pytest -m unit</code>   </td><td class="markdownTableBodyLeft">Runs only tests marked with the <code>unit</code> marker.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:132]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make test</code>   </td><td class="markdownTableBodyLeft">Makefile shortcut to run tests with coverage.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:87]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make lint</code>   </td><td class="markdownTableBodyLeft">Runs linters like <code>flake8</code> and <code>pylint</code>.   </td><td class="markdownTableBodyLeft">[<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:84]()   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1149"></a>
Frontend Testing (TypeScript)</h2>
<p>The frontend test suite uses <code>Jest</code> and <code>React Testing Library</code> to validate React components, the API client, and configuration files.</p>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:61-66](), [README.md:157-159]()</p>
<h3><a class="anchor" id="autotoc_md1150"></a>
Structure and Configuration</h3>
<ul>
<li><b>Test Runner</b>: <code>Jest</code>, configured via <code>frontend/jest.config.js</code>.</li>
<li><b>Utilities</b>: <code>React Testing Library</code> is used for rendering components and simulating user interactions.</li>
<li><b>Setup</b>: <code>frontend/jest.setup.js</code> configures the test environment, including mocks for browser APIs like <code>window.matchMedia</code>.</li>
<li><b>Test Location</b>: All test files are located within the <code>frontend/__tests__</code> directory, mirroring the structure of the <code>app</code> directory.</li>
</ul>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:61-66](), [<a class="el" href="TEST__SUMMARY_8md.html">TEST_SUMMARY.md</a>:88-96]()</p>
<h3><a class="anchor" id="autotoc_md1151"></a>
Test Coverage</h3>
<p>Frontend tests validate:</p>
<ul>
<li>The API client library (<code>app/lib/api.ts</code>), including all endpoint functions and error handling.</li>
<li>React components, covering rendering, data loading, user interactions (filtering), and empty/error states.</li>
<li>The main application page, including tab switching and component integration.</li>
<li>Configuration files like <code>package.json</code> and <code>package-lock.json</code> for dependency integrity.</li>
</ul>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:68-117](), [<a class="el" href="TEST__GENERATION__REPORT_8md.html">TEST_GENERATION_REPORT.md</a>:21-46]()</p>
<h3><a class="anchor" id="autotoc_md1152"></a>
Running Frontend Tests</h3>
<p>The following commands are run from the <code>frontend/</code> directory.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description   </th><th class="markdownTableHeadLeft">Source    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>npm test</code>   </td><td class="markdownTableBodyLeft">Runs all frontend tests.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:133]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>npm run test:watch</code>   </td><td class="markdownTableBodyLeft">Runs tests in interactive watch mode.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:136]()    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>npm run test:coverage</code>   </td><td class="markdownTableBodyLeft">Runs tests and generates a coverage report.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:139]()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>npm test -- AssetList.test.tsx</code>   </td><td class="markdownTableBodyLeft">Runs tests for a specific file.   </td><td class="markdownTableBodyLeft">[<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:94]()   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md1153"></a>
Specialized Test Suites</h2>
<p>Beyond typical unit and integration tests, the project includes specialized suites to ensure the quality of documentation and configuration.</p>
<p>Sources: [<a class="el" href="COMPREHENSIVE__TEST__SUMMARY_8md.html">COMPREHENSIVE_TEST_SUMMARY.md</a>:92-109](), [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md1154"></a>
Documentation Validation</h3>
<p>A unique feature of this project's test suite is the validation of Markdown documentation files. These tests ensure that documentation remains accurate, well-formatted, and maintainable.</p>
<p>The following diagram shows the validation flow for a documentation file.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[pytest runs test_documentation_validation.py] --&gt; B{Load .md File};</div>
<div class="line">    B --&gt; C[Check Existence &amp; Readability];</div>
<div class="line">    B --&gt; D[Validate Structure];</div>
<div class="line">    D --&gt; D1[Has H1 Title];</div>
<div class="line">    D --&gt; D2[Has Required Sections];</div>
<div class="line">    B --&gt; E[Validate Formatting];</div>
<div class="line">    E --&gt; E1[No Trailing Whitespace];</div>
<div class="line">    E --&gt; E2[Code Blocks Closed];</div>
<div class="line">    B --&gt; F[Validate Content];</div>
<div class="line">    F --&gt; F1[Mentions Key Files];</div>
<div class="line">    F --&gt; F2[No Hardcoded Secrets];</div>
<div class="line">    C &amp; D &amp; E &amp; F --&gt; G[Test Passed/Failed];</div>
</div><!-- fragment --><p>These tests are located in files like <code><a class="el" href="integration_2test__documentation__validation_8py.html">tests/integration/test_documentation_validation.py</a></code> and <code><a class="el" href="unit_2test__documentation__validation_8py.html">tests/unit/test_documentation_validation.py</a></code>. They check for:</p>
<ul>
<li>Correct Markdown syntax and heading structure.</li>
<li>Presence of required sections like "Overview".</li>
<li>Absence of hardcoded secrets.</li>
<li>Consistency of information between different documentation files.</li>
</ul>
<p>Sources: [<a class="el" href="integration_2test__documentation__validation_8py.html">tests/integration/test_documentation_validation.py</a>](), [<a class="el" href="TEST__DOCUMENTATION__SUMMARY_8md.html">TEST_DOCUMENTATION_SUMMARY.md</a>:15-49]()</p>
<h3><a class="anchor" id="autotoc_md1155"></a>
Configuration File Validation</h3>
<p>Tests are in place to validate various configuration files, preventing common errors related to dependencies and deployment settings.</p>
<ul>
<li><b><code>requirements.txt</code> / <code>requirements-dev.txt</code></b>: Tests ensure required packages are present, versions are correctly specified, and security pins are in place.</li>
<li><b><code>package.json</code> / <code>package-lock.json</code></b>: Tests validate dependency versions, script availability, and integrity between the two files.</li>
<li><b><code>vercel.json</code> / <code>tsconfig.json</code></b>: Deployment and TypeScript compiler settings are validated for correctness.</li>
</ul>
<p>Sources: [<a class="el" href="TEST__GENERATION__SUMMARY_8md.html">TEST_GENERATION_SUMMARY.md</a>:14-35](), [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:47-59](), [<a class="el" href="TEST__GENERATION__REPORT_8md.html">TEST_GENERATION_REPORT.md</a>:21-72]()</p>
<h2><a class="anchor" id="autotoc_md1156"></a>
CI/CD Integration</h2>
<p>All tests are designed to run automatically in the CI/CD pipeline using GitHub Actions. The workflow is configured to execute both backend and frontend test suites on every push and pull request, ensuring that no failing tests are merged into the main branch.</p>
<p>The CI pipeline performs the following steps:</p>
<ol type="1">
<li>Checks out the code.</li>
<li>Sets up Python and Node.js environments.</li>
<li>Installs backend and frontend dependencies.</li>
<li>Runs the respective test suites, often with coverage reporting.</li>
</ol>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:169-194](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:138-148]()</p>
<h3><a class="anchor" id="autotoc_md1157"></a>
CI/CD Workflows</h3>
<details >
<summary >
Relevant source files</summary>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/tests/integration/test_github_workflows.py">tests/integration/test_github_workflows.py</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CHANGELOG.md">CHANGELOG.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/BRANCH_CLEANUP_SUMMARY.md">BRANCH_CLEANUP_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/README.md">README.md</a></li>
<li>COMPREHENSIVE_TEST_SUMMARY.md</li>
</ul>
<p></p>
</details>
<h1><a class="anchor" id="autotoc_md1158"></a>
CI/CD Workflows</h1>
<p>The project employs a streamlined and robust set of CI/CD workflows managed through GitHub Actions. The system was significantly refactored to remove 23 irrelevant workflow files for technologies not used in the project (like .NET, Docker, and Node.js), consolidating the pipeline into a few focused, Python-centric workflows. This cleanup reduced CI/CD resource usage and improved maintainability. The core of the CI strategy is a consolidated pipeline (<code>ci.yml</code>) for testing and quality checks, supplemented by automated PR management (<code>pr-agent.yml</code>), security scanning, and branch maintenance.</p>
<p>A key feature of this repository is that the workflows themselves are subject to comprehensive integration testing using <code>pytest</code>. These tests validate YAML syntax, structure, security best practices, and action configurations, ensuring the CI/CD infrastructure remains reliable and secure. This approach prevents common workflow errors like duplicate keys or invalid syntax from being merged.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:40-47, 102-113](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:12-20](), [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>]()</p>
<h2><a class="anchor" id="autotoc_md1159"></a>
Workflow Architecture</h2>
<p>The project utilizes several GitHub Actions workflows, each triggered by different events, to automate testing, security scanning, PR management, and repository maintenance. The main workflows are <code>ci.yml</code>, <code>pr-agent.yml</code>, <code>codeql.yml</code>, <code>dependency-review.yml</code>, and <code>branch-cleanup.yml</code>.</p>
<p>This diagram illustrates the high-level architecture of the GitHub Actions workflows, their triggers, and their primary functions.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Triggers</div>
<div class="line">        A[Push to main]</div>
<div class="line">        B[Pull Request]</div>
<div class="line">        C[PR Comment / Review]</div>
<div class="line">        D[Weekly Schedule]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Workflows</div>
<div class="line">        W1[ci.yml]</div>
<div class="line">        W2[pr-agent.yml]</div>
<div class="line">        W3[codeql.yml]</div>
<div class="line">        W4[dependency-review.yml]</div>
<div class="line">        W5[branch-cleanup.yml]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Actions</div>
<div class="line">        J1[Run Tests &amp; Quality Checks]</div>
<div class="line">        J2[Automated PR Review &amp; Merge]</div>
<div class="line">        J3[Static Code Analysis (Security)]</div>
<div class="line">        J4[Dependency Vulnerability Scan]</div>
<div class="line">        J5[Identify Stale Branches]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A --&gt; W1</div>
<div class="line">    B --&gt; W1</div>
<div class="line">    B --&gt; W4</div>
<div class="line">    C --&gt; W2</div>
<div class="line">    D --&gt; W3</div>
<div class="line">    D --&gt; W5</div>
<div class="line"> </div>
<div class="line">    W1 --&gt; J1</div>
<div class="line">    W2 --&gt; J2</div>
<div class="line">    W3 --&gt; J3</div>
<div class="line">    W4 --&gt; J4</div>
<div class="line">    W5 --&gt; J5</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:104-109](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:109-113](), [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:21-28](), [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>:215-220]()</p>
<h2><a class="anchor" id="autotoc_md1160"></a>
Consolidated CI Pipeline (<code>ci.yml</code>)</h2>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:104-119](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:102-113]()</p>
<p>The <code>ci.yml</code> workflow is the primary CI/CD pipeline, responsible for running a suite of quality and security checks on every push and pull request to the <code>main</code> branch. It replaced several redundant Python-specific workflows like <code>python-app.yml</code> and <code>pylint.yml</code>. The pipeline is structured into two main jobs: <code>test</code> and <code>security</code>.</p>
<p>The flow diagram below shows the sequence of jobs and steps within the <code>ci.yml</code> pipeline.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    Start[Trigger: Push/PR] --&gt; TestJob{Test Job};</div>
<div class="line"> </div>
<div class="line">    subgraph TestJob [Python Matrix: 3.8, 3.9, 3.10, 3.11, 3.12]</div>
<div class="line">        direction LR</div>
<div class="line">        T1[Install Deps] --&gt; T2[Lint] --&gt; T3[Format Check] --&gt; T4[Type Check] --&gt; T5[Run Pytest]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    TestJob --&gt; SecurityJob{Security Job};</div>
<div class="line">    subgraph SecurityJob</div>
<div class="line">        direction LR</div>
<div class="line">        S1[Scan with bandit] --&gt; S2[Scan with safety]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    SecurityJob --&gt; Finish[End]</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:107-119](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:105-108]()</p>
<h3><a class="anchor" id="autotoc_md1161"></a>
Test Job</h3>
<p>The <code>test</code> job runs in a matrix across multiple Python versions to ensure compatibility. It performs a sequence of checks, and a failure in any step will fail the job.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Python Versions Tested    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">3.8    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3.9    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">3.10    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft">3.11    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft">3.12   </td></tr>
</table>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:108-109]()</p>
<p>The steps executed in the <code>test</code> job are:</p>
<ol type="1">
<li><b>Install Dependencies</b>: Installs production and development dependencies from <code>requirements.txt</code> and <code>requirements-dev.txt</code>, using a cache to speed up builds.</li>
<li><b>Lint</b>: Runs <code>flake8</code> and <code>pylint</code> to check for code style and errors.</li>
<li><b>Format Check</b>: Runs <code>black</code> and <code>isort</code> to ensure code is formatted correctly.</li>
<li><b>Type Check</b>: Runs <code>mypy</code> for static type checking.</li>
<li><b>Test</b>: Executes the <code>pytest</code> suite with coverage reporting. Coverage reports are uploaded as artifacts.</li>
</ol>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:109-112](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:79-92]()</p>
<h3><a class="anchor" id="autotoc_md1162"></a>
Security Job</h3>
<p>The <code>security</code> job runs after the <code>test</code> job completes successfully. It uses two tools to scan for potential security vulnerabilities:</p>
<ul>
<li><b><code>safety</code></b>: Checks for known vulnerabilities in installed Python dependencies.</li>
<li><b><code>bandit</code></b>: Performs static security analysis on the Python codebase to find common security issues.</li>
</ul>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:115-118](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:108]()</p>
<h2><a class="anchor" id="autotoc_md1163"></a>
PR Agent Workflow (<code>pr-agent.yml</code>)</h2>
<p>Sources: [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>:207-404]()</p>
<p>The <code>pr-agent.yml</code> workflow automates pull request reviews, comments, and merging based on specific triggers like PR review comments. It is designed to respond to commands like <code>@copilot</code> in comments. The workflow is composed of three distinct jobs.</p>
<h3><a class="anchor" id="autotoc_md1164"></a>
Jobs</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Job Name   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>pr-agent-trigger</code>   </td><td class="markdownTableBodyLeft">The main job that runs on PR comments or reviews. It lints, tests, and posts results back to the PR.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>auto-merge-check</code>   </td><td class="markdownTableBodyLeft">Checks if a PR can be auto-merged based on approval status and successful checks.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>dependency-update</code>   </td><td class="markdownTableBodyLeft">Auto-approves and merges dependency updates from trusted bots like Dependabot and Renovate.   </td></tr>
</table>
<p>Sources: [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>:414-424]()</p>
<h3><a class="anchor" id="autotoc_md1165"></a>
Trigger and Logic Flow</h3>
<p>The workflow uses conditional logic (<code>if</code>) to execute jobs based on the event context.</p>
<p>This diagram shows the conditional logic for the <code>pr-agent.yml</code> jobs.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    subgraph Triggers</div>
<div class="line">        T1[PR Comment with &#39;@copilot&#39;]</div>
<div class="line">        T2[PR Review &#39;CHANGES_REQUESTED&#39;]</div>
<div class="line">        T3[PR Sync with &#39;approved&#39; review]</div>
<div class="line">        T4[PR from Dependabot/Renovate]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Jobs</div>
<div class="line">        J1[pr-agent-trigger]</div>
<div class="line">        J2[auto-merge-check]</div>
<div class="line">        J3[dependency-update]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    T1 --&gt; J1</div>
<div class="line">    T2 --&gt; J1</div>
<div class="line">    T3 --&gt; J2</div>
<div class="line">    T4 --&gt; J3</div>
<div class="line"> </div>
<div class="line">    J1 --&gt; J1_S1[Setup Env] --&gt; J1_S2[Install Deps] --&gt; J1_S3[Lint &amp; Test] --&gt; J1_S4[Post Comment to PR]</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>:440-447, 532-542, 550-556]()</p>
<h3><a class="anchor" id="autotoc_md1166"></a>
Permissions</h3>
<p>The workflow requests specific, limited permissions to follow the principle of least privilege.</p>
<ul>
<li><b>Top-Level</b>: <code>contents: read</code></li>
<li><b><code>pr-agent-trigger</code></b>: <code>issues: write</code> (to comment on PRs)</li>
<li><b><code>auto-merge-check</code></b>: <code>issues: write</code>, <code>pull-requests: write</code> (to merge)</li>
<li><b><code>dependency-update</code></b>: <code>pull-requests: write</code> (to approve and merge)</li>
</ul>
<p>Sources: [tests/integration/test_githubworkflows.py:426-439]()</p>
<h2><a class="anchor" id="autotoc_md1167"></a>
Branch Management Workflow (<code>branch-cleanup.yml</code>)</h2>
<p>Sources: [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:21-28]()</p>
<p>To maintain repository hygiene, the <code>branch-cleanup.yml</code> workflow runs automatically on a weekly schedule. Its purpose is to identify and report on stale branches that have not been updated recently.</p>
<p><b>Key Features:</b></p>
<ul>
<li><b>Schedule</b>: Runs weekly to detect stale branches.</li>
<li><b>Manual Trigger</b>: Can be run on-demand from the GitHub Actions UI.</li>
<li><b>Reporting</b>: Generates a report of stale branches in the workflow run summary.</li>
</ul>
<p>This automation helps prevent the accumulation of unnecessary branches, as detailed in the "" "Branch Cleanup Analysis".</p>
<p>Sources: [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:21-28]()</p>
<h2><a class="anchor" id="autotoc_md1168"></a>
Security Workflows</h2>
<p>The repository uses standard, GitHub-provided security workflows to proactively identify vulnerabilities.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Workflow File   </th><th class="markdownTableHeadLeft">Purpose    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>codeql.yml</code>   </td><td class="markdownTableBodyLeft">Performs deep static code analysis to find security vulnerabilities.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>dependency-review.yml</code>   </td><td class="markdownTableBodyLeft">Scans for vulnerabilities in dependencies added or changed in a PR.   </td></tr>
</table>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:104-109](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:109-113]()</p>
<h2><a class="anchor" id="autotoc_md1169"></a>
Workflow Validation Testing</h2>
<p>A unique aspect of this project is its comprehensive integration test suite for the GitHub Actions workflows themselves, located in <code><a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a></code>. These tests use <code>pytest</code> to parse the workflow YAML files and validate them against a series of rules, ensuring their correctness and security before they are even run by GitHub Actions.</p>
<p>This diagram shows the structure of the workflow test suite.</p>
<div class="fragment"><div class="line">graph TD</div>
<div class="line">    subgraph Pytest Suite</div>
<div class="line">        A[test_github_workflows.py]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    subgraph Test Classes</div>
<div class="line">        C1[TestWorkflowSyntax]</div>
<div class="line">        C2[TestWorkflowStructure]</div>
<div class="line">        C3[TestWorkflowActions]</div>
<div class="line">        C4[TestPrAgentWorkflow]</div>
<div class="line">        C5[TestWorkflowSecurity]</div>
<div class="line">        C6[TestWorkflowMaintainability]</div>
<div class="line">        C7[TestWorkflowEdgeCases]</div>
<div class="line">    end</div>
<div class="line"> </div>
<div class="line">    A --&gt; C1</div>
<div class="line">    A --&gt; C2</div>
<div class="line">    A --&gt; C3</div>
<div class="line">    A --&gt; C4</div>
<div class="line">    A --&gt; C5</div>
<div class="line">    A --&gt; C6</div>
<div class="line">    A --&gt; C7</div>
</div><!-- fragment --><p>Sources: [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>]()</p>
<h3><a class="anchor" id="autotoc_md1170"></a>
Test Coverage</h3>
<p>The test suite is organized into multiple classes, each targeting a specific aspect of workflow validation.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Test Class   </th><th class="markdownTableHeadLeft">Validation Checks    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>TestWorkflowSyntax</code>   </td><td class="markdownTableBodyLeft">Valid YAML syntax, no duplicate keys, file is readable.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>TestWorkflowStructure</code>   </td><td class="markdownTableBodyLeft">Presence of <code>name</code>, <code>on</code>, and <code>jobs</code> fields. Ensures jobs have steps.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>TestWorkflowActions</code>   </td><td class="markdownTableBodyLeft">Actions use version tags (e.g., <code>@v2</code>), steps have <code>name</code> or <code>uses</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>TestPrAgentWorkflow</code>   </td><td class="markdownTableBodyLeft">Specific checks for <code>pr-agent.yml</code>, including triggers, job structure, and step configurations.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>TestWorkflowSecurity</code>   </td><td class="markdownTableBodyLeft">No hardcoded secrets, sensitive data uses the <code>secrets</code> context.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>TestWorkflowMaintainability</code>   </td><td class="markdownTableBodyLeft">Steps have descriptive names, file size is reasonable.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>TestWorkflowEdgeCases</code>   </td><td class="markdownTableBodyLeft">Correct file extensions (<code>.yml</code>/<code>.yaml</code>), UTF-8 encoding, no tabs for indentation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>TestWorkflowPerformance</code>   </td><td class="markdownTableBodyLeft">Recommends use of caching to improve performance.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>TestWorkflowAdvancedSecurity</code>   </td><td class="markdownTableBodyLeft">Checks for potential environment variable injection and secrets being logged.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>TestWorkflowJobConfiguration</code>   </td><td class="markdownTableBodyLeft">Jobs specify a standard runner (<code>runs-on</code>).   </td></tr>
</table>
<p>Sources: [<a class="el" href="test__github__workflows_8py.html">tests/integration/test_github_workflows.py</a>:79, 134, 183, 207, 313, 357, 386, 406, 611, 706](), [<a class="el" href="COMPREHENSIVE__TEST__SUMMARY_8md.html">COMPREHENSIVE_TEST_SUMMARY.md</a>:120-129]()</p>
<p>This proactive testing of the CI/CD configuration itself is a critical practice that enhances the stability and security of the entire development lifecycle.</p>
<h2><a class="anchor" id="autotoc_md1171"></a>
Conclusion</h2>
<p>The CI/CD system for this project is a modern, consolidated, and robust implementation. By removing legacy clutter and focusing on a single, well-tested pipeline, the project benefits from faster, more reliable, and more secure automated checks. The inclusion of automated PR management, branch cleanup, and comprehensive self-testing of the workflows demonstrates a mature approach to DevOps, ensuring high-quality code and a clean, maintainable repository.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:231-239](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:144-148]()</p>
<h3><a class="anchor" id="autotoc_md1172"></a>
Developer Scripts and Tooling</h3>
<details >
<summary >
Relevant source files</summary>
<p></p>
<p>The following files were used as context for generating this wiki page:</p>
<ul>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/SUMMARY.md">SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/BRANCH_CLEANUP_SUMMARY.md">BRANCH_CLEANUP_SUMMARY.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/BRANCH_CLEANUP_ANALYSIS.md">BRANCH_CLEANUP_ANALYSIS.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/BRANCH_CLEANUP_QUICK_REFERENCE.md">BRANCH_CLEANUP_QUICK_REFERENCE.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/AUDIT_REPORT.md">AUDIT_REPORT.md</a></li>
<li><a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/TESTING_GUIDE.md">TESTING_GUIDE.md</a> </li>
</ul>
</details>
<h1><a class="anchor" id="autotoc_md1173"></a>
Developer Scripts and Tooling</h1>
<p>The project is equipped with a comprehensive suite of developer scripts and tooling designed to streamline development, enforce code quality, and maintain repository hygiene. The primary entry point for developers is a <code>Makefile</code> that provides shortcuts for common tasks like installation, testing, and formatting. This is supplemented by shell scripts for specialized tasks like branch cleanup and automated quality checks via pre-commit hooks.</p>
<p>This tooling ensures a consistent development environment and automates quality assurance, allowing developers to focus on building features. For detailed setup instructions and workflow, refer to the <a href="https://github.com/DashFin/financial-asset-relationship-db/blob/main/CONTRIBUTING.md">CONTRIBUTING.md</a> guide.</p>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1174"></a>
Makefile Commands</h2>
<p>The <code>Makefile</code> serves as the central command interface for developers, abstracting away the specifics of various tools. It provides a set of simple, memorable commands for all essential development lifecycle tasks.</p>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:37-55](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:65-71]()</p>
<h3><a class="anchor" id="autotoc_md1175"></a>
Command Reference</h3>
<p>The following table summarizes the available <code>make</code> commands and their functions.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Command   </th><th class="markdownTableHeadLeft">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make help</code>   </td><td class="markdownTableBodyLeft">Shows all available commands.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make install</code>   </td><td class="markdownTableBodyLeft">Installs production dependencies from <code>requirements.txt</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make install-dev</code>   </td><td class="markdownTableBodyLeft">Installs all development and production dependencies.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make test</code>   </td><td class="markdownTableBodyLeft">Runs the test suite with <code>pytest</code> and generates a coverage report.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make test-fast</code>   </td><td class="markdownTableBodyLeft">Runs the test suite without coverage for quicker feedback.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make lint</code>   </td><td class="markdownTableBodyLeft">Runs linters, specifically <code>flake8</code> and <code>pylint</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make format</code>   </td><td class="markdownTableBodyLeft">Formats code using <code>black</code> and sorts imports with <code>isort</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make format-check</code>   </td><td class="markdownTableBodyLeft">Checks formatting with <code>black</code> and <code>isort</code> without making changes.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make type-check</code>   </td><td class="markdownTableBodyLeft">Runs static type checking using <code>mypy</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make pre-commit</code>   </td><td class="markdownTableBodyLeft">Installs the pre-commit hooks.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make pre-commit-run</code>   </td><td class="markdownTableBodyLeft">Runs the pre-commit hooks on all files in the repository.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make clean</code>   </td><td class="markdownTableBodyLeft">Cleans up generated files like <code>.pytest_cache</code>, <code>.coverage</code>, and <code>htmlcov/</code>.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>make run</code>   </td><td class="markdownTableBodyLeft">Runs the main application (<code><a class="el" href="app_8py.html">app.py</a></code>).    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>make check</code>   </td><td class="markdownTableBodyLeft">A comprehensive check that runs <code>format-check</code>, <code>lint</code>, <code>type-check</code>, and <code>test</code>.   </td></tr>
</table>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:60-75](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:94-113]()</p>
<h3><a class="anchor" id="autotoc_md1176"></a>
<code>make check</code> Workflow</h3>
<p>The <code>make check</code> command is a crucial part of the local development workflow, ensuring code meets quality standards before it is committed. The following diagram illustrates the sequence of checks it performs.</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    A[Start: make check] --&gt; B{Format Check};</div>
<div class="line">    B -- Pass --&gt; C{Linting};</div>
<div class="line">    B -- Fail --&gt; F[End: Failure];</div>
<div class="line">    C -- Pass --&gt; D{Type Checking};</div>
<div class="line">    C -- Fail --&gt; F;</div>
<div class="line">    D -- Pass --&gt; E{Testing};</div>
<div class="line">    D -- Fail --&gt; F;</div>
<div class="line">    E -- Pass --&gt; G[End: Success];</div>
<div class="line">    E -- Fail --&gt; F;</div>
</div><!-- fragment --><p>This diagram shows the sequential execution of format checking, linting, type checking, and testing when <code>make check</code> is run.</p>
<p>Sources: [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:75](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:112-113]()</p>
<h2><a class="anchor" id="autotoc_md1177"></a>
Branch Management and Cleanup</h2>
<p>The repository has a structured approach to branch management to maintain a clean and understandable git history. This includes strict naming conventions, policies for short-lived branches, and automated tooling to identify and clean up stale or merged branches.</p>
<p>Sources: [<a class="el" href="BRANCH__CLEANUP__ANALYSIS_8md.html">BRANCH_CLEANUP_ANALYSIS.md</a>](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:120-140](), [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>]()</p>
<h3><a class="anchor" id="autotoc_md1178"></a>
Branch Naming Conventions</h3>
<p>To keep branches organized, the project follows a descriptive naming convention based on the type of work being done.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadLeft">Prefix   </th><th class="markdownTableHeadLeft">Purpose   </th><th class="markdownTableHeadLeft">Example    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>feature/</code>   </td><td class="markdownTableBodyLeft">New feature development   </td><td class="markdownTableBodyLeft"><code>feature/add-api-endpoint</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>bugfix/</code>   </td><td class="markdownTableBodyLeft">Bug fixes   </td><td class="markdownTableBodyLeft"><code>bugfix/database-connection</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>docs/</code>   </td><td class="markdownTableBodyLeft">Documentation updates   </td><td class="markdownTableBodyLeft"><code>docs/update-readme</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>refactor/</code>   </td><td class="markdownTableBodyLeft">Code refactoring   </td><td class="markdownTableBodyLeft"><code>refactor/simplify-graph-logic</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyLeft"><code>test/</code>   </td><td class="markdownTableBodyLeft">Test additions or improvements   </td><td class="markdownTableBodyLeft"><code>test/add-model-validation-tests</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyLeft"><code>chore/</code>   </td><td class="markdownTableBodyLeft">Maintenance tasks   </td><td class="markdownTableBodyLeft"><code>chore/upgrade-dependencies</code>   </td></tr>
</table>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:124-132](), [<a class="el" href="BRANCH__CLEANUP__QUICK__REFERENCE_8md.html">BRANCH_CLEANUP_QUICK_REFERENCE.md</a>:83-91]()</p>
<h3><a class="anchor" id="autotoc_md1179"></a>
Cleanup Tools</h3>
<p>Two primary tools are provided to assist with branch cleanup: an automated GitHub Actions workflow and an interactive local script.</p>
<ol type="1">
<li><b>Automated Workflow (<code>branch-cleanup.yml</code>)</b>: This GitHub Actions workflow runs on a weekly schedule to identify stale branches (inactive for 90+ days) and generates a report. It can also be triggered manually. Sources: [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:30-38]()</li>
<li><b>Interactive Script (<code>cleanup-branches.sh</code>)</b>: A shell script for developers to run locally. It provides an interactive menu to identify and safely delete merged or stale branches, both locally and remotely. Sources: [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:40-47](), [<a class="el" href="BRANCH__CLEANUP__QUICK__REFERENCE_8md.html">BRANCH_CLEANUP_QUICK_REFERENCE.md</a>:5-9]()</li>
</ol>
<p>The flow of the interactive <code>cleanup-branches.sh</code> script is as follows:</p>
<div class="fragment"><div class="line">flowchart TD</div>
<div class="line">    subgraph Interactive Script Flow</div>
<div class="line">        A[Run ./cleanup-branches.sh] --&gt; B{Select Action};</div>
<div class="line">        B --&gt; C[List Merged Branches];</div>
<div class="line">        B --&gt; D[List Stale Branches];</div>
<div class="line">        B --&gt; E[List Remote Branches not Local];</div>
<div class="line">        C --&gt; C1{Confirm Deletion};</div>
<div class="line">        D --&gt; D1{Confirm Deletion};</div>
<div class="line">        E --&gt; E1[No Action];</div>
<div class="line">        C1 -- Yes --&gt; C2[Delete Branches];</div>
<div class="line">        D1 -- Yes --&gt; D2[Delete Branches];</div>
<div class="line">        C1 -- No --&gt; B;</div>
<div class="line">        D1 -- No --&gt; B;</div>
<div class="line">        C2 --&gt; F[End];</div>
<div class="line">        D2 --&gt; F;</div>
<div class="line">    end</div>
</div><!-- fragment --><p>This diagram outlines the user's journey through the <code>cleanup-branches.sh</code> script, from selecting an action to confirming and executing branch deletion.</p>
<p>Sources: [<a class="el" href="BRANCH__CLEANUP__SUMMARY_8md.html">BRANCH_CLEANUP_SUMMARY.md</a>:40-47](), [<a class="el" href="BRANCH__CLEANUP__QUICK__REFERENCE_8md.html">BRANCH_CLEANUP_QUICK_REFERENCE.md</a>]()</p>
<h2><a class="anchor" id="autotoc_md1180"></a>
Quality Assurance Tooling</h2>
<p>The project integrates several tools to automate code quality checks, which are run both locally via pre-commit hooks and in the CI/CD pipeline.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:121-145](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:100-113]()</p>
<h3><a class="anchor" id="autotoc_md1181"></a>
Pre-commit Hooks</h3>
<p>Pre-commit hooks are configured in <code>.pre-commit-config.yaml</code> to run a series of checks automatically before a commit is created. This prevents common issues and ensures code adheres to project standards.</p>
<p>The configured hooks perform the following actions:</p>
<ul>
<li>Trailing whitespace removal</li>
<li>End-of-file fixing</li>
<li>Validation of YAML, JSON, and TOML files</li>
<li>Code formatting with <code>black</code></li>
<li>Import sorting with <code>isort</code></li>
<li>Linting with <code>flake8</code></li>
<li>Static type checking with <code>mypy</code></li>
</ul>
<p>To install the hooks, a developer runs <code>make pre-commit</code> or <code>pre-commit install</code>.</p>
<p>Sources: [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:200-211](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:73-79]()</p>
<h3><a class="anchor" id="autotoc_md1182"></a>
Developer Workflow with QA Tools</h3>
<p>The following diagram shows a typical developer workflow, incorporating the automated tooling.</p>
<div class="fragment"><div class="line">sequenceDiagram</div>
<div class="line">    participant Dev as Developer</div>
<div class="line">    participant Local as Local Machine</div>
<div class="line">    participant Remote as GitHub Repository</div>
<div class="line"> </div>
<div class="line">    Dev-&gt;&gt;Local: git checkout -b feature/new-thing</div>
<div class="line">    Dev-&gt;&gt;Local: Write code and tests</div>
<div class="line">    Dev-&gt;&gt;Local: git commit -m &quot;feat: new thing&quot;</div>
<div class="line">    activate Local</div>
<div class="line">    Local-&gt;&gt;Local: Run pre-commit hooks (format, lint, etc.)</div>
<div class="line">    Note right of Local: Hooks run automatically</div>
<div class="line">    alt Hooks Pass</div>
<div class="line">        Local--&gt;&gt;Dev: Commit successful</div>
<div class="line">    else Hooks Fail</div>
<div class="line">        Local--&gt;&gt;Dev: Commit failed, fix issues</div>
<div class="line">    end</div>
<div class="line">    deactivate Local</div>
<div class="line"> </div>
<div class="line">    Dev-&gt;&gt;Remote: git push origin feature/new-thing</div>
<div class="line">    Dev-&gt;&gt;Remote: Create Pull Request</div>
<div class="line">    activate Remote</div>
<div class="line">    Remote-&gt;&gt;Remote: Run CI Workflow (ci.yml)</div>
<div class="line">    Note right of Remote: Includes lint, type-check, test, security</div>
<div class="line">    Remote--&gt;&gt;Dev: PR checks pass/fail</div>
<div class="line">    deactivate Remote</div>
</div><!-- fragment --><p>This sequence diagram illustrates how a developer's actions trigger automated quality checks both locally (pre-commit) and remotely (CI workflow).</p>
<p>Sources: [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:81-118](), [<a class="el" href="AUDIT__REPORT_8md.html">AUDIT_REPORT.md</a>:148-160]()</p>
<h2><a class="anchor" id="autotoc_md1183"></a>
Testing Scripts</h2>
<p>Testing is managed through <code>pytest</code> and can be invoked using simple <code>Makefile</code> commands.</p>
<ul>
<li><code>make test</code>: Runs all tests with coverage reporting. This is the standard command for full validation.</li>
<li><code>make test-fast</code>: Runs tests without coverage, which is faster and useful for quick checks during development.</li>
<li><code>pytest -m &lt;marker&gt;</code>: Allows running specific test groups, such as <code>unit</code> tests.</li>
</ul>
<p>The project contains a comprehensive test suite, including unit tests for models and logic, and integration tests for configurations and workflows.</p>
<p>Sources: [<a class="el" href="TESTING__GUIDE_8md.html">TESTING_GUIDE.md</a>:231-259](), [<a class="el" href="CONTRIBUTING_8md.html">CONTRIBUTING.md</a>:188-199](), [<a class="el" href="SUMMARY_8md.html">SUMMARY.md</a>:66-67]() </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.10.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://penify.dev/"><img class="footer" src="https://www.penify.dev/penify-logo.svg" width="104" height="31" alt="doxygen"/></a> </li>
  </ul>
</div>
</body>
</html>
