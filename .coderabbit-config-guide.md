# CodeRabbit Configuration Guide

## Overview

This document explains the `.coderabbit.yaml` configuration file structure for this repository.

## Configuration Structure

### Top-Level Settings

- `language`: Set to `en-GB` for British English
- `early_access`: Enable early access features
- `inheritance`: Enable configuration inheritance

### Reviews Section

Controls how CodeRabbit reviews pull requests:

- `request_changes_workflow`: Request changes when issues are found
- `high_level_summary_in_walkthrough`: Include summary in PR walkthrough
- `auto_apply_labels`: Automatically apply labels based on PR content
- `auto_assign_reviewers`: Automatically assign reviewers

#### Labeling Instructions

Defines rules for applying labels:

- **bug**: Applied to PRs fixing defects, crashes, or incorrect behavior
- **documentation**: Applied to PRs changing docs without runtime changes
- **security**: Applied to PRs addressing security issues

#### Auto Review

- `enabled`: Auto-review is enabled
- `drafts`: Review draft PRs as well
- `base_branches`: Regex pattern `.*` matches all branches

### Knowledge Base Section

Configures CodeRabbit's knowledge resources:

#### MCP (Model Context Protocol)

- `usage`: enabled
- `documents`: Reference documents for context
  - `tech_spec.md` - Technical specifications
  - `DashFin-financial-asset-relationship-db-wiki-v2.md` - Wiki documentation
  - `ARCHITECTURE.md` - System architecture

#### Code Guidelines

- `enabled`: true
- `filePatterns`: Files containing coding guidelines
  - `AI_RULES.md` - AI coding rules and conventions
  - `CONTRIBUTING.md` - Contribution guidelines
  - `CODE_OF_CONDUCT.md` - Code of conduct

### Issue Enrichment Section

- `auto_enrich.enabled`: Automatically enrich issues
- `labeling.auto_apply_labels`: Auto-apply labels to issues

## Common Issues

### Duplicate Sections

**Problem**: Multiple `knowledge_base:`, `reviews:`, or other top-level sections.
**Solution**: Consolidate into single sections with all required fields.

### Incorrect Nesting

**Problem**: `auto_review` placed under `knowledge_base` instead of `reviews`.
**Solution**: Ensure proper hierarchy - `auto_review` belongs under `reviews`.

### Invalid YAML Syntax

**Problem**: Incorrect indentation or missing colons.
**Solution**: Validate with `python3 -c "import yaml; yaml.safe_load(open('.coderabbit.yaml'))"`

## Validation

To validate the configuration file:

```bash
python3 -c "import yaml; yaml.safe_load(open('.coderabbit.yaml'))" && echo "âœ“ Valid YAML"
```

## Resources

- Schema: https://docs.coderabbit.ai/schema/schema.v2.json
- Documentation: https://docs.coderabbit.ai/
